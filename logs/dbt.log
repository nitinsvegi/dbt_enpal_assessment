[0m18:23:52.400178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b48050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107237b10>]}


============================== 18:23:52.404689 | d48db09c-de9b-487e-b5ad-6a139ac39b42 ==============================
[0m18:23:52.404689 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:23:52.405112 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'partial_parse': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'fail_fast': 'False', 'empty': 'False', 'target_path': 'None', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'no_print': 'None', 'printer_width': '80', 'debug': 'False'}
[0m18:23:52.545223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd48db09c-de9b-487e-b5ad-6a139ac39b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106133e10>]}
[0m18:23:52.596671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd48db09c-de9b-487e-b5ad-6a139ac39b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb3f00>]}
[0m18:23:52.597583 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:23:52.695295 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m18:23:52.758446 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:23:52.758838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd48db09c-de9b-487e-b5ad-6a139ac39b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfc050>]}
[0m18:23:53.448397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd48db09c-de9b-487e-b5ad-6a139ac39b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9a5d0>]}
[0m18:23:53.489457 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:23:53.491169 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:23:53.505054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd48db09c-de9b-487e-b5ad-6a139ac39b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101d5b70>]}
[0m18:23:53.505382 [info ] [MainThread]: Found 1 model, 1 source, 434 macros
[0m18:23:53.505573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd48db09c-de9b-487e-b5ad-6a139ac39b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbfc70>]}
[0m18:23:53.506501 [info ] [MainThread]: 
[0m18:23:53.506699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:53.506843 [info ] [MainThread]: 
[0m18:23:53.507105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:53.507572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:23:53.570035 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:23:53.570351 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:23:53.570548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:58.662820 [debug] [ThreadPool]: SQL status: SELECT 4 in 5.092 seconds
[0m18:23:58.664064 [debug] [ThreadPool]: On list_postgres: Close
[0m18:23:58.664754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics)
[0m18:23:58.665076 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics"
"
[0m18:23:58.670580 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m18:23:58.671019 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: BEGIN
[0m18:23:58.671234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:58.711121 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m18:23:58.711603 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m18:23:58.711927 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics"} */
create schema if not exists "public_pipedrive_analytics"
[0m18:23:58.718688 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.006 seconds
[0m18:23:58.720576 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m18:23:58.720897 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m18:23:58.721122 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m18:23:58.729895 [debug] [ThreadPool]: SQL status: COMMIT in 0.008 seconds
[0m18:23:58.735642 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: Close
[0m18:23:58.736983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_pipedrive_analytics, now list_postgres_public_pipedrive_analytics)
[0m18:23:58.744128 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:23:58.744443 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m18:23:58.744642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:58.771230 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m18:23:58.771674 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:23:58.772042 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m18:23:58.795337 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m18:23:58.797658 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m18:23:58.800640 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m18:23:58.805128 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:58.805463 [debug] [MainThread]: On master: BEGIN
[0m18:23:58.805656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:58.834611 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m18:23:58.834979 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:58.835416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:23:58.843097 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:23:58.846586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd48db09c-de9b-487e-b5ad-6a139ac39b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f1490>]}
[0m18:23:58.847402 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:58.848711 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:58.849027 [debug] [MainThread]: On master: BEGIN
[0m18:23:58.851211 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:23:58.851651 [debug] [MainThread]: On master: COMMIT
[0m18:23:58.851863 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:58.852041 [debug] [MainThread]: On master: COMMIT
[0m18:23:58.852903 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:23:58.853097 [debug] [MainThread]: On master: Close
[0m18:23:58.855172 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m18:23:58.855631 [info ] [Thread-1 (]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m18:23:58.855978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m18:23:58.856339 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m18:23:58.861747 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m18:23:58.863126 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m18:23:58.893515 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m18:23:58.894362 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m18:23:58.894603 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: BEGIN
[0m18:23:58.894814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:58.928022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m18:23:58.928437 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m18:23:58.928736 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m18:23:58.954346 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.025 seconds
[0m18:23:58.962131 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m18:23:58.962474 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m18:23:58.965096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:23:58.975289 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m18:23:58.975632 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m18:23:58.975847 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m18:23:58.979511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:23:58.983518 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m18:23:58.986787 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m18:23:58.987091 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m18:23:58.988580 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:23:58.990180 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m18:23:58.991668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48db09c-de9b-487e-b5ad-6a139ac39b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102559c0>]}
[0m18:23:58.992133 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.13s]
[0m18:23:58.992574 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m18:23:58.993361 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:58.993553 [debug] [MainThread]: On master: BEGIN
[0m18:23:58.993706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:59.015097 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m18:23:59.015452 [debug] [MainThread]: On master: COMMIT
[0m18:23:59.015643 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:59.015807 [debug] [MainThread]: On master: COMMIT
[0m18:23:59.016490 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:23:59.016667 [debug] [MainThread]: On master: Close
[0m18:23:59.016929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:59.017084 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m18:23:59.017267 [info ] [MainThread]: 
[0m18:23:59.017449 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m18:23:59.017860 [debug] [MainThread]: Command end result
[0m18:23:59.032589 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:23:59.034199 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:23:59.038598 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m18:23:59.038951 [info ] [MainThread]: 
[0m18:23:59.039238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:59.039433 [info ] [MainThread]: 
[0m18:23:59.039612 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:23:59.065132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7285757, "process_in_blocks": "0", "process_kernel_time": 0.337131, "process_mem_max_rss": "130580480", "process_out_blocks": "0", "process_user_time": 1.971593}
[0m18:23:59.065509 [debug] [MainThread]: Command `dbt run` succeeded at 18:23:59.065447 after 6.73 seconds
[0m18:23:59.065737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11056afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ffb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101c0150>]}
[0m18:23:59.065961 [debug] [MainThread]: Flushing usage events
[0m18:24:00.814750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:47.471878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827b10>]}


============================== 18:52:47.476031 | d2fa72f5-a641-4737-a30e-f37e638bb7a8 ==============================
[0m18:52:47.476031 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:52:47.476439 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt clean', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'warn_error': 'None', 'printer_width': '80', 'empty': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False'}
[0m18:52:47.571652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2fa72f5-a641-4737-a30e-f37e638bb7a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b27e10>]}
[0m18:52:47.589587 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17326167, "process_in_blocks": "0", "process_kernel_time": 0.179613, "process_mem_max_rss": "108953600", "process_out_blocks": "0", "process_user_time": 0.982979}
[0m18:52:47.589952 [debug] [MainThread]: Command `dbt clean` succeeded at 18:52:47.589885 after 0.17 seconds
[0m18:52:47.590212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066aa7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066aa690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f8c50>]}
[0m18:52:47.590657 [debug] [MainThread]: Flushing usage events
[0m18:52:49.131036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:04.484187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e33b10>]}


============================== 18:53:04.488106 | d4d7e59a-47de-45cd-aecf-8c09bda5e919 ==============================
[0m18:53:04.488106 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:53:04.488517 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'partial_parse': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:53:04.624059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4d7e59a-47de-45cd-aecf-8c09bda5e919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d33e10>]}
[0m18:53:04.661302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4d7e59a-47de-45cd-aecf-8c09bda5e919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb3f00>]}
[0m18:53:04.662090 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:53:04.729688 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m18:53:04.732177 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:53:04.732682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd4d7e59a-47de-45cd-aecf-8c09bda5e919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105caf950>]}
[0m18:53:05.343598 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.enpal_assessment_project
[0m18:53:05.351795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4d7e59a-47de-45cd-aecf-8c09bda5e919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9b110>]}
[0m18:53:05.387588 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:53:05.389243 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:53:05.403543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4d7e59a-47de-45cd-aecf-8c09bda5e919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ace50>]}
[0m18:53:05.403903 [info ] [MainThread]: Found 1 source, 434 macros
[0m18:53:05.404123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4d7e59a-47de-45cd-aecf-8c09bda5e919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f56270>]}
[0m18:53:05.405052 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:53:05.405406 [debug] [MainThread]: Command end result
[0m18:53:05.419380 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:53:05.420649 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:53:05.422824 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m18:53:05.424856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9921553, "process_in_blocks": "0", "process_kernel_time": 0.28226, "process_mem_max_rss": "117276672", "process_out_blocks": "0", "process_user_time": 1.797233}
[0m18:53:05.425189 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:05.425130 after 0.99 seconds
[0m18:53:05.425417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7b8b0>]}
[0m18:53:05.425638 [debug] [MainThread]: Flushing usage events
[0m18:53:06.810632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:47:53.592640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c1c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a33b10>]}


============================== 18:47:53.596414 | 9c689d11-07ca-4b66-a10f-e7c1e990886d ==============================
[0m18:47:53.596414 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:47:53.596761 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build -s stg_users.sql', 'log_format': 'default', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80'}
[0m18:47:54.013690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c689d11-07ca-4b66-a10f-e7c1e990886d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492fe10>]}
[0m18:47:54.042234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c689d11-07ca-4b66-a10f-e7c1e990886d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b3bd0>]}
[0m18:47:54.042888 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:47:54.103704 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m18:47:54.161282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m18:47:54.161620 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/definition.md
[0m18:47:54.161816 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/staging_schema.yml
[0m18:47:54.161963 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_users.sql
[0m18:47:54.162167 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/sources.yml
[0m18:47:54.452386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c689d11-07ca-4b66-a10f-e7c1e990886d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b23a50>]}
[0m18:47:54.494657 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:47:54.496590 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:47:54.518933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c689d11-07ca-4b66-a10f-e7c1e990886d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cf2f0>]}
[0m18:47:54.519206 [info ] [MainThread]: Found 1 model, 3 data tests, 6 sources, 434 macros
[0m18:47:54.520210 [info ] [MainThread]: 
[0m18:47:54.520378 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:47:54.520510 [info ] [MainThread]: 
[0m18:47:54.520734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:47:54.521122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:47:54.578739 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:47:54.579014 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:47:54.579168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:54.910173 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.331 seconds
[0m18:47:54.912667 [debug] [ThreadPool]: On list_postgres: Close
[0m18:47:54.913714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m18:47:54.918108 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:47:54.918399 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m18:47:54.918584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:54.938324 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m18:47:54.938656 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:47:54.938885 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m18:47:54.957387 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m18:47:54.958380 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m18:47:54.959262 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m18:47:54.962254 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:54.962630 [debug] [MainThread]: On master: BEGIN
[0m18:47:54.962788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:47:54.980026 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m18:47:54.980306 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:54.980529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:47:54.990002 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m18:47:54.990824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c689d11-07ca-4b66-a10f-e7c1e990886d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107357af0>]}
[0m18:47:54.991076 [debug] [MainThread]: On master: ROLLBACK
[0m18:47:54.991694 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:54.991882 [debug] [MainThread]: On master: BEGIN
[0m18:47:54.992768 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:47:54.992923 [debug] [MainThread]: On master: COMMIT
[0m18:47:54.993059 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:54.993183 [debug] [MainThread]: On master: COMMIT
[0m18:47:54.993653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:47:54.993805 [debug] [MainThread]: On master: Close
[0m18:47:54.995872 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m18:47:54.996182 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_analytics.stg_users ........ [RUN]
[0m18:47:54.996421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_users)
[0m18:47:54.996601 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m18:47:55.001295 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m18:47:55.002609 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m18:47:55.040965 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m18:47:55.042067 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m18:47:55.042316 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m18:47:55.042526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:55.061859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m18:47:55.062212 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m18:47:55.062465 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users"
  
  
    as
  
  (
    

WITH raw AS (
SELCT *
FROM "postgres"."public"."users"
),
cleaned AS (
SELECT
    id as user_id
    , name AS user_name
    , email AS user_email
    , CURRENT_TIMESTAMP() AS dwh_creation_timestamp
    , modified AS dwh_modified_timestamp
FROM raw
WHERE TRUE
    AND user_id is not null
)

SELECT *
FROM cleaned


  );
  
  
[0m18:47:55.064266 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "SELCT"
LINE 16: SELCT *
         ^

[0m18:47:55.064561 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: ROLLBACK
[0m18:47:55.065331 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m18:47:55.071958 [debug] [Thread-1 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  syntax error at or near "SELCT"
  LINE 16: SELCT *
           ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_users.sql
[0m18:47:55.073239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c689d11-07ca-4b66-a10f-e7c1e990886d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa5bf0>]}
[0m18:47:55.073663 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model public_pipedrive_analytics.stg_users  [[31mERROR[0m in 0.08s]
[0m18:47:55.074026 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m18:47:55.074337 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_users' to be skipped because of status 'error'.  Reason: Database Error in model stg_users (models/staging/stg_users.sql)
  syntax error at or near "SELCT"
  LINE 16: SELCT *
           ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_users.sql.
[0m18:47:55.074981 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:47:55.075241 [info ] [Thread-1 (]: 2 of 4 SKIP test not_null_stg_users_user_id .................................... [[33mSKIP[0m]
[0m18:47:55.075471 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:47:55.075669 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:47:55.075841 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77' to be skipped because of status 'skipped'. 
[0m18:47:55.076065 [info ] [Thread-1 (]: 3 of 4 SKIP test not_null_stg_users_user_name .................................. [[33mSKIP[0m]
[0m18:47:55.076350 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:47:55.076550 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:47:55.076711 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53' to be skipped because of status 'skipped'. 
[0m18:47:55.076905 [info ] [Thread-1 (]: 4 of 4 SKIP test unique_stg_users_user_id ...................................... [[33mSKIP[0m]
[0m18:47:55.077151 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:47:55.077321 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' to be skipped because of status 'skipped'. 
[0m18:47:55.077878 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:55.078034 [debug] [MainThread]: On master: BEGIN
[0m18:47:55.078164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:47:55.095773 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m18:47:55.096057 [debug] [MainThread]: On master: COMMIT
[0m18:47:55.096225 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:55.096369 [debug] [MainThread]: On master: COMMIT
[0m18:47:55.097186 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:47:55.097394 [debug] [MainThread]: On master: Close
[0m18:47:55.097673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:55.097859 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m18:47:55.098152 [info ] [MainThread]: 
[0m18:47:55.098393 [info ] [MainThread]: Finished running 1 incremental model, 3 data tests in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m18:47:55.098892 [debug] [MainThread]: Command end result
[0m18:47:55.112041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:47:55.113158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:47:55.116682 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m18:47:55.116902 [info ] [MainThread]: 
[0m18:47:55.117096 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:47:55.117240 [info ] [MainThread]: 
[0m18:47:55.117414 [error] [MainThread]: [31mFailure in model stg_users (models/staging/stg_users.sql)[0m
[0m18:47:55.117578 [error] [MainThread]:   Database Error in model stg_users (models/staging/stg_users.sql)
  syntax error at or near "SELCT"
  LINE 16: SELCT *
           ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_users.sql
[0m18:47:55.117696 [info ] [MainThread]: 
[0m18:47:55.117849 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_users.sql
[0m18:47:55.117968 [info ] [MainThread]: 
[0m18:47:55.118099 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=4
[0m18:47:55.145845 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5995265, "process_in_blocks": "0", "process_kernel_time": 0.295063, "process_mem_max_rss": "135561216", "process_out_blocks": "0", "process_user_time": 1.398203}
[0m18:47:55.146204 [debug] [MainThread]: Command `dbt build` failed at 18:47:55.146148 after 1.60 seconds
[0m18:47:55.146426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107641390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107641c80>]}
[0m18:47:55.146629 [debug] [MainThread]: Flushing usage events
[0m18:47:56.809676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:04.730180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108220050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906fb10>]}


============================== 18:48:04.734849 | 9c451b58-1e1a-4912-b735-c87c4ed6ca1e ==============================
[0m18:48:04.734849 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:48:04.735205 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'invocation_command': 'dbt build -s stg_users.sql', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False'}
[0m18:48:04.835004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c451b58-1e1a-4912-b735-c87c4ed6ca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836be10>]}
[0m18:48:04.863990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c451b58-1e1a-4912-b735-c87c4ed6ca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eebbd0>]}
[0m18:48:04.864919 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:48:04.918280 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m18:48:04.993252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:48:04.993665 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m18:48:05.222644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c451b58-1e1a-4912-b735-c87c4ed6ca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d06250>]}
[0m18:48:05.263159 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:48:05.264881 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:48:05.284567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c451b58-1e1a-4912-b735-c87c4ed6ca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a07e7b0>]}
[0m18:48:05.284841 [info ] [MainThread]: Found 1 model, 3 data tests, 6 sources, 434 macros
[0m18:48:05.285843 [info ] [MainThread]: 
[0m18:48:05.286013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:05.286149 [info ] [MainThread]: 
[0m18:48:05.286371 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:05.286782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:48:05.340248 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:48:05.340489 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:48:05.340631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:05.376428 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m18:48:05.377280 [debug] [ThreadPool]: On list_postgres: Close
[0m18:48:05.377974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m18:48:05.381188 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:48:05.381384 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m18:48:05.381524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:05.398393 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m18:48:05.398660 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:48:05.398838 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m18:48:05.401268 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:48:05.402028 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m18:48:05.402792 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m18:48:05.405407 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.405623 [debug] [MainThread]: On master: BEGIN
[0m18:48:05.405768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:05.424704 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m18:48:05.425008 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.425246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:48:05.428539 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m18:48:05.429533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c451b58-1e1a-4912-b735-c87c4ed6ca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ed2b0>]}
[0m18:48:05.429854 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:05.430955 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.431150 [debug] [MainThread]: On master: BEGIN
[0m18:48:05.432747 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:48:05.433010 [debug] [MainThread]: On master: COMMIT
[0m18:48:05.433183 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.433330 [debug] [MainThread]: On master: COMMIT
[0m18:48:05.434005 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:48:05.434207 [debug] [MainThread]: On master: Close
[0m18:48:05.436772 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m18:48:05.437129 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_analytics.stg_users ........ [RUN]
[0m18:48:05.437393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_users)
[0m18:48:05.437581 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m18:48:05.442225 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m18:48:05.442803 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m18:48:05.476165 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m18:48:05.476929 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m18:48:05.477097 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m18:48:05.477242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:05.501901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m18:48:05.502180 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m18:48:05.502372 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users"
  
  
    as
  
  (
    

WITH raw AS (
SELECT *
FROM "postgres"."public"."users"
),
cleaned AS (
SELECT
    id as user_id
    , name AS user_name
    , email AS user_email
    , CURRENT_TIMESTAMP() AS dwh_creation_timestamp
    , modified AS dwh_modified_timestamp
FROM raw
WHERE TRUE
    AND user_id is not null
)

SELECT *
FROM cleaned


  );
  
  
[0m18:48:05.503375 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 24:     , CURRENT_TIMESTAMP() AS dwh_creation_timestamp
                                 ^

[0m18:48:05.503553 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: ROLLBACK
[0m18:48:05.504143 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m18:48:05.510150 [debug] [Thread-1 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  syntax error at or near ")"
  LINE 24:     , CURRENT_TIMESTAMP() AS dwh_creation_timestamp
                                   ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_users.sql
[0m18:48:05.511327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c451b58-1e1a-4912-b735-c87c4ed6ca1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a427e10>]}
[0m18:48:05.511694 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model public_pipedrive_analytics.stg_users  [[31mERROR[0m in 0.07s]
[0m18:48:05.511999 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m18:48:05.512269 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_users' to be skipped because of status 'error'.  Reason: Database Error in model stg_users (models/staging/stg_users.sql)
  syntax error at or near ")"
  LINE 24:     , CURRENT_TIMESTAMP() AS dwh_creation_timestamp
                                   ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_users.sql.
[0m18:48:05.512842 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:48:05.513059 [info ] [Thread-1 (]: 2 of 4 SKIP test not_null_stg_users_user_id .................................... [[33mSKIP[0m]
[0m18:48:05.513249 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:48:05.513416 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:48:05.513565 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77' to be skipped because of status 'skipped'. 
[0m18:48:05.513756 [info ] [Thread-1 (]: 3 of 4 SKIP test not_null_stg_users_user_name .................................. [[33mSKIP[0m]
[0m18:48:05.514032 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:48:05.514222 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:48:05.514370 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53' to be skipped because of status 'skipped'. 
[0m18:48:05.514543 [info ] [Thread-1 (]: 4 of 4 SKIP test unique_stg_users_user_id ...................................... [[33mSKIP[0m]
[0m18:48:05.514800 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:48:05.514983 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' to be skipped because of status 'skipped'. 
[0m18:48:05.515528 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.515683 [debug] [MainThread]: On master: BEGIN
[0m18:48:05.515809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:05.534669 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m18:48:05.534945 [debug] [MainThread]: On master: COMMIT
[0m18:48:05.535108 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.535248 [debug] [MainThread]: On master: COMMIT
[0m18:48:05.535745 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:05.535889 [debug] [MainThread]: On master: Close
[0m18:48:05.536120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:05.536250 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m18:48:05.536407 [info ] [MainThread]: 
[0m18:48:05.536560 [info ] [MainThread]: Finished running 1 incremental model, 3 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:48:05.536941 [debug] [MainThread]: Command end result
[0m18:48:05.548690 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:48:05.549892 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:48:05.553741 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m18:48:05.553968 [info ] [MainThread]: 
[0m18:48:05.554151 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:48:05.554298 [info ] [MainThread]: 
[0m18:48:05.554469 [error] [MainThread]: [31mFailure in model stg_users (models/staging/stg_users.sql)[0m
[0m18:48:05.554641 [error] [MainThread]:   Database Error in model stg_users (models/staging/stg_users.sql)
  syntax error at or near ")"
  LINE 24:     , CURRENT_TIMESTAMP() AS dwh_creation_timestamp
                                   ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_users.sql
[0m18:48:05.554768 [info ] [MainThread]: 
[0m18:48:05.554922 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_users.sql
[0m18:48:05.555040 [info ] [MainThread]: 
[0m18:48:05.555180 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=4
[0m18:48:05.556653 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.868208, "process_in_blocks": "0", "process_kernel_time": 0.221455, "process_mem_max_rss": "133398528", "process_out_blocks": "0", "process_user_time": 1.277396}
[0m18:48:05.556861 [debug] [MainThread]: Command `dbt build` failed at 18:48:05.556820 after 0.87 seconds
[0m18:48:05.557033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eed850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a19dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a19dd30>]}
[0m18:48:05.557196 [debug] [MainThread]: Flushing usage events
[0m18:48:06.890634 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:49:13.652926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235e8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126633b10>]}


============================== 18:49:13.656446 | d6b2dff0-c81c-4d54-a89e-70dc508dda5d ==============================
[0m18:49:13.656446 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:49:13.656790 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt build -s stg_users.sql', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'partial_parse': 'True', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True'}
[0m18:49:13.770958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b2dff0-c81c-4d54-a89e-70dc508dda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12382fe10>]}
[0m18:49:13.802906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6b2dff0-c81c-4d54-a89e-70dc508dda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264b3bd0>]}
[0m18:49:13.803733 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:49:13.869802 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m18:49:13.952935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:49:13.953355 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m18:49:14.206170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6b2dff0-c81c-4d54-a89e-70dc508dda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127526250>]}
[0m18:49:14.248655 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:49:14.250504 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:49:14.270224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6b2dff0-c81c-4d54-a89e-70dc508dda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a9a7b0>]}
[0m18:49:14.270487 [info ] [MainThread]: Found 1 model, 3 data tests, 6 sources, 434 macros
[0m18:49:14.271493 [info ] [MainThread]: 
[0m18:49:14.271663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:49:14.271793 [info ] [MainThread]: 
[0m18:49:14.272010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:49:14.272411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:49:14.324809 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:49:14.325130 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:49:14.325322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:14.441854 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.116 seconds
[0m18:49:14.442936 [debug] [ThreadPool]: On list_postgres: Close
[0m18:49:14.443863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m18:49:14.447923 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:49:14.448241 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m18:49:14.448433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:14.468528 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m18:49:14.468832 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:49:14.469033 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m18:49:14.478439 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m18:49:14.479338 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m18:49:14.479932 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m18:49:14.482779 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:14.483029 [debug] [MainThread]: On master: BEGIN
[0m18:49:14.483222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:14.500313 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m18:49:14.500582 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:14.500803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:49:14.513007 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m18:49:14.513916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b2dff0-c81c-4d54-a89e-70dc508dda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273952b0>]}
[0m18:49:14.514226 [debug] [MainThread]: On master: ROLLBACK
[0m18:49:14.515020 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:14.515193 [debug] [MainThread]: On master: BEGIN
[0m18:49:14.516388 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:49:14.516598 [debug] [MainThread]: On master: COMMIT
[0m18:49:14.516771 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:14.516920 [debug] [MainThread]: On master: COMMIT
[0m18:49:14.517579 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:49:14.517751 [debug] [MainThread]: On master: Close
[0m18:49:14.520086 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m18:49:14.520496 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_analytics.stg_users ........ [RUN]
[0m18:49:14.520801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_users)
[0m18:49:14.521014 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m18:49:14.527196 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m18:49:14.527920 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m18:49:14.567878 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m18:49:14.568543 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m18:49:14.568776 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m18:49:14.569297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:14.588994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m18:49:14.589312 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m18:49:14.589516 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users"
  
  
    as
  
  (
    

WITH raw AS (
SELECT *
FROM "postgres"."public"."users"
),
cleaned AS (
SELECT
    id as user_id
    , name AS user_name
    , email AS user_email
    , CURRENT_TIMESTAMP AS dwh_creation_timestamp
    , modified AS dwh_modified_timestamp
FROM raw
WHERE TRUE
    AND user_id is not null
)

SELECT *
FROM cleaned


  );
  
  
[0m18:49:14.591741 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "user_id" does not exist
LINE 28:     AND user_id is not null
                 ^

[0m18:49:14.592034 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: ROLLBACK
[0m18:49:14.592818 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m18:49:14.599569 [debug] [Thread-1 (]: Database Error in model stg_users (models/staging/stg_users.sql)
  column "user_id" does not exist
  LINE 28:     AND user_id is not null
                   ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_users.sql
[0m18:49:14.600935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2dff0-c81c-4d54-a89e-70dc508dda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e43930>]}
[0m18:49:14.601567 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model public_pipedrive_analytics.stg_users  [[31mERROR[0m in 0.08s]
[0m18:49:14.602011 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m18:49:14.602361 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_users' to be skipped because of status 'error'.  Reason: Database Error in model stg_users (models/staging/stg_users.sql)
  column "user_id" does not exist
  LINE 28:     AND user_id is not null
                   ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_users.sql.
[0m18:49:14.603003 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:49:14.603264 [info ] [Thread-1 (]: 2 of 4 SKIP test not_null_stg_users_user_id .................................... [[33mSKIP[0m]
[0m18:49:14.603501 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:49:14.603675 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:49:14.603817 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77' to be skipped because of status 'skipped'. 
[0m18:49:14.603997 [info ] [Thread-1 (]: 3 of 4 SKIP test not_null_stg_users_user_name .................................. [[33mSKIP[0m]
[0m18:49:14.604237 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:49:14.604410 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:49:14.604547 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53' to be skipped because of status 'skipped'. 
[0m18:49:14.604718 [info ] [Thread-1 (]: 4 of 4 SKIP test unique_stg_users_user_id ...................................... [[33mSKIP[0m]
[0m18:49:14.604945 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:49:14.605088 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' to be skipped because of status 'skipped'. 
[0m18:49:14.605658 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:14.605801 [debug] [MainThread]: On master: BEGIN
[0m18:49:14.605918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:49:14.629989 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m18:49:14.630316 [debug] [MainThread]: On master: COMMIT
[0m18:49:14.630494 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:14.630638 [debug] [MainThread]: On master: COMMIT
[0m18:49:14.631199 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:49:14.631388 [debug] [MainThread]: On master: Close
[0m18:49:14.631676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:14.631824 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m18:49:14.632000 [info ] [MainThread]: 
[0m18:49:14.632198 [info ] [MainThread]: Finished running 1 incremental model, 3 data tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:49:14.632669 [debug] [MainThread]: Command end result
[0m18:49:14.646819 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:49:14.648012 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:49:14.651883 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m18:49:14.652088 [info ] [MainThread]: 
[0m18:49:14.652276 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:49:14.652414 [info ] [MainThread]: 
[0m18:49:14.652587 [error] [MainThread]: [31mFailure in model stg_users (models/staging/stg_users.sql)[0m
[0m18:49:14.652752 [error] [MainThread]:   Database Error in model stg_users (models/staging/stg_users.sql)
  column "user_id" does not exist
  LINE 28:     AND user_id is not null
                   ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_users.sql
[0m18:49:14.652870 [info ] [MainThread]: 
[0m18:49:14.653016 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_users.sql
[0m18:49:14.653140 [info ] [MainThread]: 
[0m18:49:14.653269 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=4
[0m18:49:14.654785 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.0476006, "process_in_blocks": "0", "process_kernel_time": 0.274789, "process_mem_max_rss": "131874816", "process_out_blocks": "0", "process_user_time": 1.399792}
[0m18:49:14.655007 [debug] [MainThread]: Command `dbt build` failed at 18:49:14.654961 after 1.05 seconds
[0m18:49:14.655184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264b5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127bb9a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127bb9bd0>]}
[0m18:49:14.655344 [debug] [MainThread]: Flushing usage events
[0m18:49:16.316338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:04.037956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090239d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109023b10>]}


============================== 18:51:04.041513 | f0b09759-580e-4367-81c4-26f730b8e3f9 ==============================
[0m18:51:04.041513 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:51:04.041856 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s stg_users.sql', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'empty': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True'}
[0m18:51:04.169827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0b09759-580e-4367-81c4-26f730b8e3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831fe10>]}
[0m18:51:04.199160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0b09759-580e-4367-81c4-26f730b8e3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea3bd0>]}
[0m18:51:04.199885 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:51:04.252120 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m18:51:04.332326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:51:04.332767 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m18:51:04.571454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0b09759-580e-4367-81c4-26f730b8e3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cbe250>]}
[0m18:51:04.611186 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:51:04.612388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:51:04.632149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0b09759-580e-4367-81c4-26f730b8e3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0367b0>]}
[0m18:51:04.632425 [info ] [MainThread]: Found 1 model, 3 data tests, 6 sources, 434 macros
[0m18:51:04.633430 [info ] [MainThread]: 
[0m18:51:04.633604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:04.633744 [info ] [MainThread]: 
[0m18:51:04.633965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:51:04.634379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:51:04.700516 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:51:04.700757 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:51:04.700899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:04.910472 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.209 seconds
[0m18:51:04.911625 [debug] [ThreadPool]: On list_postgres: Close
[0m18:51:04.912715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m18:51:04.917973 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:51:04.918295 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m18:51:04.918480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:04.940473 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m18:51:04.940865 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:51:04.941123 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m18:51:04.946319 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m18:51:04.947385 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m18:51:04.948159 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m18:51:04.951579 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:04.951836 [debug] [MainThread]: On master: BEGIN
[0m18:51:04.952001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:04.971087 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m18:51:04.971401 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:04.971666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:51:04.976157 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:51:04.977061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0b09759-580e-4367-81c4-26f730b8e3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a52b0>]}
[0m18:51:04.977384 [debug] [MainThread]: On master: ROLLBACK
[0m18:51:04.978123 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:04.978357 [debug] [MainThread]: On master: BEGIN
[0m18:51:04.979578 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:51:04.979824 [debug] [MainThread]: On master: COMMIT
[0m18:51:04.980006 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:04.980169 [debug] [MainThread]: On master: COMMIT
[0m18:51:04.981165 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:51:04.981345 [debug] [MainThread]: On master: Close
[0m18:51:04.983899 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m18:51:04.984371 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_analytics.stg_users ........ [RUN]
[0m18:51:04.984738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_users)
[0m18:51:04.984988 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m18:51:04.990447 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m18:51:04.991376 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m18:51:05.029011 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m18:51:05.029566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m18:51:05.029744 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m18:51:05.029894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:05.048986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m18:51:05.049296 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m18:51:05.049503 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users"
  
  
    as
  
  (
    

WITH raw AS (
SELECT *
FROM "postgres"."public"."users"
),
cleaned AS (
SELECT
    id as user_id
    , name AS user_name
    , email AS user_email
    , CURRENT_TIMESTAMP AS dwh_creation_timestamp
    , modified AS dwh_modified_timestamp
FROM raw
WHERE TRUE
    AND id is not null
)

SELECT *
FROM cleaned


  );
  
  
[0m18:51:05.075305 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.026 seconds
[0m18:51:05.087697 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m18:51:05.088017 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m18:51:05.088256 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m18:51:05.090756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:51:05.091905 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m18:51:05.093148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b09759-580e-4367-81c4-26f730b8e3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a528bb0>]}
[0m18:51:05.093649 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_pipedrive_analytics.stg_users ... [[32mSELECT 1787[0m in 0.11s]
[0m18:51:05.094104 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m18:51:05.094790 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:51:05.095013 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_users_user_id ................................... [RUN]
[0m18:51:05.095285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m18:51:05.095458 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:51:05.103329 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m18:51:05.104726 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:51:05.115560 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m18:51:05.116307 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m18:51:05.116492 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m18:51:05.116647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:05.135074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:51:05.136434 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m18:51:05.142711 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m18:51:05.148827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m18:51:05.152034 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m18:51:05.153284 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m18:51:05.153737 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.06s]
[0m18:51:05.154190 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m18:51:05.154453 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:51:05.154693 [info ] [Thread-1 (]: 3 of 4 START test not_null_stg_users_user_name ................................. [RUN]
[0m18:51:05.154929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m18:51:05.155101 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:51:05.157516 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m18:51:05.158041 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:51:05.159161 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m18:51:05.159593 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m18:51:05.159762 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m18:51:05.159924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:05.203226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:51:05.203569 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m18:51:05.203767 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m18:51:05.206000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:51:05.207155 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m18:51:05.209778 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m18:51:05.211395 [info ] [Thread-1 (]: 3 of 4 PASS not_null_stg_users_user_name ....................................... [[32mPASS[0m in 0.06s]
[0m18:51:05.212658 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m18:51:05.213046 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:51:05.213278 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_users_user_id ..................................... [RUN]
[0m18:51:05.213629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m18:51:05.213861 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:51:05.219049 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m18:51:05.223074 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:51:05.230594 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m18:51:05.235874 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m18:51:05.237410 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m18:51:05.237599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:05.271853 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m18:51:05.272123 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m18:51:05.272299 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:51:05.274364 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:51:05.275414 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m18:51:05.276319 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m18:51:05.276721 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.06s]
[0m18:51:05.277200 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m18:51:05.278210 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:05.278450 [debug] [MainThread]: On master: BEGIN
[0m18:51:05.278652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:51:05.295631 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m18:51:05.295925 [debug] [MainThread]: On master: COMMIT
[0m18:51:05.296100 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:05.296249 [debug] [MainThread]: On master: COMMIT
[0m18:51:05.296839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:51:05.297067 [debug] [MainThread]: On master: Close
[0m18:51:05.297497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:05.297689 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m18:51:05.298347 [info ] [MainThread]: 
[0m18:51:05.299017 [info ] [MainThread]: Finished running 1 incremental model, 3 data tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m18:51:05.300075 [debug] [MainThread]: Command end result
[0m18:51:05.316809 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m18:51:05.318150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:51:05.322177 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m18:51:05.322391 [info ] [MainThread]: 
[0m18:51:05.322576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:05.322718 [info ] [MainThread]: 
[0m18:51:05.322865 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:51:05.324461 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3299849, "process_in_blocks": "0", "process_kernel_time": 0.252747, "process_mem_max_rss": "134791168", "process_out_blocks": "0", "process_user_time": 1.354103}
[0m18:51:05.324687 [debug] [MainThread]: Command `dbt build` succeeded at 18:51:05.324644 after 1.33 seconds
[0m18:51:05.324861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a151bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a151ff0>]}
[0m18:51:05.325033 [debug] [MainThread]: Flushing usage events
[0m18:51:06.961431 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:06:44.815088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c7b10>]}


============================== 22:06:44.819266 | 06f97d82-3819-43bd-b1f6-d98cce201bea ==============================
[0m22:06:44.819266 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:06:44.819656 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'use_colors': 'True', 'warn_error': 'None', 'empty': 'False', 'printer_width': '80', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'fail_fast': 'False', 'no_print': 'None', 'log_format': 'default'}
[0m22:06:45.025513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06f97d82-3819-43bd-b1f6-d98cce201bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c3e10>]}
[0m22:06:45.056151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06f97d82-3819-43bd-b1f6-d98cce201bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107047bd0>]}
[0m22:06:45.057472 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:06:45.121962 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:06:45.204843 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:06:45.205196 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:06:45.205371 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:06:45.205518 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:06:45.205658 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:06:45.205793 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:06:45.205922 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:06:45.206174 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:06:45.206390 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:06:45.293517 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_stages (models/staging/stg_stages.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:06:45.295895 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.53204596, "process_in_blocks": "0", "process_kernel_time": 0.215334, "process_mem_max_rss": "108085248", "process_out_blocks": "0", "process_user_time": 0.96804}
[0m22:06:45.296206 [debug] [MainThread]: Command `dbt build` failed at 22:06:45.296150 after 0.53 seconds
[0m22:06:45.296429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080acb90>]}
[0m22:06:45.296618 [debug] [MainThread]: Flushing usage events
[0m22:06:46.890862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:12:05.647606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d84050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3b10>]}


============================== 22:12:05.650926 | 6d512dcb-3b16-4c8e-9a1c-c5be0857d6b7 ==============================
[0m22:12:05.650926 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:12:05.651261 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'debug': 'False'}
[0m22:12:05.785819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d512dcb-3b16-4c8e-9a1c-c5be0857d6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecfe10>]}
[0m22:12:05.815072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d512dcb-3b16-4c8e-9a1c-c5be0857d6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4fbd0>]}
[0m22:12:05.815827 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:12:05.878629 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:12:05.967217 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:12:05.967595 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:12:05.967770 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:12:05.967918 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:12:05.968052 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:12:05.968182 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:12:05.968432 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:12:05.968557 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:12:05.968768 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:12:06.055735 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:12:06.057471 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.45481637, "process_in_blocks": "0", "process_kernel_time": 0.200826, "process_mem_max_rss": "118718464", "process_out_blocks": "0", "process_user_time": 0.979231}
[0m22:12:06.057726 [debug] [MainThread]: Command `dbt build` failed at 22:12:06.057677 after 0.46 seconds
[0m22:12:06.057943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10786a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10786b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b04b90>]}
[0m22:12:06.058136 [debug] [MainThread]: Flushing usage events
[0m22:12:07.659152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:13:12.753355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2bb10>]}


============================== 22:13:12.756653 | 59458207-869d-46f5-8b0c-3f1f0cdcbf52 ==============================
[0m22:13:12.756653 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:13:12.756991 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m22:13:12.863226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59458207-869d-46f5-8b0c-3f1f0cdcbf52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106027e10>]}
[0m22:13:12.891842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59458207-869d-46f5-8b0c-3f1f0cdcbf52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba7bd0>]}
[0m22:13:12.892416 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:13:12.947316 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:13:13.027391 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:13:13.027747 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:13:13.027917 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:13:13.028060 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:13:13.028192 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:13:13.028322 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:13:13.028578 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:13:13.028707 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:13:13.028917 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:13:13.113204 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_activity_types (models/staging/stg_activity_types.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:13:13.114926 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.40272528, "process_in_blocks": "0", "process_kernel_time": 0.193939, "process_mem_max_rss": "119799808", "process_out_blocks": "0", "process_user_time": 0.945373}
[0m22:13:13.115182 [debug] [MainThread]: Command `dbt build` failed at 22:13:13.115131 after 0.40 seconds
[0m22:13:13.115387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c64b90>]}
[0m22:13:13.115564 [debug] [MainThread]: Flushing usage events
[0m22:13:14.756179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:16:28.808350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108518050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093639d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109363b10>]}


============================== 22:16:28.812006 | b56e8cda-795e-4af3-89ae-c231b13e879a ==============================
[0m22:16:28.812006 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:16:28.812382 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None', 'static_parser': 'True', 'debug': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'cache_selected_only': 'False', 'version_check': 'True', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True'}
[0m22:16:28.927542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b56e8cda-795e-4af3-89ae-c231b13e879a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108663e10>]}
[0m22:16:28.957595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b56e8cda-795e-4af3-89ae-c231b13e879a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e3bd0>]}
[0m22:16:28.958397 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:16:29.007917 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:16:29.086510 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:16:29.086865 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:16:29.087035 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:16:29.087307 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:16:29.087448 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:16:29.087586 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:16:29.087708 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:16:29.087833 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:16:29.088032 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:16:29.175202 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:16:29.176941 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.41306493, "process_in_blocks": "0", "process_kernel_time": 0.191384, "process_mem_max_rss": "118489088", "process_out_blocks": "0", "process_user_time": 0.941368}
[0m22:16:29.179074 [debug] [MainThread]: Command `dbt build` failed at 22:16:29.179026 after 0.42 seconds
[0m22:16:29.179279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ffe450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fff450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a8b90>]}
[0m22:16:29.179460 [debug] [MainThread]: Flushing usage events
[0m22:16:30.774534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:49.749632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108833b10>]}


============================== 22:17:49.753658 | bdfbc4b4-8779-462c-aef2-bafa74aa6683 ==============================
[0m22:17:49.753658 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:17:49.754038 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'write_json': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'use_colors': 'True'}
[0m22:17:49.862660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdfbc4b4-8779-462c-aef2-bafa74aa6683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1fe10>]}
[0m22:17:49.894111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdfbc4b4-8779-462c-aef2-bafa74aa6683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db3bd0>]}
[0m22:17:49.894805 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:17:49.951318 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:17:50.030675 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:17:50.031002 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:17:50.031166 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:17:50.031304 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:17:50.031434 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:17:50.031561 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:17:50.031807 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:17:50.031937 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:17:50.032145 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:17:50.117004 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:17:50.118785 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.42748624, "process_in_blocks": "0", "process_kernel_time": 0.197002, "process_mem_max_rss": "120389632", "process_out_blocks": "0", "process_user_time": 0.947132}
[0m22:17:50.119039 [debug] [MainThread]: Command `dbt build` failed at 22:17:50.118988 after 0.43 seconds
[0m22:17:50.119242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109476450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109477450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0c4b90>]}
[0m22:17:50.119425 [debug] [MainThread]: Flushing usage events
[0m22:17:51.815074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:02.931976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d37b10>]}


============================== 22:18:02.937221 | 6cdf3658-878e-4ae4-b029-c1494ea9292b ==============================
[0m22:18:02.937221 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:18:02.937598 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'empty': 'False', 'write_json': 'True', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False'}
[0m22:18:03.045621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cdf3658-878e-4ae4-b029-c1494ea9292b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105533e10>]}
[0m22:18:03.074584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cdf3658-878e-4ae4-b029-c1494ea9292b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb3bd0>]}
[0m22:18:03.075336 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:18:03.125421 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:18:03.199572 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:18:03.199917 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:18:03.200220 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:18:03.200370 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:18:03.200506 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:18:03.200636 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:18:03.200761 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:18:03.200881 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:18:03.201088 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:18:03.284648 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_activity_types (models/staging/stg_activity_types.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:18:03.286407 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.39889118, "process_in_blocks": "0", "process_kernel_time": 0.190499, "process_mem_max_rss": "119160832", "process_out_blocks": "0", "process_user_time": 0.946009}
[0m22:18:03.286663 [debug] [MainThread]: Command `dbt build` failed at 22:18:03.286612 after 0.40 seconds
[0m22:18:03.286866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c22350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c23450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec4b90>]}
[0m22:18:03.287041 [debug] [MainThread]: Flushing usage events
[0m22:18:04.624066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:51.315877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104388050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106133b10>]}


============================== 22:18:51.319398 | f8001004-134f-4620-8c5f-79aab87fa128 ==============================
[0m22:18:51.319398 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:18:51.319757 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'send_anonymous_usage_stats': 'True'}
[0m22:18:51.432935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8001004-134f-4620-8c5f-79aab87fa128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104833e10>]}
[0m22:18:51.461603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8001004-134f-4620-8c5f-79aab87fa128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb3bd0>]}
[0m22:18:51.462318 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:18:51.511440 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:18:51.591384 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:18:51.591846 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:18:51.592014 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:18:51.592175 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:18:51.592306 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:18:51.592435 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:18:51.592561 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:18:51.592686 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:18:51.592893 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:18:51.677382 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_activity (models/staging/stg_activity.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:18:51.679135 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.40595576, "process_in_blocks": "0", "process_kernel_time": 0.18773, "process_mem_max_rss": "119029760", "process_out_blocks": "0", "process_user_time": 0.933552}
[0m22:18:51.679386 [debug] [MainThread]: Command `dbt build` failed at 22:18:51.679336 after 0.41 seconds
[0m22:18:51.679590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107722450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107722250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c8b90>]}
[0m22:18:51.679770 [debug] [MainThread]: Flushing usage events
[0m22:18:53.438829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:01.330914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2e8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf37b10>]}


============================== 22:19:01.334217 | fb0578ec-b379-4a58-a82f-b9d07629c336 ==============================
[0m22:19:01.334217 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:19:01.334546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'empty': 'False', 'static_parser': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'log_cache_events': 'False'}
[0m22:19:01.431948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb0578ec-b379-4a58-a82f-b9d07629c336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a533e10>]}
[0m22:19:01.461187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb0578ec-b379-4a58-a82f-b9d07629c336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdb3bd0>]}
[0m22:19:01.462033 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:19:01.514903 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:19:01.589578 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:19:01.589923 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:19:01.590090 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:19:01.590228 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:19:01.590357 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:19:01.590609 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:19:01.590738 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:19:01.590865 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:19:01.591062 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:19:01.684987 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_fields (models/staging/stg_fields.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:19:01.686963 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.40417996, "process_in_blocks": "0", "process_kernel_time": 0.195688, "process_mem_max_rss": "111575040", "process_out_blocks": "0", "process_user_time": 0.994424}
[0m22:19:01.688704 [debug] [MainThread]: Command `dbt build` failed at 22:19:01.688526 after 0.41 seconds
[0m22:19:01.688979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd24850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd26450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfc5400>]}
[0m22:19:01.689276 [debug] [MainThread]: Flushing usage events
[0m22:19:03.000447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:09.246310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a737b10>]}


============================== 22:19:09.250212 | 362dd132-5bdf-47d9-990a-17e904467c0d ==============================
[0m22:19:09.250212 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:19:09.250650 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True'}
[0m22:19:09.364439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '362dd132-5bdf-47d9-990a-17e904467c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e2fe10>]}
[0m22:19:09.398102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '362dd132-5bdf-47d9-990a-17e904467c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b3bd0>]}
[0m22:19:09.399167 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:19:09.462090 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:19:09.542960 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:19:09.543494 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:19:09.543680 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:19:09.543832 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:19:09.543963 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:19:09.544095 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:19:09.544222 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:19:09.544350 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:19:09.544572 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:19:09.645947 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:19:09.647884 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.44673824, "process_in_blocks": "0", "process_kernel_time": 0.170342, "process_mem_max_rss": "110608384", "process_out_blocks": "0", "process_user_time": 0.973287}
[0m22:19:09.648174 [debug] [MainThread]: Command `dbt build` failed at 22:19:09.648117 after 0.45 seconds
[0m22:19:09.648385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c320850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c322450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5c5400>]}
[0m22:19:09.648579 [debug] [MainThread]: Flushing usage events
[0m22:19:10.951422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:16.922819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722bb10>]}


============================== 22:19:16.926115 | 6dde73d7-ae69-472a-ab37-ce7a2c3b49d7 ==============================
[0m22:19:16.926115 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:19:16.926507 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'write_json': 'True'}
[0m22:19:17.026243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dde73d7-ae69-472a-ab37-ce7a2c3b49d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652be10>]}
[0m22:19:17.056048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dde73d7-ae69-472a-ab37-ce7a2c3b49d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070abbd0>]}
[0m22:19:17.057484 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:19:17.104955 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:19:17.178388 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:19:17.178731 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:19:17.178901 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:19:17.179167 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:19:17.179307 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:19:17.179440 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:19:17.179567 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:19:17.179691 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:19:17.179891 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:19:17.278039 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_stages (models/staging/stg_stages.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:19:17.279835 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.39746276, "process_in_blocks": "0", "process_kernel_time": 0.180787, "process_mem_max_rss": "120979456", "process_out_blocks": "0", "process_user_time": 0.977974}
[0m22:19:17.280088 [debug] [MainThread]: Command `dbt build` failed at 22:19:17.280040 after 0.40 seconds
[0m22:19:17.280283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e72250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e72150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081196d0>]}
[0m22:19:17.280472 [debug] [MainThread]: Flushing usage events
[0m22:19:18.678621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:26.584959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104e0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112337b10>]}


============================== 22:19:26.588264 | b088fab1-2861-4a8e-abfc-bed950eba0db ==============================
[0m22:19:26.588264 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:19:26.588617 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'no_print': 'None'}
[0m22:19:26.683541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b088fab1-2861-4a8e-abfc-bed950eba0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110933e10>]}
[0m22:19:26.713040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b088fab1-2861-4a8e-abfc-bed950eba0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b3bd0>]}
[0m22:19:26.714418 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:19:26.760845 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:19:26.834528 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:19:26.835037 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:19:26.835251 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:19:26.835944 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:19:26.836156 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:19:26.836328 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:19:26.836480 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:19:26.836628 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:19:26.836872 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:19:26.924430 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m22:19:26.926200 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.38418067, "process_in_blocks": "0", "process_kernel_time": 0.167161, "process_mem_max_rss": "119767040", "process_out_blocks": "0", "process_user_time": 0.960895}
[0m22:19:26.926460 [debug] [MainThread]: Command `dbt build` failed at 22:19:26.926409 after 0.38 seconds
[0m22:19:26.926668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141d0b90>]}
[0m22:19:26.926850 [debug] [MainThread]: Flushing usage events
[0m22:19:28.358506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:40.913878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104668050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b7b10>]}


============================== 22:19:40.917304 | 283a2017-8a92-47c9-924b-81ea968282a5 ==============================
[0m22:19:40.917304 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:19:40.917647 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False'}
[0m22:19:41.020157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '283a2017-8a92-47c9-924b-81ea968282a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047afe10>]}
[0m22:19:41.049388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '283a2017-8a92-47c9-924b-81ea968282a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105333bd0>]}
[0m22:19:41.050308 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:19:41.101982 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:19:41.178787 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 1 files changed.
[0m22:19:41.179151 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:19:41.179324 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:19:41.179604 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:19:41.179742 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:19:41.179873 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:19:41.179996 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:19:41.180117 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:19:41.180321 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:19:41.418015 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:19:41.418336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '283a2017-8a92-47c9-924b-81ea968282a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fbc50>]}
[0m22:19:41.480394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '283a2017-8a92-47c9-924b-81ea968282a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061859a0>]}
[0m22:19:41.527106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:19:41.528757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:19:41.552086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '283a2017-8a92-47c9-924b-81ea968282a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e9d30>]}
[0m22:19:41.552368 [info ] [MainThread]: Found 7 models, 23 data tests, 6 sources, 434 macros
[0m22:19:41.553890 [info ] [MainThread]: 
[0m22:19:41.554059 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:19:41.554189 [info ] [MainThread]: 
[0m22:19:41.554418 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:19:41.554807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:19:41.606400 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:19:41.606671 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:19:41.606824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:41.934388 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.327 seconds
[0m22:19:41.935968 [debug] [ThreadPool]: On list_postgres: Close
[0m22:19:41.941378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m22:19:41.946549 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:19:41.947014 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:19:41.947243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:41.978895 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m22:19:41.979260 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:19:41.979453 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:19:41.988122 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m22:19:41.989022 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:19:41.989644 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:19:41.992429 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:41.992662 [debug] [MainThread]: On master: BEGIN
[0m22:19:41.992795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:42.012358 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m22:19:42.012807 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:42.013218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:19:42.023784 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m22:19:42.024974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '283a2017-8a92-47c9-924b-81ea968282a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106889f30>]}
[0m22:19:42.025385 [debug] [MainThread]: On master: ROLLBACK
[0m22:19:42.026183 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:42.026409 [debug] [MainThread]: On master: BEGIN
[0m22:19:42.027654 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:19:42.027876 [debug] [MainThread]: On master: COMMIT
[0m22:19:42.028084 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:42.028280 [debug] [MainThread]: On master: COMMIT
[0m22:19:42.029022 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:19:42.029238 [debug] [MainThread]: On master: Close
[0m22:19:42.032182 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m22:19:42.032672 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m22:19:42.033064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity_types)
[0m22:19:42.033366 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m22:19:42.040859 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m22:19:42.042170 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m22:19:42.081951 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m22:19:42.082899 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:19:42.083114 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m22:19:42.083290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:42.103031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m22:19:42.103328 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:19:42.103559 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity_types"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:19:42.115692 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.012 seconds
[0m22:19:42.126480 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:19:42.126724 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:19:42.126901 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:19:42.128313 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:19:42.129456 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m22:19:42.130762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283a2017-8a92-47c9-924b-81ea968282a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106629490>]}
[0m22:19:42.131143 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mSELECT 4[0m in 0.10s]
[0m22:19:42.131453 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m22:19:42.131853 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:19:42.132093 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_activity_types_activity_type_id ................. [RUN]
[0m22:19:42.132366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m22:19:42.132537 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:19:42.137337 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:19:42.138598 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:19:42.148185 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:19:42.148863 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:19:42.149045 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m22:19:42.149201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:42.167065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:19:42.167355 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:19:42.167550 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m22:19:42.168894 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:19:42.170762 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m22:19:42.171506 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m22:19:42.171863 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.04s]
[0m22:19:42.172161 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:19:42.172368 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:19:42.172547 [info ] [Thread-1 (]: 3 of 4 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m22:19:42.172820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m22:19:42.173062 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:19:42.176124 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:19:42.176669 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:19:42.177785 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:19:42.178262 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:19:42.178454 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m22:19:42.179058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:42.197939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:19:42.198253 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:19:42.198467 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:19:42.199788 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public_pipedrive_analytics.stg_activity" does not exist
LINE 16:     from "postgres"."public_pipedrive_analytics"."stg_activi...
                  ^

[0m22:19:42.200027 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m22:19:42.200721 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m22:19:42.207045 [debug] [Thread-1 (]: Database Error in test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_ (models/staging/stg_schema.yml)
  relation "public_pipedrive_analytics.stg_activity" does not exist
  LINE 16:     from "postgres"."public_pipedrive_analytics"."stg_activi...
                    ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_schema.yml/relationships_stg_activity_2f0434dbe72ab4452fa0ba2398fa593b.sql
[0m22:19:42.207391 [error] [Thread-1 (]: 3 of 4 ERROR relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[31mERROR[0m in 0.03s]
[0m22:19:42.207705 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:19:42.207904 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:19:42.208145 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_ (models/staging/stg_schema.yml)
  relation "public_pipedrive_analytics.stg_activity" does not exist
  LINE 16:     from "postgres"."public_pipedrive_analytics"."stg_activi...
                    ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_schema.yml/relationships_stg_activity_2f0434dbe72ab4452fa0ba2398fa593b.sql.
[0m22:19:42.208348 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_activity_types_activity_type_id ................... [RUN]
[0m22:19:42.208775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m22:19:42.208954 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:19:42.212504 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:19:42.212977 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:19:42.214049 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:19:42.214501 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:19:42.214677 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m22:19:42.214833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:42.235212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m22:19:42.235516 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:19:42.235709 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:19:42.237355 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:19:42.238395 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m22:19:42.239407 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m22:19:42.240090 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_activity_types_activity_type_id ......................... [[32mPASS[0m in 0.03s]
[0m22:19:42.240797 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:19:42.242523 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:42.242941 [debug] [MainThread]: On master: BEGIN
[0m22:19:42.243110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:19:42.262721 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m22:19:42.263015 [debug] [MainThread]: On master: COMMIT
[0m22:19:42.263173 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:42.263301 [debug] [MainThread]: On master: COMMIT
[0m22:19:42.263842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:19:42.263979 [debug] [MainThread]: On master: Close
[0m22:19:42.264197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:42.264334 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd' was properly closed.
[0m22:19:42.264513 [info ] [MainThread]: 
[0m22:19:42.264666 [info ] [MainThread]: Finished running 1 incremental model, 3 data tests in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m22:19:42.265195 [debug] [MainThread]: Command end result
[0m22:19:42.282087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:19:42.283195 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:19:42.286979 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:19:42.287221 [info ] [MainThread]: 
[0m22:19:42.287405 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:19:42.287550 [info ] [MainThread]: 
[0m22:19:42.287729 [error] [MainThread]: [31mFailure in test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_ (models/staging/stg_schema.yml)[0m
[0m22:19:42.287906 [error] [MainThread]:   Database Error in test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_ (models/staging/stg_schema.yml)
  relation "public_pipedrive_analytics.stg_activity" does not exist
  LINE 16:     from "postgres"."public_pipedrive_analytics"."stg_activi...
                    ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_schema.yml/relationships_stg_activity_2f0434dbe72ab4452fa0ba2398fa593b.sql
[0m22:19:42.288036 [info ] [MainThread]: 
[0m22:19:42.288189 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_schema.yml/relationships_stg_activity_2f0434dbe72ab4452fa0ba2398fa593b.sql
[0m22:19:42.288313 [info ] [MainThread]: 
[0m22:19:42.288449 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m22:19:42.288706 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:19:42.290558 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4268663, "process_in_blocks": "0", "process_kernel_time": 0.252665, "process_mem_max_rss": "133005312", "process_out_blocks": "0", "process_user_time": 1.464165}
[0m22:19:42.290865 [debug] [MainThread]: Command `dbt build` failed at 22:19:42.290816 after 1.43 seconds
[0m22:19:42.291061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106947b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106947c50>]}
[0m22:19:42.291236 [debug] [MainThread]: Flushing usage events
[0m22:19:43.618777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:11.682369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a4c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489bb10>]}


============================== 22:24:11.685871 | 40db31da-1780-4c1e-9ee3-38bdff247a9c ==============================
[0m22:24:11.685871 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:24:11.686213 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'quiet': 'False', 'write_json': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:24:11.794097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40db31da-1780-4c1e-9ee3-38bdff247a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b97e10>]}
[0m22:24:11.822869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40db31da-1780-4c1e-9ee3-38bdff247a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717bd0>]}
[0m22:24:11.823501 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:24:11.879726 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:24:11.961456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:24:11.962096 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:24:12.217952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40db31da-1780-4c1e-9ee3-38bdff247a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d8f50>]}
[0m22:24:12.261816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:24:12.263472 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:24:12.286132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40db31da-1780-4c1e-9ee3-38bdff247a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105842120>]}
[0m22:24:12.286426 [info ] [MainThread]: Found 7 models, 23 data tests, 6 sources, 434 macros
[0m22:24:12.287916 [info ] [MainThread]: 
[0m22:24:12.288090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:12.288224 [info ] [MainThread]: 
[0m22:24:12.288458 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:12.288900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:24:12.343802 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:24:12.344160 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:24:12.344322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:12.439466 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.095 seconds
[0m22:24:12.440529 [debug] [ThreadPool]: On list_postgres: Close
[0m22:24:12.445386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m22:24:12.449639 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:24:12.449983 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:24:12.450159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:12.485455 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m22:24:12.485951 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:24:12.486200 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:24:12.497683 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m22:24:12.498681 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:24:12.499610 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:24:12.503002 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:12.503249 [debug] [MainThread]: On master: BEGIN
[0m22:24:12.503388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:12.529257 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m22:24:12.529505 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:12.529703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:24:12.533908 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m22:24:12.534549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40db31da-1780-4c1e-9ee3-38bdff247a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f2b30>]}
[0m22:24:12.534789 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:12.535531 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:12.535713 [debug] [MainThread]: On master: BEGIN
[0m22:24:12.538362 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:24:12.538570 [debug] [MainThread]: On master: COMMIT
[0m22:24:12.538718 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:12.538847 [debug] [MainThread]: On master: COMMIT
[0m22:24:12.539470 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:24:12.539625 [debug] [MainThread]: On master: Close
[0m22:24:12.541817 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m22:24:12.542164 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m22:24:12.542432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity_types)
[0m22:24:12.542618 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m22:24:12.548773 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.549552 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m22:24:12.579086 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.579369 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

    
  
    

  create temporary table "stg_activity_types__dbt_tmp222412566478"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE activity_type_id NOT IN (SELECT activity_type_id FROM "postgres"."public_pipedrive_analytics"."stg_activity_types")

  );
  
  
[0m22:24:12.579558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:12.603589 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.024 seconds
[0m22:24:12.611516 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.611758 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m22:24:12.612490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:24:12.612670 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.612846 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp222412566478'
        
      order by ordinal_position

  
[0m22:24:12.628781 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.016 seconds
[0m22:24:12.631834 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.632076 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:24:12.634675 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:24:12.642468 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.642721 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp222412566478'
        
      order by ordinal_position

  
[0m22:24:12.644834 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:24:12.646854 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.647089 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:24:12.649122 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:24:12.655295 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:24:12.664135 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.665043 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.665281 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_activity_types" as DBT_INTERNAL_DEST
        where (activity_type_id) in (
            select distinct activity_type_id
            from "stg_activity_types__dbt_tmp222412566478" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_activity_types" ("activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_activity_types__dbt_tmp222412566478"
    )
  
[0m22:24:12.669375 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m22:24:12.677842 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:24:12.678144 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:24:12.678326 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:24:12.680100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:24:12.681318 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m22:24:12.682982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40db31da-1780-4c1e-9ee3-38bdff247a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e54a10>]}
[0m22:24:12.683651 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mINSERT 0 0[0m in 0.14s]
[0m22:24:12.684150 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m22:24:12.684708 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:24:12.684967 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_activity_types_activity_type_id ................. [RUN]
[0m22:24:12.685242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m22:24:12.685440 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:24:12.690981 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:24:12.691678 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:24:12.700979 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:24:12.701621 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:24:12.701801 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m22:24:12.701956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:12.718884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:24:12.719172 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:24:12.719369 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:12.720620 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:24:12.722500 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m22:24:12.723405 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m22:24:12.723762 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.04s]
[0m22:24:12.724057 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:24:12.724258 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:24:12.724434 [info ] [Thread-1 (]: 3 of 4 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m22:24:12.724680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m22:24:12.724855 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:24:12.727861 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:24:12.728433 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:24:12.729514 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:24:12.729938 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:24:12.730128 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m22:24:12.730291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:12.751196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:24:12.751503 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:24:12.751716 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:24:12.752565 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public_pipedrive_analytics.stg_activity" does not exist
LINE 16:     from "postgres"."public_pipedrive_analytics"."stg_activi...
                  ^

[0m22:24:12.752804 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m22:24:12.753461 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m22:24:12.759737 [debug] [Thread-1 (]: Database Error in test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_ (models/staging/stg_schema.yml)
  relation "public_pipedrive_analytics.stg_activity" does not exist
  LINE 16:     from "postgres"."public_pipedrive_analytics"."stg_activi...
                    ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_schema.yml/relationships_stg_activity_2f0434dbe72ab4452fa0ba2398fa593b.sql
[0m22:24:12.760088 [error] [Thread-1 (]: 3 of 4 ERROR relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[31mERROR[0m in 0.04s]
[0m22:24:12.760399 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:24:12.760600 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:24:12.760862 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_ (models/staging/stg_schema.yml)
  relation "public_pipedrive_analytics.stg_activity" does not exist
  LINE 16:     from "postgres"."public_pipedrive_analytics"."stg_activi...
                    ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_schema.yml/relationships_stg_activity_2f0434dbe72ab4452fa0ba2398fa593b.sql.
[0m22:24:12.761076 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_activity_types_activity_type_id ................... [RUN]
[0m22:24:12.761526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m22:24:12.761724 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:24:12.765298 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:24:12.765753 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:24:12.766828 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:24:12.767306 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:24:12.767467 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m22:24:12.767612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:12.784413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:24:12.784726 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:24:12.784932 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:24:12.786129 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:24:12.786989 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m22:24:12.787586 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m22:24:12.787914 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_activity_types_activity_type_id ......................... [[32mPASS[0m in 0.03s]
[0m22:24:12.788197 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:24:12.788831 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:12.789027 [debug] [MainThread]: On master: BEGIN
[0m22:24:12.789238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:12.806629 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m22:24:12.806911 [debug] [MainThread]: On master: COMMIT
[0m22:24:12.807072 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:12.807212 [debug] [MainThread]: On master: COMMIT
[0m22:24:12.807791 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:24:12.807941 [debug] [MainThread]: On master: Close
[0m22:24:12.808170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:12.808301 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd' was properly closed.
[0m22:24:12.808468 [info ] [MainThread]: 
[0m22:24:12.808630 [info ] [MainThread]: Finished running 1 incremental model, 3 data tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m22:24:12.809175 [debug] [MainThread]: Command end result
[0m22:24:12.827367 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:24:12.828583 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:24:12.831917 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:24:12.832111 [info ] [MainThread]: 
[0m22:24:12.832280 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:24:12.832426 [info ] [MainThread]: 
[0m22:24:12.832657 [error] [MainThread]: [31mFailure in test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_ (models/staging/stg_schema.yml)[0m
[0m22:24:12.832883 [error] [MainThread]:   Database Error in test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_ (models/staging/stg_schema.yml)
  relation "public_pipedrive_analytics.stg_activity" does not exist
  LINE 16:     from "postgres"."public_pipedrive_analytics"."stg_activi...
                    ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_schema.yml/relationships_stg_activity_2f0434dbe72ab4452fa0ba2398fa593b.sql
[0m22:24:12.833029 [info ] [MainThread]: 
[0m22:24:12.833192 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_schema.yml/relationships_stg_activity_2f0434dbe72ab4452fa0ba2398fa593b.sql
[0m22:24:12.833323 [info ] [MainThread]: 
[0m22:24:12.833463 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m22:24:12.835482 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2077646, "process_in_blocks": "0", "process_kernel_time": 0.257102, "process_mem_max_rss": "133988352", "process_out_blocks": "0", "process_user_time": 1.407205}
[0m22:24:12.835813 [debug] [MainThread]: Command `dbt build` failed at 22:24:12.835764 after 1.21 seconds
[0m22:24:12.836145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104719850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105993e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059931d0>]}
[0m22:24:12.836406 [debug] [MainThread]: Flushing usage events
[0m22:24:14.428138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:36.426089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241e8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126437b10>]}


============================== 22:24:36.430480 | 48d976ac-5e37-47a4-b1b8-b5a7d98f6b37 ==============================
[0m22:24:36.430480 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:24:36.430868 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'invocation_command': 'dbt build -s tag:staging'}
[0m22:24:36.552968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48d976ac-5e37-47a4-b1b8-b5a7d98f6b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12452fe10>]}
[0m22:24:36.581113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48d976ac-5e37-47a4-b1b8-b5a7d98f6b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262b3bd0>]}
[0m22:24:36.581714 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:24:36.637771 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:24:36.713035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:36.713279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:36.737077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48d976ac-5e37-47a4-b1b8-b5a7d98f6b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127223b50>]}
[0m22:24:36.782672 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:24:36.784053 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:24:36.804683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48d976ac-5e37-47a4-b1b8-b5a7d98f6b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274b2d50>]}
[0m22:24:36.804970 [info ] [MainThread]: Found 7 models, 23 data tests, 6 sources, 434 macros
[0m22:24:36.805301 [warn ] [MainThread]: The selection criterion 'tag:staging' does not match any enabled nodes
[0m22:24:36.805535 [warn ] [MainThread]: The selection criterion 'tag:staging' does not match any enabled nodes
[0m22:24:36.805699 [warn ] [MainThread]: The selection criterion 'tag:staging' does not match any enabled nodes
[0m22:24:36.806301 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:24:36.807273 [debug] [MainThread]: Command end result
[0m22:24:36.929434 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:24:36.930728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:24:36.932561 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:24:36.934280 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.556412, "process_in_blocks": "0", "process_kernel_time": 0.252634, "process_mem_max_rss": "116211712", "process_out_blocks": "0", "process_user_time": 1.147386}
[0m22:24:36.934504 [debug] [MainThread]: Command `dbt build` succeeded at 22:24:36.934461 after 0.56 seconds
[0m22:24:36.934693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f87150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f86c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274b4870>]}
[0m22:24:36.934858 [debug] [MainThread]: Flushing usage events
[0m22:24:38.551486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:25.365998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110733b10>]}


============================== 22:29:25.369952 | f03ff37f-3ef6-49e4-96a3-4837891d898a ==============================
[0m22:29:25.369952 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:29:25.370340 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'invocation_command': 'dbt build -s tag:staging', 'cache_selected_only': 'False'}
[0m22:29:25.476632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106533e10>]}
[0m22:29:25.506158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b3bd0>]}
[0m22:29:25.506869 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:29:25.559153 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:29:25.642092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m22:29:25.642872 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:29:25.643050 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:29:25.643193 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_stages.sql
[0m22:29:25.643328 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m22:29:25.643454 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:29:25.643578 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m22:29:25.643697 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m22:29:25.643817 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:29:25.924781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112324250>]}
[0m22:29:25.969029 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:29:25.970417 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:29:25.992482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299b020>]}
[0m22:29:25.992773 [info ] [MainThread]: Found 7 models, 23 data tests, 6 sources, 434 macros
[0m22:29:25.994066 [info ] [MainThread]: 
[0m22:29:25.994241 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:25.994373 [info ] [MainThread]: 
[0m22:29:25.994593 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:29:25.996529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:29:26.047497 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:29:26.047735 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:29:26.047874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:26.150899 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.103 seconds
[0m22:29:26.151885 [debug] [ThreadPool]: On list_postgres: Close
[0m22:29:26.152936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m22:29:26.156474 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:29:26.156739 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:29:26.156897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:26.174564 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m22:29:26.174870 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:29:26.175059 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:29:26.179474 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m22:29:26.180420 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:29:26.181121 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:29:26.184275 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:26.184513 [debug] [MainThread]: On master: BEGIN
[0m22:29:26.184651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:26.202329 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m22:29:26.202616 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:26.202838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:29:26.206261 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m22:29:26.207122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a03d90>]}
[0m22:29:26.207429 [debug] [MainThread]: On master: ROLLBACK
[0m22:29:26.208120 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:26.208275 [debug] [MainThread]: On master: BEGIN
[0m22:29:26.209272 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:29:26.209423 [debug] [MainThread]: On master: COMMIT
[0m22:29:26.209563 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:26.209694 [debug] [MainThread]: On master: COMMIT
[0m22:29:26.210289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:29:26.210432 [debug] [MainThread]: On master: Close
[0m22:29:26.212646 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m22:29:26.213004 [info ] [Thread-1 (]: 1 of 30 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m22:29:26.213283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m22:29:26.213481 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m22:29:26.218503 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m22:29:26.219078 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m22:29:26.248216 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m22:29:26.248873 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:29:26.249053 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m22:29:26.249202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.271166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m22:29:26.271493 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:29:26.271723 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM raw
    QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:29:26.272706 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ROW_NUMBER"
LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                     ^

[0m22:29:26.272914 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: ROLLBACK
[0m22:29:26.273652 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m22:29:26.280603 [debug] [Thread-1 (]: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:29:26.281962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eb24e0>]}
[0m22:29:26.282359 [error] [Thread-1 (]: 1 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_activity  [[31mERROR[0m in 0.07s]
[0m22:29:26.282677 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m22:29:26.282888 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m22:29:26.283140 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_activity' to be skipped because of status 'error'.  Reason: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql.
[0m22:29:26.283415 [info ] [Thread-1 (]: 2 of 30 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m22:29:26.284000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m22:29:26.284200 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m22:29:26.286594 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.287157 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m22:29:26.290474 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.290824 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

    
  
    

  create temporary table "stg_activity_types__dbt_tmp222926288157"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE activity_type_id NOT IN (SELECT activity_type_id FROM "postgres"."public_pipedrive_analytics"."stg_activity_types")

  );
  
  
[0m22:29:26.291042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.310520 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m22:29:26.318145 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.318388 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m22:29:26.319169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:29:26.319356 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.319534 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp222926288157'
        
      order by ordinal_position

  
[0m22:29:26.329881 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.010 seconds
[0m22:29:26.333209 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.333493 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:29:26.337389 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m22:29:26.345461 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.345783 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp222926288157'
        
      order by ordinal_position

  
[0m22:29:26.348344 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:29:26.350519 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.350766 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:29:26.353178 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:29:26.358094 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:29:26.365038 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.365663 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.365887 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_activity_types" as DBT_INTERNAL_DEST
        where (activity_type_id) in (
            select distinct activity_type_id
            from "stg_activity_types__dbt_tmp222926288157" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_activity_types" ("activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_activity_types__dbt_tmp222926288157"
    )
  
[0m22:29:26.367249 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:29:26.374707 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:29:26.374911 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:29:26.375071 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:29:26.376849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:29:26.377731 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m22:29:26.378066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a75490>]}
[0m22:29:26.378404 [info ] [Thread-1 (]: 2 of 30 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mINSERT 0 0[0m in 0.09s]
[0m22:29:26.378696 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m22:29:26.378918 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m22:29:26.379243 [info ] [Thread-1 (]: 3 of 30 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m22:29:26.379526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m22:29:26.379703 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m22:29:26.384027 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:29:26.384651 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m22:29:26.386933 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:29:26.387512 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:29:26.387681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m22:29:26.387832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.405328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:29:26.405613 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:29:26.405837 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (changed_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , changed_time,
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY changed_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if changed_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , changed_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m22:29:26.406709 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 28:         , changed_field_key
                 ^

[0m22:29:26.407036 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: ROLLBACK
[0m22:29:26.407787 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m22:29:26.410283 [debug] [Thread-1 (]: Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  syntax error at or near ","
  LINE 28:         , changed_field_key
                   ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:29:26.410609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a1fac0>]}
[0m22:29:26.410968 [error] [Thread-1 (]: 3 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_deal_changes  [[31mERROR[0m in 0.03s]
[0m22:29:26.411361 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m22:29:26.411589 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m22:29:26.411833 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  syntax error at or near ","
  LINE 28:         , changed_field_key
                   ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql.
[0m22:29:26.412090 [info ] [Thread-1 (]: 4 of 30 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m22:29:26.412472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m22:29:26.412662 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m22:29:26.414907 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m22:29:26.415384 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m22:29:26.417078 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m22:29:26.417500 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:29:26.417674 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m22:29:26.417824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.435380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:29:26.435659 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:29:26.435870 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:29:26.436866 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "field_name" does not exist
LINE 26:         , field_name
                   ^

[0m22:29:26.437078 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: ROLLBACK
[0m22:29:26.437623 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m22:29:26.439828 [debug] [Thread-1 (]: Database Error in model stg_fields (models/staging/stg_fields.sql)
  column "field_name" does not exist
  LINE 26:         , field_name
                     ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_fields.sql
[0m22:29:26.440080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d73c50>]}
[0m22:29:26.440394 [error] [Thread-1 (]: 4 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_fields  [[31mERROR[0m in 0.03s]
[0m22:29:26.440654 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m22:29:26.440830 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m22:29:26.441037 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_fields' to be skipped because of status 'error'.  Reason: Database Error in model stg_fields (models/staging/stg_fields.sql)
  column "field_name" does not exist
  LINE 26:         , field_name
                     ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_fields.sql.
[0m22:29:26.441249 [info ] [Thread-1 (]: 5 of 30 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m22:29:26.441550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m22:29:26.441707 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m22:29:26.443892 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m22:29:26.444360 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m22:29:26.446018 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m22:29:26.446380 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:29:26.446601 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m22:29:26.446809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.463558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:29:26.463846 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:29:26.464044 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_stages"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:29:26.465655 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m22:29:26.468632 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:29:26.468885 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:29:26.469055 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:29:26.470257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:29:26.470702 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m22:29:26.471023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d178d0>]}
[0m22:29:26.471368 [info ] [Thread-1 (]: 5 of 30 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mSELECT 9[0m in 0.03s]
[0m22:29:26.471655 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m22:29:26.471864 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m22:29:26.472123 [info ] [Thread-1 (]: 6 of 30 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m22:29:26.472388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m22:29:26.472559 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m22:29:26.474911 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m22:29:26.475565 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m22:29:26.477274 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:29:26.477482 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

    
  
    

  create temporary table "stg_users__dbt_tmp222926476508"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


      -- Only insert rows that don’t already exist in the target table
    WHERE user_id NOT IN (SELECT user_id FROM "postgres"."public_pipedrive_analytics"."stg_users")

  );
  
  
[0m22:29:26.477693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.503406 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.026 seconds
[0m22:29:26.505444 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:29:26.505666 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m22:29:26.506385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:29:26.506573 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:29:26.506757 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp222926476508'
        
      order by ordinal_position

  
[0m22:29:26.512158 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m22:29:26.513924 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:29:26.514140 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:29:26.516554 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:29:26.518179 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:29:26.518387 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp222926476508'
        
      order by ordinal_position

  
[0m22:29:26.520390 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:29:26.522275 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:29:26.522504 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:29:26.524744 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:29:26.525884 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:29:26.526534 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m22:29:26.527361 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:29:26.527565 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_users" as DBT_INTERNAL_DEST
        where (user_id) in (
            select distinct user_id
            from "stg_users__dbt_tmp222926476508" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_users" ("user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_users__dbt_tmp222926476508"
    )
  
[0m22:29:26.528522 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:29:26.529283 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:29:26.529480 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:29:26.529639 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:29:26.530906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:29:26.531290 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m22:29:26.531605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03ff37f-3ef6-49e4-96a3-4837891d898a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef6970>]}
[0m22:29:26.531948 [info ] [Thread-1 (]: 6 of 30 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mINSERT 0 0[0m in 0.06s]
[0m22:29:26.532238 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m22:29:26.532487 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:29:26.532805 [info ] [Thread-1 (]: 7 of 30 SKIP test not_null_stg_activity_activity_id ............................ [[33mSKIP[0m]
[0m22:29:26.533154 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:29:26.533402 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:29:26.533585 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5' to be skipped because of status 'skipped'. 
[0m22:29:26.533819 [info ] [Thread-1 (]: 8 of 30 SKIP test not_null_stg_activity_activity_type_short .................... [[33mSKIP[0m]
[0m22:29:26.534109 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:29:26.534316 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:29:26.534472 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844' to be skipped because of status 'skipped'. 
[0m22:29:26.534674 [info ] [Thread-1 (]: 9 of 30 SKIP test not_null_stg_activity_user_id ................................ [[33mSKIP[0m]
[0m22:29:26.534926 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:29:26.535115 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:29:26.535264 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272' to be skipped because of status 'skipped'. 
[0m22:29:26.535445 [info ] [Thread-1 (]: 10 of 30 SKIP test unique_stg_activity_activity_id ............................. [[33mSKIP[0m]
[0m22:29:26.535690 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:29:26.535870 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:29:26.536015 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9' to be skipped because of status 'skipped'. 
[0m22:29:26.536189 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m22:29:26.536476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m22:29:26.536678 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:29:26.541432 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:29:26.541936 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:29:26.551400 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:29:26.552361 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:29:26.552564 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m22:29:26.552717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.568868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:29:26.569134 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:29:26.569315 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m22:29:26.570345 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:29:26.572218 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m22:29:26.572866 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m22:29:26.573210 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.04s]
[0m22:29:26.573520 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:29:26.573719 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:29:26.573911 [info ] [Thread-1 (]: 12 of 30 SKIP test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[33mSKIP[0m]
[0m22:29:26.574103 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:29:26.574267 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:29:26.574429 [info ] [Thread-1 (]: 13 of 30 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m22:29:26.574631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m22:29:26.574794 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:29:26.578181 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:29:26.578403 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c' to be skipped because of status 'skipped'. 
[0m22:29:26.578964 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:29:26.580519 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:29:26.580966 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:29:26.581142 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m22:29:26.581298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.602607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:29:26.602900 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:29:26.603108 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:29:26.604552 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:29:26.605502 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m22:29:26.606202 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m22:29:26.606612 [info ] [Thread-1 (]: 13 of 30 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m22:29:26.606937 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:29:26.607150 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:29:26.607382 [info ] [Thread-1 (]: 14 of 30 SKIP test not_null_stg_deal_changes_deal_id ........................... [[33mSKIP[0m]
[0m22:29:26.607585 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:29:26.608038 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:29:26.608215 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e' to be skipped because of status 'skipped'. 
[0m22:29:26.608427 [info ] [Thread-1 (]: 15 of 30 SKIP test not_null_stg_deal_changes_deal_id_sk ........................ [[33mSKIP[0m]
[0m22:29:26.608748 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:29:26.608963 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:29:26.609122 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e' to be skipped because of status 'skipped'. 
[0m22:29:26.609324 [info ] [Thread-1 (]: 16 of 30 SKIP test not_null_stg_deal_changes_deal_updated_field_key ............ [[33mSKIP[0m]
[0m22:29:26.609590 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:29:26.609779 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:29:26.609926 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624' to be skipped because of status 'skipped'. 
[0m22:29:26.610119 [info ] [Thread-1 (]: 17 of 30 SKIP test relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_  [[33mSKIP[0m]
[0m22:29:26.610359 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:29:26.610529 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:29:26.610668 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb' to be skipped because of status 'skipped'. 
[0m22:29:26.610841 [info ] [Thread-1 (]: 18 of 30 SKIP test unique_stg_deal_changes_deal_id_sk .......................... [[33mSKIP[0m]
[0m22:29:26.611071 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:29:26.611238 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:29:26.611375 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600' to be skipped because of status 'skipped'. 
[0m22:29:26.611541 [info ] [Thread-1 (]: 19 of 30 SKIP test not_null_stg_fields_field_key ............................... [[33mSKIP[0m]
[0m22:29:26.611755 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:29:26.611962 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:29:26.612117 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe' to be skipped because of status 'skipped'. 
[0m22:29:26.612324 [info ] [Thread-1 (]: 20 of 30 SKIP test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[33mSKIP[0m]
[0m22:29:26.612576 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:29:26.612769 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:29:26.612949 [info ] [Thread-1 (]: 21 of 30 SKIP test unique_stg_fields_field_key ................................. [[33mSKIP[0m]
[0m22:29:26.613140 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:29:26.613308 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:29:26.613473 [info ] [Thread-1 (]: 22 of 30 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m22:29:26.613642 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa' to be skipped because of status 'skipped'. 
[0m22:29:26.613870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m22:29:26.614049 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4' to be skipped because of status 'skipped'. 
[0m22:29:26.614215 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:29:26.616521 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:29:26.617066 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:29:26.619270 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:29:26.619877 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:29:26.620060 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m22:29:26.620218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.643385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m22:29:26.643720 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:29:26.643922 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m22:29:26.645119 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:29:26.646062 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m22:29:26.646735 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m22:29:26.647092 [info ] [Thread-1 (]: 22 of 30 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:29:26.647392 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:29:26.647591 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:29:26.647835 [info ] [Thread-1 (]: 23 of 30 START test unique_stg_stages_stage_id ................................. [RUN]
[0m22:29:26.648252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m22:29:26.648500 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:29:26.652867 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:29:26.653445 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:29:26.654681 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:29:26.655168 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:29:26.655345 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m22:29:26.655501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.674722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:29:26.675085 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:29:26.675302 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:29:26.676922 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:29:26.677957 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m22:29:26.678698 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m22:29:26.679073 [info ] [Thread-1 (]: 23 of 30 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:29:26.679380 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:29:26.679581 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:29:26.679758 [info ] [Thread-1 (]: 24 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:29:26.679970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m22:29:26.680187 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:29:26.682533 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:29:26.683112 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:29:26.684723 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:29:26.685330 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:29:26.685499 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m22:29:26.685651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.704167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:29:26.704489 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:29:26.704684 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:29:26.705918 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:29:26.706910 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m22:29:26.707685 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m22:29:26.708140 [info ] [Thread-1 (]: 24 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:29:26.708520 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:29:26.708769 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:29:26.708997 [info ] [Thread-1 (]: 25 of 30 START test not_null_stg_users_user_name ............................... [RUN]
[0m22:29:26.709256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m22:29:26.709447 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:29:26.711829 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:29:26.712441 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:29:26.713900 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:29:26.714423 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:29:26.714624 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m22:29:26.714787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.731767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:29:26.732075 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:29:26.732336 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m22:29:26.733623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:29:26.734499 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m22:29:26.735144 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m22:29:26.735478 [info ] [Thread-1 (]: 25 of 30 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m22:29:26.735758 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:29:26.735952 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:29:26.736169 [info ] [Thread-1 (]: 26 of 30 SKIP test relationships_stg_activity_user_id__user_id__ref_stg_users_ . [[33mSKIP[0m]
[0m22:29:26.736355 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:29:26.736519 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:29:26.736801 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02' to be skipped because of status 'skipped'. 
[0m22:29:26.736679 [info ] [Thread-1 (]: 27 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m22:29:26.737104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m22:29:26.737268 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:29:26.739339 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:29:26.739865 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:29:26.740919 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:29:26.741281 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:29:26.741443 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m22:29:26.741592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:26.760192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:29:26.760466 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:29:26.760658 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:29:26.762647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:29:26.763593 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m22:29:26.764292 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m22:29:26.764661 [info ] [Thread-1 (]: 27 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m22:29:26.765075 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:29:26.765320 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m22:29:26.765840 [info ] [Thread-1 (]: 28 of 30 SKIP relation public_pipedrive_analytics.stg_lost_reasons ............. [[33mSKIP[0m]
[0m22:29:26.766468 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m22:29:26.766771 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_lost_reasons' to be skipped because of status 'skipped'. 
[0m22:29:26.767184 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:29:26.767464 [info ] [Thread-1 (]: 29 of 30 SKIP test not_null_stg_lost_reasons_lost_reason_id .................... [[33mSKIP[0m]
[0m22:29:26.767718 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:29:26.767918 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:29:26.768082 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768' to be skipped because of status 'skipped'. 
[0m22:29:26.768285 [info ] [Thread-1 (]: 30 of 30 SKIP test unique_stg_lost_reasons_lost_reason_id ...................... [[33mSKIP[0m]
[0m22:29:26.768550 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:29:26.768707 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' to be skipped because of status 'skipped'. 
[0m22:29:26.769305 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:26.769464 [debug] [MainThread]: On master: BEGIN
[0m22:29:26.769595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:29:26.787384 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m22:29:26.787646 [debug] [MainThread]: On master: COMMIT
[0m22:29:26.787800 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:26.787934 [debug] [MainThread]: On master: COMMIT
[0m22:29:26.788501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:29:26.788654 [debug] [MainThread]: On master: Close
[0m22:29:26.788892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:26.789080 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m22:29:26.789410 [info ] [MainThread]: 
[0m22:29:26.789629 [info ] [MainThread]: Finished running 7 incremental models, 23 data tests in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m22:29:26.791205 [debug] [MainThread]: Command end result
[0m22:29:26.808386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:29:26.809642 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:29:26.813987 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:29:26.814203 [info ] [MainThread]: 
[0m22:29:26.814377 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m22:29:26.814523 [info ] [MainThread]: 
[0m22:29:26.814694 [error] [MainThread]: [31mFailure in model stg_activity (models/staging/stg_activity.sql)[0m
[0m22:29:26.814859 [error] [MainThread]:   Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:29:26.814980 [info ] [MainThread]: 
[0m22:29:26.815124 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:29:26.815242 [info ] [MainThread]: 
[0m22:29:26.815391 [error] [MainThread]: [31mFailure in model stg_deal_changes (models/staging/stg_deal_changes.sql)[0m
[0m22:29:26.815545 [error] [MainThread]:   Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  syntax error at or near ","
  LINE 28:         , changed_field_key
                   ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:29:26.815723 [info ] [MainThread]: 
[0m22:29:26.815913 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:29:26.816048 [info ] [MainThread]: 
[0m22:29:26.816229 [error] [MainThread]: [31mFailure in model stg_fields (models/staging/stg_fields.sql)[0m
[0m22:29:26.816438 [error] [MainThread]:   Database Error in model stg_fields (models/staging/stg_fields.sql)
  column "field_name" does not exist
  LINE 26:         , field_name
                     ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_fields.sql
[0m22:29:26.816598 [info ] [MainThread]: 
[0m22:29:26.816760 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_fields.sql
[0m22:29:26.816907 [info ] [MainThread]: 
[0m22:29:26.817065 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=3 SKIP=17 NO-OP=0 TOTAL=30
[0m22:29:26.818822 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5046215, "process_in_blocks": "0", "process_kernel_time": 0.270408, "process_mem_max_rss": "137314304", "process_out_blocks": "0", "process_user_time": 1.562983}
[0m22:29:26.819048 [debug] [MainThread]: Command `dbt build` failed at 22:29:26.819005 after 1.50 seconds
[0m22:29:26.819226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112738e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104c7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112edbf50>]}
[0m22:29:26.819392 [debug] [MainThread]: Flushing usage events
[0m22:29:28.719733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:37.268964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104730050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c37b10>]}


============================== 22:30:37.273255 | ece32b0e-2d58-4d92-9c58-97c2bf38f0c9 ==============================
[0m22:30:37.273255 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:30:37.274285 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'empty': 'False', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s tag:staging', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m22:30:37.440506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b33e10>]}
[0m22:30:37.473792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b3bd0>]}
[0m22:30:37.474689 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:30:37.539611 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:30:37.644069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:30:37.644546 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:30:37.901207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107325450>]}
[0m22:30:37.950444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:30:37.952245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:30:37.974962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107357d40>]}
[0m22:30:37.975262 [info ] [MainThread]: Found 7 models, 23 data tests, 6 sources, 434 macros
[0m22:30:37.976651 [info ] [MainThread]: 
[0m22:30:37.976841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:30:37.976974 [info ] [MainThread]: 
[0m22:30:37.977219 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:30:37.979322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:30:38.045362 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:30:38.045666 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:30:38.045919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:38.130940 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.085 seconds
[0m22:30:38.131914 [debug] [ThreadPool]: On list_postgres: Close
[0m22:30:38.133162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m22:30:38.136724 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:30:38.137011 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:30:38.137148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:38.162428 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m22:30:38.162765 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:30:38.162936 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:30:38.167621 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m22:30:38.168624 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:30:38.169766 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:30:38.173288 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:38.173571 [debug] [MainThread]: On master: BEGIN
[0m22:30:38.173711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:38.192905 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m22:30:38.193169 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:38.193373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:30:38.197422 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m22:30:38.198232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061157f0>]}
[0m22:30:38.198526 [debug] [MainThread]: On master: ROLLBACK
[0m22:30:38.199180 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:38.199366 [debug] [MainThread]: On master: BEGIN
[0m22:30:38.200443 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:30:38.200600 [debug] [MainThread]: On master: COMMIT
[0m22:30:38.200738 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:38.200857 [debug] [MainThread]: On master: COMMIT
[0m22:30:38.201889 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:30:38.202165 [debug] [MainThread]: On master: Close
[0m22:30:38.204271 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m22:30:38.204585 [info ] [Thread-1 (]: 1 of 30 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m22:30:38.204828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m22:30:38.205004 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m22:30:38.209492 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m22:30:38.210313 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m22:30:38.240225 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m22:30:38.241005 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:30:38.241182 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m22:30:38.241331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.262351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:30:38.262626 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:30:38.262832 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM raw
    QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:30:38.264923 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ROW_NUMBER"
LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                     ^

[0m22:30:38.265114 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: ROLLBACK
[0m22:30:38.265648 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m22:30:38.274460 [debug] [Thread-1 (]: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:30:38.275584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b325b0>]}
[0m22:30:38.275943 [error] [Thread-1 (]: 1 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_activity  [[31mERROR[0m in 0.07s]
[0m22:30:38.276260 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m22:30:38.276464 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m22:30:38.276703 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_activity' to be skipped because of status 'error'.  Reason: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql.
[0m22:30:38.276943 [info ] [Thread-1 (]: 2 of 30 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m22:30:38.277462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m22:30:38.277649 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m22:30:38.279975 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.280588 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m22:30:38.283612 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.283892 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

    
  
    

  create temporary table "stg_activity_types__dbt_tmp223038281525"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE activity_type_id NOT IN (SELECT activity_type_id FROM "postgres"."public_pipedrive_analytics"."stg_activity_types")

  );
  
  
[0m22:30:38.284094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.302927 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m22:30:38.310413 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.310648 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m22:30:38.311471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:30:38.311677 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.311859 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223038281525'
        
      order by ordinal_position

  
[0m22:30:38.319548 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m22:30:38.322707 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.322953 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:30:38.325818 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m22:30:38.333664 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.333928 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223038281525'
        
      order by ordinal_position

  
[0m22:30:38.336139 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:30:38.338103 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.338323 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:30:38.340315 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:30:38.345534 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:30:38.353079 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.353692 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.353904 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_activity_types" as DBT_INTERNAL_DEST
        where (activity_type_id) in (
            select distinct activity_type_id
            from "stg_activity_types__dbt_tmp223038281525" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_activity_types" ("activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_activity_types__dbt_tmp223038281525"
    )
  
[0m22:30:38.355186 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:30:38.363372 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:30:38.363639 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:30:38.363800 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:30:38.365142 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:30:38.366044 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m22:30:38.366368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107635cd0>]}
[0m22:30:38.366701 [info ] [Thread-1 (]: 2 of 30 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mINSERT 0 0[0m in 0.09s]
[0m22:30:38.366983 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m22:30:38.367184 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m22:30:38.367489 [info ] [Thread-1 (]: 3 of 30 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m22:30:38.367837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m22:30:38.368063 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m22:30:38.370269 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:30:38.370756 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m22:30:38.372449 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:30:38.372822 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:30:38.373115 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m22:30:38.373312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.389981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:30:38.390252 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:30:38.390466 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (changed_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , changed_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY changed_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if changed_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , changed_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m22:30:38.391219 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "changed_time" does not exist
LINE 27:         , changed_time
                   ^
HINT:  Perhaps you meant to reference the column "raw.change_time".

[0m22:30:38.391442 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: ROLLBACK
[0m22:30:38.392253 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m22:30:38.394711 [debug] [Thread-1 (]: Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  column "changed_time" does not exist
  LINE 27:         , changed_time
                     ^
  HINT:  Perhaps you meant to reference the column "raw.change_time".
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:30:38.395015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be0680>]}
[0m22:30:38.395362 [error] [Thread-1 (]: 3 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_deal_changes  [[31mERROR[0m in 0.03s]
[0m22:30:38.395654 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m22:30:38.395848 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m22:30:38.396078 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  column "changed_time" does not exist
  LINE 27:         , changed_time
                     ^
  HINT:  Perhaps you meant to reference the column "raw.change_time".
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql.
[0m22:30:38.396310 [info ] [Thread-1 (]: 4 of 30 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m22:30:38.396643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m22:30:38.396828 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m22:30:38.398981 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m22:30:38.399472 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m22:30:38.401140 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m22:30:38.401513 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:30:38.401772 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m22:30:38.401945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.423412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:30:38.423712 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:30:38.423935 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:30:38.424872 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "field_name" does not exist
LINE 26:         , field_name
                   ^

[0m22:30:38.425102 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: ROLLBACK
[0m22:30:38.425773 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m22:30:38.428287 [debug] [Thread-1 (]: Database Error in model stg_fields (models/staging/stg_fields.sql)
  column "field_name" does not exist
  LINE 26:         , field_name
                     ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_fields.sql
[0m22:30:38.428597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3ecb0>]}
[0m22:30:38.428958 [error] [Thread-1 (]: 4 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_fields  [[31mERROR[0m in 0.03s]
[0m22:30:38.429256 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m22:30:38.429448 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m22:30:38.429661 [info ] [Thread-1 (]: 5 of 30 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m22:30:38.429908 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_fields' to be skipped because of status 'error'.  Reason: Database Error in model stg_fields (models/staging/stg_fields.sql)
  column "field_name" does not exist
  LINE 26:         , field_name
                     ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_fields.sql.
[0m22:30:38.430124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m22:30:38.430389 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m22:30:38.432652 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m22:30:38.433199 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m22:30:38.434964 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:30:38.435159 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

    
  
    

  create temporary table "stg_stages__dbt_tmp223038434154"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE stage_id NOT IN (SELECT stage_id FROM "postgres"."public_pipedrive_analytics"."stg_stages")

  );
  
  
[0m22:30:38.435334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.453342 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m22:30:38.455262 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:30:38.455464 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m22:30:38.456085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m22:30:38.456251 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:30:38.456416 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223038434154'
        
      order by ordinal_position

  
[0m22:30:38.465937 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.009 seconds
[0m22:30:38.467789 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:30:38.468016 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:30:38.470518 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:30:38.472143 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:30:38.472356 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223038434154'
        
      order by ordinal_position

  
[0m22:30:38.474453 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:30:38.476349 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:30:38.476567 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:30:38.478500 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:30:38.479428 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_stages":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:30:38.479992 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m22:30:38.480520 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:30:38.480735 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_stages" as DBT_INTERNAL_DEST
        where (stage_id) in (
            select distinct stage_id
            from "stg_stages__dbt_tmp223038434154" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_stages" ("stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_stages__dbt_tmp223038434154"
    )
  
[0m22:30:38.481823 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:30:38.482785 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:30:38.483001 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:30:38.483177 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:30:38.484136 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:30:38.484527 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m22:30:38.484832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6ead0>]}
[0m22:30:38.485177 [info ] [Thread-1 (]: 5 of 30 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mINSERT 0 0[0m in 0.05s]
[0m22:30:38.485466 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m22:30:38.485671 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m22:30:38.485939 [info ] [Thread-1 (]: 6 of 30 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m22:30:38.486260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m22:30:38.486492 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m22:30:38.488818 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m22:30:38.489342 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m22:30:38.491582 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:30:38.491864 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

    
  
    

  create temporary table "stg_users__dbt_tmp223038490702"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


      -- Only insert rows that don’t already exist in the target table
    WHERE user_id NOT IN (SELECT user_id FROM "postgres"."public_pipedrive_analytics"."stg_users")

  );
  
  
[0m22:30:38.492072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.514895 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.023 seconds
[0m22:30:38.516809 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:30:38.517070 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m22:30:38.517894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:30:38.518102 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:30:38.518296 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223038490702'
        
      order by ordinal_position

  
[0m22:30:38.524428 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m22:30:38.526263 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:30:38.526493 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:30:38.529577 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m22:30:38.533493 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:30:38.533741 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223038490702'
        
      order by ordinal_position

  
[0m22:30:38.536112 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:30:38.537816 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:30:38.538041 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:30:38.540359 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:30:38.541428 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:30:38.542047 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m22:30:38.542566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:30:38.542773 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_users" as DBT_INTERNAL_DEST
        where (user_id) in (
            select distinct user_id
            from "stg_users__dbt_tmp223038490702" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_users" ("user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_users__dbt_tmp223038490702"
    )
  
[0m22:30:38.543845 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:30:38.544650 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:30:38.544838 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:30:38.545008 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:30:38.546366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:30:38.546747 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m22:30:38.547049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece32b0e-2d58-4d92-9c58-97c2bf38f0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c433f0>]}
[0m22:30:38.547383 [info ] [Thread-1 (]: 6 of 30 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mINSERT 0 0[0m in 0.06s]
[0m22:30:38.547682 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m22:30:38.547881 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:30:38.548146 [info ] [Thread-1 (]: 7 of 30 SKIP test not_null_stg_activity_activity_id ............................ [[33mSKIP[0m]
[0m22:30:38.548475 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:30:38.548711 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:30:38.548864 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5' to be skipped because of status 'skipped'. 
[0m22:30:38.549069 [info ] [Thread-1 (]: 8 of 30 SKIP test not_null_stg_activity_activity_type_short .................... [[33mSKIP[0m]
[0m22:30:38.549383 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:30:38.549608 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:30:38.549773 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844' to be skipped because of status 'skipped'. 
[0m22:30:38.549971 [info ] [Thread-1 (]: 9 of 30 SKIP test not_null_stg_activity_user_id ................................ [[33mSKIP[0m]
[0m22:30:38.550234 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:30:38.550425 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:30:38.550570 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272' to be skipped because of status 'skipped'. 
[0m22:30:38.550744 [info ] [Thread-1 (]: 10 of 30 SKIP test unique_stg_activity_activity_id ............................. [[33mSKIP[0m]
[0m22:30:38.550995 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:30:38.551169 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:30:38.551310 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9' to be skipped because of status 'skipped'. 
[0m22:30:38.551481 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m22:30:38.551777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m22:30:38.551972 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:30:38.557322 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:30:38.557969 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:30:38.567401 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:30:38.568064 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:30:38.568242 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m22:30:38.568392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.589843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:30:38.590128 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:30:38.590315 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:38.591865 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:30:38.593785 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m22:30:38.594802 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m22:30:38.595252 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.04s]
[0m22:30:38.595661 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:30:38.595906 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:30:38.596121 [info ] [Thread-1 (]: 12 of 30 SKIP test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[33mSKIP[0m]
[0m22:30:38.596362 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:30:38.596901 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:30:38.597140 [info ] [Thread-1 (]: 13 of 30 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m22:30:38.597561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m22:30:38.597769 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c' to be skipped because of status 'skipped'. 
[0m22:30:38.597972 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:30:38.601916 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:30:38.602405 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:30:38.603462 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:30:38.603819 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:30:38.603978 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m22:30:38.604117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.621016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:30:38.621292 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:30:38.621479 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:30:38.622800 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:30:38.623756 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m22:30:38.624406 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m22:30:38.624776 [info ] [Thread-1 (]: 13 of 30 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m22:30:38.625096 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:30:38.625289 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:30:38.625489 [info ] [Thread-1 (]: 14 of 30 SKIP test not_null_stg_deal_changes_deal_id ........................... [[33mSKIP[0m]
[0m22:30:38.625665 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:30:38.625859 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:30:38.626043 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e' to be skipped because of status 'skipped'. 
[0m22:30:38.626208 [info ] [Thread-1 (]: 15 of 30 SKIP test not_null_stg_deal_changes_deal_id_sk ........................ [[33mSKIP[0m]
[0m22:30:38.626451 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:30:38.626623 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:30:38.626749 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e' to be skipped because of status 'skipped'. 
[0m22:30:38.626912 [info ] [Thread-1 (]: 16 of 30 SKIP test not_null_stg_deal_changes_deal_updated_field_key ............ [[33mSKIP[0m]
[0m22:30:38.627121 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:30:38.627281 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:30:38.627405 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624' to be skipped because of status 'skipped'. 
[0m22:30:38.627563 [info ] [Thread-1 (]: 17 of 30 SKIP test relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_  [[33mSKIP[0m]
[0m22:30:38.627786 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:30:38.627942 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:30:38.628066 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb' to be skipped because of status 'skipped'. 
[0m22:30:38.628223 [info ] [Thread-1 (]: 18 of 30 SKIP test unique_stg_deal_changes_deal_id_sk .......................... [[33mSKIP[0m]
[0m22:30:38.628419 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:30:38.628565 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:30:38.628682 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600' to be skipped because of status 'skipped'. 
[0m22:30:38.628828 [info ] [Thread-1 (]: 19 of 30 SKIP test not_null_stg_fields_field_key ............................... [[33mSKIP[0m]
[0m22:30:38.629027 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:30:38.629181 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:30:38.629338 [info ] [Thread-1 (]: 20 of 30 SKIP test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[33mSKIP[0m]
[0m22:30:38.629507 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:30:38.629650 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:30:38.629798 [info ] [Thread-1 (]: 21 of 30 SKIP test unique_stg_fields_field_key ................................. [[33mSKIP[0m]
[0m22:30:38.629953 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:30:38.630112 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe' to be skipped because of status 'skipped'. 
[0m22:30:38.630316 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:30:38.630489 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa' to be skipped because of status 'skipped'. 
[0m22:30:38.630662 [info ] [Thread-1 (]: 22 of 30 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m22:30:38.630829 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4' to be skipped because of status 'skipped'. 
[0m22:30:38.631034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m22:30:38.631294 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:30:38.633293 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:30:38.633908 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:30:38.635451 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:30:38.635899 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:30:38.636057 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m22:30:38.636194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.653566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:30:38.653855 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:30:38.654051 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:38.655062 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:30:38.655942 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m22:30:38.657770 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m22:30:38.658109 [info ] [Thread-1 (]: 22 of 30 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:30:38.658392 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:30:38.658576 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:30:38.658745 [info ] [Thread-1 (]: 23 of 30 START test unique_stg_stages_stage_id ................................. [RUN]
[0m22:30:38.658942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m22:30:38.659105 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:30:38.661364 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:30:38.661907 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:30:38.663257 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:30:38.663628 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:30:38.663790 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m22:30:38.663935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.682421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:30:38.682710 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:30:38.682902 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:30:38.684441 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:30:38.685288 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m22:30:38.685831 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m22:30:38.686155 [info ] [Thread-1 (]: 23 of 30 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:30:38.686441 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:30:38.686629 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:30:38.686828 [info ] [Thread-1 (]: 24 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:30:38.687027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m22:30:38.687193 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:30:38.689307 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:30:38.689821 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:30:38.690885 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:30:38.691230 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:30:38.691386 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m22:30:38.691533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.708679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:30:38.708965 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:30:38.709162 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:38.710235 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:30:38.711116 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m22:30:38.712095 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m22:30:38.712478 [info ] [Thread-1 (]: 24 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:30:38.712786 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:30:38.712996 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:30:38.713223 [info ] [Thread-1 (]: 25 of 30 START test not_null_stg_users_user_name ............................... [RUN]
[0m22:30:38.713483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m22:30:38.713667 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:30:38.716330 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:30:38.716926 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:30:38.718102 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:30:38.718491 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:30:38.718669 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m22:30:38.718825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.737387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:30:38.737673 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:30:38.737863 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m22:30:38.739052 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:30:38.739997 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m22:30:38.740769 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m22:30:38.741187 [info ] [Thread-1 (]: 25 of 30 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m22:30:38.741542 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:30:38.741761 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:30:38.742023 [info ] [Thread-1 (]: 26 of 30 SKIP test relationships_stg_activity_user_id__user_id__ref_stg_users_ . [[33mSKIP[0m]
[0m22:30:38.742281 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:30:38.742585 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:30:38.742789 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02' to be skipped because of status 'skipped'. 
[0m22:30:38.743000 [info ] [Thread-1 (]: 27 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m22:30:38.743324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m22:30:38.743536 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:30:38.745815 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:30:38.746293 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:30:38.747799 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:30:38.748212 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:30:38.748382 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m22:30:38.748589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:38.769882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:30:38.770189 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:30:38.770392 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:30:38.772076 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:30:38.773009 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m22:30:38.773725 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m22:30:38.774142 [info ] [Thread-1 (]: 27 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m22:30:38.774485 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:30:38.774706 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m22:30:38.774955 [info ] [Thread-1 (]: 28 of 30 SKIP relation public_pipedrive_analytics.stg_lost_reasons ............. [[33mSKIP[0m]
[0m22:30:38.775198 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m22:30:38.775378 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_lost_reasons' to be skipped because of status 'skipped'. 
[0m22:30:38.775851 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:30:38.776067 [info ] [Thread-1 (]: 29 of 30 SKIP test not_null_stg_lost_reasons_lost_reason_id .................... [[33mSKIP[0m]
[0m22:30:38.776290 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:30:38.776514 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:30:38.776671 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768' to be skipped because of status 'skipped'. 
[0m22:30:38.776856 [info ] [Thread-1 (]: 30 of 30 SKIP test unique_stg_lost_reasons_lost_reason_id ...................... [[33mSKIP[0m]
[0m22:30:38.777116 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:30:38.777318 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' to be skipped because of status 'skipped'. 
[0m22:30:38.777963 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:38.778130 [debug] [MainThread]: On master: BEGIN
[0m22:30:38.778269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:30:38.797115 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m22:30:38.797392 [debug] [MainThread]: On master: COMMIT
[0m22:30:38.797556 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:38.797700 [debug] [MainThread]: On master: COMMIT
[0m22:30:38.798240 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:30:38.798437 [debug] [MainThread]: On master: Close
[0m22:30:38.798704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:38.799022 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m22:30:38.799407 [info ] [MainThread]: 
[0m22:30:38.799637 [info ] [MainThread]: Finished running 7 incremental models, 23 data tests in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m22:30:38.801068 [debug] [MainThread]: Command end result
[0m22:30:38.816535 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:30:38.817807 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:30:38.821660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:30:38.821855 [info ] [MainThread]: 
[0m22:30:38.822043 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m22:30:38.822193 [info ] [MainThread]: 
[0m22:30:38.822364 [error] [MainThread]: [31mFailure in model stg_activity (models/staging/stg_activity.sql)[0m
[0m22:30:38.822533 [error] [MainThread]:   Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:30:38.822656 [info ] [MainThread]: 
[0m22:30:38.822804 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:30:38.822924 [info ] [MainThread]: 
[0m22:30:38.823078 [error] [MainThread]: [31mFailure in model stg_deal_changes (models/staging/stg_deal_changes.sql)[0m
[0m22:30:38.823238 [error] [MainThread]:   Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  column "changed_time" does not exist
  LINE 27:         , changed_time
                     ^
  HINT:  Perhaps you meant to reference the column "raw.change_time".
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:30:38.823357 [info ] [MainThread]: 
[0m22:30:38.823501 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:30:38.823618 [info ] [MainThread]: 
[0m22:30:38.823764 [error] [MainThread]: [31mFailure in model stg_fields (models/staging/stg_fields.sql)[0m
[0m22:30:38.823916 [error] [MainThread]:   Database Error in model stg_fields (models/staging/stg_fields.sql)
  column "field_name" does not exist
  LINE 26:         , field_name
                     ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_fields.sql
[0m22:30:38.824027 [info ] [MainThread]: 
[0m22:30:38.824166 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_fields.sql
[0m22:30:38.824289 [info ] [MainThread]: 
[0m22:30:38.824425 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=3 SKIP=17 NO-OP=0 TOTAL=30
[0m22:30:38.826331 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.6111459, "process_in_blocks": "0", "process_kernel_time": 0.353334, "process_mem_max_rss": "135086080", "process_out_blocks": "0", "process_user_time": 1.719683}
[0m22:30:38.826572 [debug] [MainThread]: Command `dbt build` failed at 22:30:38.826527 after 1.61 seconds
[0m22:30:38.826760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107babad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bab7d0>]}
[0m22:30:38.826935 [debug] [MainThread]: Flushing usage events
[0m22:30:40.769484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:31:44.177097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be7b10>]}


============================== 22:31:44.180400 | 8b659295-1f43-4a7e-ba9a-1d48542992f9 ==============================
[0m22:31:44.180400 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:31:44.180723 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'invocation_command': 'dbt build -s tag:staging', 'warn_error': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'fail_fast': 'False', 'no_print': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False'}
[0m22:31:44.293264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee7e10>]}
[0m22:31:44.325706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a67bd0>]}
[0m22:31:44.326388 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:31:44.392839 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:31:44.475631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:31:44.476075 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_fields.sql
[0m22:31:44.718992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a30e50>]}
[0m22:31:44.766343 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:31:44.768003 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:31:44.790557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4b6b0>]}
[0m22:31:44.790851 [info ] [MainThread]: Found 7 models, 23 data tests, 6 sources, 434 macros
[0m22:31:44.792213 [info ] [MainThread]: 
[0m22:31:44.792394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:31:44.792529 [info ] [MainThread]: 
[0m22:31:44.792773 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:31:44.794773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:31:44.852808 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:31:44.853064 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:31:44.853203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:45.477447 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.624 seconds
[0m22:31:45.479580 [debug] [ThreadPool]: On list_postgres: Close
[0m22:31:45.481920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m22:31:45.489207 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:31:45.489677 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:31:45.489985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:45.521325 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m22:31:45.521797 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:31:45.522125 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:31:45.533526 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m22:31:45.535193 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:31:45.536561 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:31:45.542436 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:45.542812 [debug] [MainThread]: On master: BEGIN
[0m22:31:45.543066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:31:45.573937 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m22:31:45.574387 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:45.574754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:31:45.580769 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m22:31:45.582037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107170750>]}
[0m22:31:45.582464 [debug] [MainThread]: On master: ROLLBACK
[0m22:31:45.583832 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:45.584196 [debug] [MainThread]: On master: BEGIN
[0m22:31:45.585871 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:31:45.586154 [debug] [MainThread]: On master: COMMIT
[0m22:31:45.586393 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:45.586610 [debug] [MainThread]: On master: COMMIT
[0m22:31:45.587549 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:31:45.587844 [debug] [MainThread]: On master: Close
[0m22:31:45.590987 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m22:31:45.591502 [info ] [Thread-1 (]: 1 of 30 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m22:31:45.591914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m22:31:45.592185 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m22:31:45.598935 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m22:31:45.600102 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m22:31:45.635688 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m22:31:45.636342 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:31:45.636535 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m22:31:45.636705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:45.653060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:31:45.653354 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:31:45.653587 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM raw
    QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:31:45.654474 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ROW_NUMBER"
LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                     ^

[0m22:31:45.654699 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: ROLLBACK
[0m22:31:45.655364 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m22:31:45.662167 [debug] [Thread-1 (]: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:31:45.663359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108175bf0>]}
[0m22:31:45.663720 [error] [Thread-1 (]: 1 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_activity  [[31mERROR[0m in 0.07s]
[0m22:31:45.664011 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m22:31:45.664199 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m22:31:45.664431 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_activity' to be skipped because of status 'error'.  Reason: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql.
[0m22:31:45.664659 [info ] [Thread-1 (]: 2 of 30 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m22:31:45.665113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m22:31:45.665298 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m22:31:45.667564 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.667997 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m22:31:45.670811 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.671050 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

    
  
    

  create temporary table "stg_activity_types__dbt_tmp223145668948"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE activity_type_id NOT IN (SELECT activity_type_id FROM "postgres"."public_pipedrive_analytics"."stg_activity_types")

  );
  
  
[0m22:31:45.671233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:45.703992 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m22:31:45.712001 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.712334 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m22:31:45.713343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:31:45.713546 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.713730 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223145668948'
        
      order by ordinal_position

  
[0m22:31:45.718852 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m22:31:45.721958 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.722206 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:31:45.724769 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:31:45.732216 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.732443 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223145668948'
        
      order by ordinal_position

  
[0m22:31:45.734792 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:31:45.736865 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.737104 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:31:45.739388 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:31:45.744584 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:31:45.751988 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.752528 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.752722 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_activity_types" as DBT_INTERNAL_DEST
        where (activity_type_id) in (
            select distinct activity_type_id
            from "stg_activity_types__dbt_tmp223145668948" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_activity_types" ("activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_activity_types__dbt_tmp223145668948"
    )
  
[0m22:31:45.755741 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m22:31:45.763415 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:31:45.763633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:31:45.763794 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:31:45.767037 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:31:45.767990 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m22:31:45.768323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4dc10>]}
[0m22:31:45.768657 [info ] [Thread-1 (]: 2 of 30 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mINSERT 0 0[0m in 0.10s]
[0m22:31:45.768933 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m22:31:45.769126 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m22:31:45.769383 [info ] [Thread-1 (]: 3 of 30 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m22:31:45.769696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m22:31:45.769918 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m22:31:45.772220 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:31:45.772715 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m22:31:45.774554 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:31:45.775050 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:31:45.775313 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m22:31:45.775489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:45.795273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m22:31:45.795552 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:31:45.795769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (changed_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , changed_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY changed_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if changed_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , changed_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m22:31:45.796632 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "changed_time" does not exist
LINE 27:         , changed_time
                   ^
HINT:  Perhaps you meant to reference the column "raw.change_time".

[0m22:31:45.796858 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: ROLLBACK
[0m22:31:45.797426 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m22:31:45.800004 [debug] [Thread-1 (]: Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  column "changed_time" does not exist
  LINE 27:         , changed_time
                     ^
  HINT:  Perhaps you meant to reference the column "raw.change_time".
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:31:45.800300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d8680>]}
[0m22:31:45.800653 [error] [Thread-1 (]: 3 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_deal_changes  [[31mERROR[0m in 0.03s]
[0m22:31:45.800943 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m22:31:45.801131 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m22:31:45.801381 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  column "changed_time" does not exist
  LINE 27:         , changed_time
                     ^
  HINT:  Perhaps you meant to reference the column "raw.change_time".
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql.
[0m22:31:45.801646 [info ] [Thread-1 (]: 4 of 30 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m22:31:45.802017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m22:31:45.802211 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m22:31:45.804588 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m22:31:45.805062 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m22:31:45.806858 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m22:31:45.809625 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:31:45.809857 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m22:31:45.810024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:45.845556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m22:31:45.845884 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:31:45.846120 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:31:45.849923 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m22:31:45.853653 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:31:45.854119 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:31:45.854360 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:31:45.856346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:31:45.856960 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m22:31:45.857363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108231db0>]}
[0m22:31:45.857735 [info ] [Thread-1 (]: 4 of 30 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mSELECT 4[0m in 0.06s]
[0m22:31:45.858082 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m22:31:45.858371 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m22:31:45.858677 [info ] [Thread-1 (]: 5 of 30 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m22:31:45.858959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m22:31:45.859157 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m22:31:45.861946 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m22:31:45.862565 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m22:31:45.864696 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:31:45.865033 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

    
  
    

  create temporary table "stg_stages__dbt_tmp223145863621"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE stage_id NOT IN (SELECT stage_id FROM "postgres"."public_pipedrive_analytics"."stg_stages")

  );
  
  
[0m22:31:45.865241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:45.883273 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m22:31:45.885184 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:31:45.885393 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m22:31:45.886137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:31:45.886344 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:31:45.886526 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223145863621'
        
      order by ordinal_position

  
[0m22:31:45.890508 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m22:31:45.892273 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:31:45.892506 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:31:45.894626 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:31:45.896205 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:31:45.896420 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223145863621'
        
      order by ordinal_position

  
[0m22:31:45.898210 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:31:45.900008 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:31:45.900222 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:31:45.902320 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:31:45.903312 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_stages":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:31:45.903918 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m22:31:45.904440 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:31:45.904631 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_stages" as DBT_INTERNAL_DEST
        where (stage_id) in (
            select distinct stage_id
            from "stg_stages__dbt_tmp223145863621" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_stages" ("stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_stages__dbt_tmp223145863621"
    )
  
[0m22:31:45.905643 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:31:45.906352 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:31:45.906525 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:31:45.906681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:31:45.907641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:31:45.908003 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m22:31:45.908354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827e6d0>]}
[0m22:31:45.908740 [info ] [Thread-1 (]: 5 of 30 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mINSERT 0 0[0m in 0.05s]
[0m22:31:45.909080 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m22:31:45.909298 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m22:31:45.909606 [info ] [Thread-1 (]: 6 of 30 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m22:31:45.909945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m22:31:45.910150 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m22:31:45.912460 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m22:31:45.912995 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m22:31:45.915319 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:31:45.915544 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

    
  
    

  create temporary table "stg_users__dbt_tmp223145914369"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


      -- Only insert rows that don’t already exist in the target table
    WHERE user_id NOT IN (SELECT user_id FROM "postgres"."public_pipedrive_analytics"."stg_users")

  );
  
  
[0m22:31:45.915731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:45.939181 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.023 seconds
[0m22:31:45.940938 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:31:45.941150 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m22:31:45.941848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m22:31:45.942078 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:31:45.942277 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223145914369'
        
      order by ordinal_position

  
[0m22:31:45.946979 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m22:31:45.950866 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:31:45.951116 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:31:45.953806 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:31:45.955589 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:31:45.955814 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223145914369'
        
      order by ordinal_position

  
[0m22:31:45.957848 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:31:45.959530 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:31:45.959764 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:31:45.961913 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:31:45.962950 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:31:45.963543 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m22:31:45.964098 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:31:45.964301 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_users" as DBT_INTERNAL_DEST
        where (user_id) in (
            select distinct user_id
            from "stg_users__dbt_tmp223145914369" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_users" ("user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_users__dbt_tmp223145914369"
    )
  
[0m22:31:45.965210 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:31:45.965955 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:31:45.966143 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:31:45.966313 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:31:45.967288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:31:45.967690 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m22:31:45.968008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a8b40>]}
[0m22:31:45.968350 [info ] [Thread-1 (]: 6 of 30 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mINSERT 0 0[0m in 0.06s]
[0m22:31:45.968637 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m22:31:45.968833 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:31:45.969041 [info ] [Thread-1 (]: 7 of 30 SKIP test not_null_stg_activity_activity_id ............................ [[33mSKIP[0m]
[0m22:31:45.969405 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:31:45.969663 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:31:45.969843 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5' to be skipped because of status 'skipped'. 
[0m22:31:45.970052 [info ] [Thread-1 (]: 8 of 30 SKIP test not_null_stg_activity_activity_type_short .................... [[33mSKIP[0m]
[0m22:31:45.970342 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:31:45.970536 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:31:45.970687 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844' to be skipped because of status 'skipped'. 
[0m22:31:45.970864 [info ] [Thread-1 (]: 9 of 30 SKIP test not_null_stg_activity_user_id ................................ [[33mSKIP[0m]
[0m22:31:45.971113 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:31:45.971296 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:31:45.971460 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272' to be skipped because of status 'skipped'. 
[0m22:31:45.971671 [info ] [Thread-1 (]: 10 of 30 SKIP test unique_stg_activity_activity_id ............................. [[33mSKIP[0m]
[0m22:31:45.971931 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:31:45.972117 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:31:45.972263 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9' to be skipped because of status 'skipped'. 
[0m22:31:45.972442 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m22:31:45.972731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m22:31:45.972915 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:31:45.979750 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:31:45.980288 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:31:45.989640 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:31:45.990282 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:31:45.990457 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m22:31:45.990612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.013246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m22:31:46.013546 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:31:46.013753 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m22:31:46.014879 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:31:46.016811 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m22:31:46.017560 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m22:31:46.017935 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.05s]
[0m22:31:46.018235 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:31:46.018442 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:31:46.018702 [info ] [Thread-1 (]: 12 of 30 SKIP test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[33mSKIP[0m]
[0m22:31:46.018975 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:31:46.019252 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:31:46.019438 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c' to be skipped because of status 'skipped'. 
[0m22:31:46.019622 [info ] [Thread-1 (]: 13 of 30 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m22:31:46.019885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m22:31:46.020068 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:31:46.023841 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:31:46.024337 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:31:46.025480 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:31:46.025940 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:31:46.026127 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m22:31:46.026341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.048252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m22:31:46.048562 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:31:46.048779 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:31:46.050172 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:31:46.051289 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m22:31:46.052501 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m22:31:46.052932 [info ] [Thread-1 (]: 13 of 30 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m22:31:46.053252 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:31:46.053460 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:31:46.053721 [info ] [Thread-1 (]: 14 of 30 SKIP test not_null_stg_deal_changes_deal_id ........................... [[33mSKIP[0m]
[0m22:31:46.053995 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:31:46.054277 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:31:46.054474 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e' to be skipped because of status 'skipped'. 
[0m22:31:46.054708 [info ] [Thread-1 (]: 15 of 30 SKIP test not_null_stg_deal_changes_deal_id_sk ........................ [[33mSKIP[0m]
[0m22:31:46.054999 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:31:46.055206 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:31:46.055366 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e' to be skipped because of status 'skipped'. 
[0m22:31:46.055560 [info ] [Thread-1 (]: 16 of 30 SKIP test not_null_stg_deal_changes_deal_updated_field_key ............ [[33mSKIP[0m]
[0m22:31:46.055807 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:31:46.055985 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:31:46.056128 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624' to be skipped because of status 'skipped'. 
[0m22:31:46.056322 [info ] [Thread-1 (]: 17 of 30 SKIP test relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_  [[33mSKIP[0m]
[0m22:31:46.056570 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:31:46.056773 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:31:46.056957 [info ] [Thread-1 (]: 18 of 30 SKIP test unique_stg_deal_changes_deal_id_sk .......................... [[33mSKIP[0m]
[0m22:31:46.057119 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb' to be skipped because of status 'skipped'. 
[0m22:31:46.057282 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:31:46.057489 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:31:46.057656 [info ] [Thread-1 (]: 19 of 30 START test not_null_stg_fields_field_key .............................. [RUN]
[0m22:31:46.057813 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600' to be skipped because of status 'skipped'. 
[0m22:31:46.058037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m22:31:46.058246 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:31:46.061130 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:31:46.061752 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:31:46.062899 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:31:46.063307 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:31:46.063475 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m22:31:46.063627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.087741 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:31:46.088048 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:31:46.088254 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m22:31:46.089641 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:31:46.090654 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m22:31:46.091432 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m22:31:46.091857 [info ] [Thread-1 (]: 19 of 30 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m22:31:46.092184 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:31:46.092400 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:31:46.092653 [info ] [Thread-1 (]: 20 of 30 SKIP test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[33mSKIP[0m]
[0m22:31:46.092943 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:31:46.093218 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:31:46.093392 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa' to be skipped because of status 'skipped'. 
[0m22:31:46.093597 [info ] [Thread-1 (]: 21 of 30 START test unique_stg_fields_field_key ................................ [RUN]
[0m22:31:46.093947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m22:31:46.094140 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:31:46.096680 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:31:46.097382 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:31:46.098982 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:31:46.099456 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:31:46.099634 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m22:31:46.099794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.117518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:31:46.117816 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:31:46.118020 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:31:46.119111 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:31:46.119976 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m22:31:46.120590 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m22:31:46.120981 [info ] [Thread-1 (]: 21 of 30 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m22:31:46.121286 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:31:46.121484 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:31:46.121692 [info ] [Thread-1 (]: 22 of 30 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m22:31:46.122000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m22:31:46.122231 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:31:46.124579 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:31:46.125081 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:31:46.126193 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:31:46.126590 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:31:46.126764 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m22:31:46.126920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.147124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m22:31:46.147436 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:31:46.147645 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m22:31:46.148715 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:31:46.149814 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m22:31:46.150663 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m22:31:46.151096 [info ] [Thread-1 (]: 22 of 30 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:31:46.151427 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:31:46.151646 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:31:46.151900 [info ] [Thread-1 (]: 23 of 30 START test unique_stg_stages_stage_id ................................. [RUN]
[0m22:31:46.152189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m22:31:46.152398 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:31:46.155050 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:31:46.155514 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:31:46.156588 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:31:46.156960 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:31:46.157129 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m22:31:46.157302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.174008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:31:46.174293 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:31:46.174490 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:31:46.175521 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:31:46.176431 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m22:31:46.177082 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m22:31:46.177418 [info ] [Thread-1 (]: 23 of 30 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:31:46.177702 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:31:46.177895 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:31:46.178093 [info ] [Thread-1 (]: 24 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:31:46.178300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m22:31:46.178468 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:31:46.180894 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:31:46.181419 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:31:46.182479 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:31:46.183061 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:31:46.183381 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m22:31:46.183565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.202431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:31:46.202735 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:31:46.202936 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:31:46.204016 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:31:46.204862 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m22:31:46.205473 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m22:31:46.205804 [info ] [Thread-1 (]: 24 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:31:46.206086 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:31:46.206274 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:31:46.206445 [info ] [Thread-1 (]: 25 of 30 START test not_null_stg_users_user_name ............................... [RUN]
[0m22:31:46.206648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m22:31:46.206859 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:31:46.209006 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:31:46.209560 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:31:46.211011 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:31:46.211367 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:31:46.211529 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m22:31:46.211679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.229606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:31:46.229887 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:31:46.230080 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m22:31:46.231228 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:31:46.232081 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m22:31:46.232775 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m22:31:46.233175 [info ] [Thread-1 (]: 25 of 30 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m22:31:46.233616 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:31:46.233859 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:31:46.234111 [info ] [Thread-1 (]: 26 of 30 SKIP test relationships_stg_activity_user_id__user_id__ref_stg_users_ . [[33mSKIP[0m]
[0m22:31:46.234354 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:31:46.234550 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:31:46.234725 [info ] [Thread-1 (]: 27 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m22:31:46.234961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m22:31:46.235133 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:31:46.237227 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:31:46.237401 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02' to be skipped because of status 'skipped'. 
[0m22:31:46.237874 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:31:46.238934 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:31:46.239293 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:31:46.239456 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m22:31:46.239604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.257691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:31:46.257988 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:31:46.258186 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:31:46.259946 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:31:46.260902 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m22:31:46.261628 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m22:31:46.261988 [info ] [Thread-1 (]: 27 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m22:31:46.262361 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:31:46.262619 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m22:31:46.262910 [info ] [Thread-1 (]: 28 of 30 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m22:31:46.263175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m22:31:46.263374 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m22:31:46.266015 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:31:46.266708 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m22:31:46.268787 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:31:46.269375 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:31:46.269557 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m22:31:46.269712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.288703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:31:46.288995 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:31:46.289211 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(value->>'id' AS INT) AS lost_reason_id -- Unique identifier for the lost reason
        , value->>'name' AS lost_reason_name -- Name of the lost reason
    FROM raw
        , jsonb_array_elements(raw.field_value_options) AS value  -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


  );
  
  
[0m22:31:46.293225 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m22:31:46.294182 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:31:46.294395 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:31:46.294575 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:31:46.295395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:31:46.295787 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m22:31:46.296134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b659295-1f43-4a7e-ba9a-1d48542992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081abb30>]}
[0m22:31:46.296544 [info ] [Thread-1 (]: 28 of 30 OK created sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[32mSELECT 5[0m in 0.03s]
[0m22:31:46.296869 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m22:31:46.297382 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:31:46.297618 [info ] [Thread-1 (]: 29 of 30 START test not_null_stg_lost_reasons_lost_reason_id ................... [RUN]
[0m22:31:46.297871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_lost_reasons, now test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768)
[0m22:31:46.298058 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:31:46.300723 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:31:46.301279 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:31:46.302458 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:31:46.302905 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:31:46.303076 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: BEGIN
[0m22:31:46.303228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.321017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:31:46.321307 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:31:46.321516 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lost_reason_id
from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is null



  
  
      
    ) dbt_internal_test
[0m22:31:46.322453 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:31:46.323339 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: ROLLBACK
[0m22:31:46.323916 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: Close
[0m22:31:46.324275 [info ] [Thread-1 (]: 29 of 30 PASS not_null_stg_lost_reasons_lost_reason_id ......................... [[32mPASS[0m in 0.03s]
[0m22:31:46.324569 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:31:46.324769 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:31:46.324953 [info ] [Thread-1 (]: 30 of 30 START test unique_stg_lost_reasons_lost_reason_id ..................... [RUN]
[0m22:31:46.325262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768, now test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d)
[0m22:31:46.325494 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:31:46.328103 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:31:46.328685 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:31:46.329744 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:31:46.330129 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:31:46.330302 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: BEGIN
[0m22:31:46.330458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:46.348859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:31:46.349204 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:31:46.349454 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    lost_reason_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is not null
group by lost_reason_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:31:46.351307 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:31:46.352276 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: ROLLBACK
[0m22:31:46.353106 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: Close
[0m22:31:46.353491 [info ] [Thread-1 (]: 30 of 30 PASS unique_stg_lost_reasons_lost_reason_id ........................... [[32mPASS[0m in 0.03s]
[0m22:31:46.353808 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:31:46.354611 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:46.355007 [debug] [MainThread]: On master: BEGIN
[0m22:31:46.355152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:31:46.379807 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m22:31:46.380086 [debug] [MainThread]: On master: COMMIT
[0m22:31:46.380254 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:46.380402 [debug] [MainThread]: On master: COMMIT
[0m22:31:46.380998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:31:46.381154 [debug] [MainThread]: On master: Close
[0m22:31:46.381394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:46.381534 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' was properly closed.
[0m22:31:46.381737 [info ] [MainThread]: 
[0m22:31:46.381903 [info ] [MainThread]: Finished running 7 incremental models, 23 data tests in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m22:31:46.383644 [debug] [MainThread]: Command end result
[0m22:31:46.401008 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:31:46.402245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:31:46.405756 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:31:46.405930 [info ] [MainThread]: 
[0m22:31:46.406107 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:31:46.406243 [info ] [MainThread]: 
[0m22:31:46.406420 [error] [MainThread]: [31mFailure in model stg_activity (models/staging/stg_activity.sql)[0m
[0m22:31:46.406591 [error] [MainThread]:   Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:31:46.406714 [info ] [MainThread]: 
[0m22:31:46.406861 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:31:46.406976 [info ] [MainThread]: 
[0m22:31:46.407130 [error] [MainThread]: [31mFailure in model stg_deal_changes (models/staging/stg_deal_changes.sql)[0m
[0m22:31:46.407285 [error] [MainThread]:   Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  column "changed_time" does not exist
  LINE 27:         , changed_time
                     ^
  HINT:  Perhaps you meant to reference the column "raw.change_time".
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:31:46.407400 [info ] [MainThread]: 
[0m22:31:46.407539 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:31:46.407658 [info ] [MainThread]: 
[0m22:31:46.407788 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=2 SKIP=12 NO-OP=0 TOTAL=30
[0m22:31:46.409585 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.2744896, "process_in_blocks": "0", "process_kernel_time": 0.318939, "process_mem_max_rss": "133890048", "process_out_blocks": "0", "process_user_time": 1.709755}
[0m22:31:46.409877 [debug] [MainThread]: Command `dbt build` failed at 22:31:46.409829 after 2.27 seconds
[0m22:31:46.410074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104605d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b50d0>]}
[0m22:31:46.410256 [debug] [MainThread]: Flushing usage events
[0m22:31:48.359081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:32:11.963268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088679d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108867b10>]}


============================== 22:32:11.967024 | 51657d1d-5ece-4cfe-81a7-e1121830acb5 ==============================
[0m22:32:11.967024 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:32:11.967395 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt build -s tag:staging', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'quiet': 'False'}
[0m22:32:12.067276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b63e10>]}
[0m22:32:12.095673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e7bd0>]}
[0m22:32:12.096593 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:32:12.146306 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:32:12.222378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:32:12.222823 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:32:12.464666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109705450>]}
[0m22:32:12.507176 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:32:12.508542 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:32:12.529097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109733d40>]}
[0m22:32:12.529364 [info ] [MainThread]: Found 7 models, 23 data tests, 6 sources, 434 macros
[0m22:32:12.530671 [info ] [MainThread]: 
[0m22:32:12.530843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:32:12.530972 [info ] [MainThread]: 
[0m22:32:12.531192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:32:12.533143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:32:12.580498 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:32:12.580917 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:32:12.581085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:12.641550 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.060 seconds
[0m22:32:12.642676 [debug] [ThreadPool]: On list_postgres: Close
[0m22:32:12.644019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m22:32:12.647827 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:32:12.648084 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:32:12.648242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:12.675311 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m22:32:12.675595 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:32:12.675779 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:32:12.681860 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m22:32:12.683174 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:32:12.684237 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:32:12.688526 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:12.689068 [debug] [MainThread]: On master: BEGIN
[0m22:32:12.689390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:12.709308 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m22:32:12.709568 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:12.709780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:32:12.713858 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m22:32:12.714718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e457f0>]}
[0m22:32:12.715024 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:12.715778 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:12.715939 [debug] [MainThread]: On master: BEGIN
[0m22:32:12.717024 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:32:12.717227 [debug] [MainThread]: On master: COMMIT
[0m22:32:12.717381 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:12.717513 [debug] [MainThread]: On master: COMMIT
[0m22:32:12.718154 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:32:12.718295 [debug] [MainThread]: On master: Close
[0m22:32:12.720464 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m22:32:12.720786 [info ] [Thread-1 (]: 1 of 30 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m22:32:12.721042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m22:32:12.721221 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m22:32:12.725780 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m22:32:12.726377 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m22:32:12.755046 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m22:32:12.755638 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:32:12.755808 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m22:32:12.755954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:12.772222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:32:12.772474 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:32:12.772677 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM raw
    QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:32:12.773547 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ROW_NUMBER"
LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                     ^

[0m22:32:12.773783 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: ROLLBACK
[0m22:32:12.774385 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m22:32:12.780550 [debug] [Thread-1 (]: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:32:12.781730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e125b0>]}
[0m22:32:12.782071 [error] [Thread-1 (]: 1 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_activity  [[31mERROR[0m in 0.06s]
[0m22:32:12.782355 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m22:32:12.782541 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m22:32:12.782769 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_activity' to be skipped because of status 'error'.  Reason: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql.
[0m22:32:12.783020 [info ] [Thread-1 (]: 2 of 30 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m22:32:12.783501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m22:32:12.783705 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m22:32:12.785903 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.786347 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m22:32:12.789160 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.789432 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

    
  
    

  create temporary table "stg_activity_types__dbt_tmp223212787291"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE activity_type_id NOT IN (SELECT activity_type_id FROM "postgres"."public_pipedrive_analytics"."stg_activity_types")

  );
  
  
[0m22:32:12.789634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:12.807883 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m22:32:12.815309 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.815560 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m22:32:12.816409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:32:12.816589 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.816760 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223212787291'
        
      order by ordinal_position

  
[0m22:32:12.822404 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m22:32:12.825424 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.825659 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:12.828167 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:32:12.835368 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.835603 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223212787291'
        
      order by ordinal_position

  
[0m22:32:12.837693 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:32:12.839559 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.839770 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:12.841829 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:32:12.846814 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:12.854117 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.854672 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.854864 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_activity_types" as DBT_INTERNAL_DEST
        where (activity_type_id) in (
            select distinct activity_type_id
            from "stg_activity_types__dbt_tmp223212787291" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_activity_types" ("activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_activity_types__dbt_tmp223212787291"
    )
  
[0m22:32:12.856086 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:12.863685 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:32:12.863941 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:12.864109 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:32:12.865977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:32:12.867083 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m22:32:12.867454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a11c10>]}
[0m22:32:12.867798 [info ] [Thread-1 (]: 2 of 30 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mINSERT 0 0[0m in 0.08s]
[0m22:32:12.868068 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m22:32:12.868250 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m22:32:12.868566 [info ] [Thread-1 (]: 3 of 30 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m22:32:12.868867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m22:32:12.869054 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m22:32:12.871459 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:32:12.871993 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m22:32:12.873848 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:32:12.874462 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:32:12.874646 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m22:32:12.874802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:12.891663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:32:12.891963 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:32:12.892186 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (changed_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY changed_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if changed_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m22:32:12.893117 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "changed_time" does not exist
LINE 32:             ORDER BY changed_time, changed_field_key, new_va...
                              ^
HINT:  Perhaps you meant to reference the column "raw.change_time".

[0m22:32:12.893361 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: ROLLBACK
[0m22:32:12.893933 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m22:32:12.896391 [debug] [Thread-1 (]: Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  column "changed_time" does not exist
  LINE 32:             ORDER BY changed_time, changed_field_key, new_va...
                                ^
  HINT:  Perhaps you meant to reference the column "raw.change_time".
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:32:12.896699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea47e0>]}
[0m22:32:12.897059 [error] [Thread-1 (]: 3 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_deal_changes  [[31mERROR[0m in 0.03s]
[0m22:32:12.897368 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m22:32:12.897568 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m22:32:12.897806 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  column "changed_time" does not exist
  LINE 32:             ORDER BY changed_time, changed_field_key, new_va...
                                ^
  HINT:  Perhaps you meant to reference the column "raw.change_time".
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql.
[0m22:32:12.898058 [info ] [Thread-1 (]: 4 of 30 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m22:32:12.898409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m22:32:12.898597 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m22:32:12.900829 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m22:32:12.901292 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m22:32:12.903064 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:12.903289 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

    
  
    

  create temporary table "stg_fields__dbt_tmp223212902257"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE field_key NOT IN (SELECT field_key FROM "postgres"."public_pipedrive_analytics"."stg_fields")

  );
  
  
[0m22:32:12.903517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:12.922129 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m22:32:12.924071 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:12.924286 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m22:32:12.925015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:32:12.925238 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:12.925430 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields__dbt_tmp223212902257'
        
      order by ordinal_position

  
[0m22:32:12.930466 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m22:32:12.932317 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:12.932561 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:12.935562 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m22:32:12.937385 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:12.937602 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields__dbt_tmp223212902257'
        
      order by ordinal_position

  
[0m22:32:12.940532 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m22:32:12.943008 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:12.943289 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:12.946465 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m22:32:12.947682 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_fields":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:12.948323 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m22:32:12.948989 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:12.949207 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_fields" as DBT_INTERNAL_DEST
        where (field_key) in (
            select distinct field_key
            from "stg_fields__dbt_tmp223212902257" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_fields" ("field_key", "field_name", "field_value_options", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "field_key", "field_name", "field_value_options", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_fields__dbt_tmp223212902257"
    )
  
[0m22:32:12.950486 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:12.951308 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:32:12.951515 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:12.951695 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:32:12.952795 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:12.953262 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m22:32:12.953600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f1e3f0>]}
[0m22:32:12.953954 [info ] [Thread-1 (]: 4 of 30 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mINSERT 0 0[0m in 0.06s]
[0m22:32:12.954252 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m22:32:12.954464 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m22:32:12.954797 [info ] [Thread-1 (]: 5 of 30 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m22:32:12.955152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m22:32:12.955404 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m22:32:12.957699 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m22:32:12.958226 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m22:32:12.960562 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:12.960795 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

    
  
    

  create temporary table "stg_stages__dbt_tmp223212959631"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE stage_id NOT IN (SELECT stage_id FROM "postgres"."public_pipedrive_analytics"."stg_stages")

  );
  
  
[0m22:32:12.960991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:12.979512 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m22:32:12.981371 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:12.981591 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m22:32:12.982340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:32:12.982546 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:12.982783 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223212959631'
        
      order by ordinal_position

  
[0m22:32:12.987085 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m22:32:12.988920 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:12.989150 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:12.991249 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:12.993201 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:12.993406 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223212959631'
        
      order by ordinal_position

  
[0m22:32:12.995351 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:12.996877 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:12.997077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:12.999025 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:12.999964 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_stages":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:13.000528 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m22:32:13.001071 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:13.001270 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_stages" as DBT_INTERNAL_DEST
        where (stage_id) in (
            select distinct stage_id
            from "stg_stages__dbt_tmp223212959631" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_stages" ("stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_stages__dbt_tmp223212959631"
    )
  
[0m22:32:13.002103 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:13.002865 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:32:13.003053 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:13.003225 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:32:13.004034 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:13.004506 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m22:32:13.004841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4c150>]}
[0m22:32:13.005196 [info ] [Thread-1 (]: 5 of 30 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mINSERT 0 0[0m in 0.05s]
[0m22:32:13.005507 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m22:32:13.005714 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m22:32:13.005987 [info ] [Thread-1 (]: 6 of 30 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m22:32:13.006254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m22:32:13.006441 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m22:32:13.010702 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m22:32:13.011248 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m22:32:13.013435 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:13.013717 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

    
  
    

  create temporary table "stg_users__dbt_tmp223213012543"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


      -- Only insert rows that don’t already exist in the target table
    WHERE user_id NOT IN (SELECT user_id FROM "postgres"."public_pipedrive_analytics"."stg_users")

  );
  
  
[0m22:32:13.013940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.034717 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.021 seconds
[0m22:32:13.036783 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:13.036997 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m22:32:13.037640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m22:32:13.037857 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:13.038055 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223213012543'
        
      order by ordinal_position

  
[0m22:32:13.043137 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m22:32:13.044837 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:13.045056 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:13.047306 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:32:13.049011 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:13.049241 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223213012543'
        
      order by ordinal_position

  
[0m22:32:13.051265 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:32:13.053256 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:13.053490 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:13.055649 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:32:13.056641 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:13.057266 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m22:32:13.057838 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:13.058052 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_users" as DBT_INTERNAL_DEST
        where (user_id) in (
            select distinct user_id
            from "stg_users__dbt_tmp223213012543" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_users" ("user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_users__dbt_tmp223213012543"
    )
  
[0m22:32:13.058975 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:13.059710 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:32:13.059901 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:13.060068 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:32:13.061161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:13.061550 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m22:32:13.061864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f23310>]}
[0m22:32:13.062202 [info ] [Thread-1 (]: 6 of 30 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mINSERT 0 0[0m in 0.06s]
[0m22:32:13.062498 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m22:32:13.062706 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:32:13.062968 [info ] [Thread-1 (]: 7 of 30 SKIP test not_null_stg_activity_activity_id ............................ [[33mSKIP[0m]
[0m22:32:13.063267 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:32:13.063475 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:32:13.063637 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5' to be skipped because of status 'skipped'. 
[0m22:32:13.063823 [info ] [Thread-1 (]: 8 of 30 SKIP test not_null_stg_activity_activity_type_short .................... [[33mSKIP[0m]
[0m22:32:13.064106 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:32:13.064371 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:32:13.064543 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844' to be skipped because of status 'skipped'. 
[0m22:32:13.064732 [info ] [Thread-1 (]: 9 of 30 SKIP test not_null_stg_activity_user_id ................................ [[33mSKIP[0m]
[0m22:32:13.065036 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:32:13.065263 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:32:13.065419 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272' to be skipped because of status 'skipped'. 
[0m22:32:13.065602 [info ] [Thread-1 (]: 10 of 30 SKIP test unique_stg_activity_activity_id ............................. [[33mSKIP[0m]
[0m22:32:13.065847 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:32:13.066042 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:32:13.066190 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9' to be skipped because of status 'skipped'. 
[0m22:32:13.066369 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m22:32:13.066650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m22:32:13.066827 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:32:13.071936 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:32:13.072620 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:32:13.082278 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:32:13.082815 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:32:13.083003 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m22:32:13.083163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.098988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:32:13.099270 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:32:13.099468 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m22:32:13.100447 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.102261 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m22:32:13.103102 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m22:32:13.103449 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.04s]
[0m22:32:13.103737 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:32:13.103938 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:32:13.104162 [info ] [Thread-1 (]: 12 of 30 SKIP test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[33mSKIP[0m]
[0m22:32:13.104418 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:32:13.104638 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:32:13.104955 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c' to be skipped because of status 'skipped'. 
[0m22:32:13.104826 [info ] [Thread-1 (]: 13 of 30 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m22:32:13.105280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m22:32:13.105495 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:32:13.108850 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:32:13.109419 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:32:13.110897 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:32:13.111633 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:32:13.111806 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m22:32:13.111949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.127202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m22:32:13.127496 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:32:13.127692 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:13.128789 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.129663 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m22:32:13.130292 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m22:32:13.130678 [info ] [Thread-1 (]: 13 of 30 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m22:32:13.130981 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:32:13.131180 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:32:13.131365 [info ] [Thread-1 (]: 14 of 30 SKIP test not_null_stg_deal_changes_deal_id ........................... [[33mSKIP[0m]
[0m22:32:13.131593 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:32:13.131795 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:32:13.131951 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e' to be skipped because of status 'skipped'. 
[0m22:32:13.132144 [info ] [Thread-1 (]: 15 of 30 SKIP test not_null_stg_deal_changes_deal_id_sk ........................ [[33mSKIP[0m]
[0m22:32:13.132473 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:32:13.132660 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:32:13.132833 [info ] [Thread-1 (]: 16 of 30 SKIP test not_null_stg_deal_changes_deal_updated_field_key ............ [[33mSKIP[0m]
[0m22:32:13.133018 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:32:13.133181 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:32:13.133350 [info ] [Thread-1 (]: 17 of 30 SKIP test relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_  [[33mSKIP[0m]
[0m22:32:13.133531 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:32:13.133685 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:32:13.133845 [info ] [Thread-1 (]: 18 of 30 SKIP test unique_stg_deal_changes_deal_id_sk .......................... [[33mSKIP[0m]
[0m22:32:13.134016 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:32:13.134172 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:32:13.134329 [info ] [Thread-1 (]: 19 of 30 START test not_null_stg_fields_field_key .............................. [RUN]
[0m22:32:13.134543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m22:32:13.134710 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:32:13.136820 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:32:13.137017 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e' to be skipped because of status 'skipped'. 
[0m22:32:13.137199 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624' to be skipped because of status 'skipped'. 
[0m22:32:13.137348 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb' to be skipped because of status 'skipped'. 
[0m22:32:13.137482 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600' to be skipped because of status 'skipped'. 
[0m22:32:13.137920 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:32:13.138962 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:32:13.139314 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:32:13.139472 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m22:32:13.139613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.154542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m22:32:13.154816 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:32:13.155001 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m22:32:13.155932 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.156737 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m22:32:13.157295 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m22:32:13.157606 [info ] [Thread-1 (]: 19 of 30 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.02s]
[0m22:32:13.157869 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:32:13.158055 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:32:13.158230 [info ] [Thread-1 (]: 20 of 30 SKIP test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[33mSKIP[0m]
[0m22:32:13.158410 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:32:13.158573 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:32:13.158772 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa' to be skipped because of status 'skipped'. 
[0m22:32:13.158991 [info ] [Thread-1 (]: 21 of 30 START test unique_stg_fields_field_key ................................ [RUN]
[0m22:32:13.159312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m22:32:13.159499 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:32:13.161878 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:32:13.162298 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:32:13.163280 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:32:13.163615 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:32:13.163768 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m22:32:13.163905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.180222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:32:13.180616 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:32:13.180901 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:13.182400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.183406 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m22:32:13.184334 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m22:32:13.184712 [info ] [Thread-1 (]: 21 of 30 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m22:32:13.185070 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:32:13.185387 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:32:13.185581 [info ] [Thread-1 (]: 22 of 30 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m22:32:13.185802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m22:32:13.185976 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:32:13.188496 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:32:13.189002 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:32:13.190068 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:32:13.190447 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:32:13.190615 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m22:32:13.190769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.209305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:32:13.209605 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:32:13.209794 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m22:32:13.210904 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.211749 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m22:32:13.212397 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m22:32:13.212760 [info ] [Thread-1 (]: 22 of 30 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:32:13.213060 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:32:13.213256 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:32:13.213477 [info ] [Thread-1 (]: 23 of 30 START test unique_stg_stages_stage_id ................................. [RUN]
[0m22:32:13.213715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m22:32:13.213900 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:32:13.216203 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:32:13.216782 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:32:13.218424 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:32:13.218909 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:32:13.219093 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m22:32:13.219245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.238985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m22:32:13.239291 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:32:13.239492 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:13.240971 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.242073 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m22:32:13.244778 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m22:32:13.245251 [info ] [Thread-1 (]: 23 of 30 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:32:13.245725 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:32:13.245994 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:32:13.246256 [info ] [Thread-1 (]: 24 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:32:13.246512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m22:32:13.246699 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:32:13.249132 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:32:13.250221 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:32:13.252027 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:32:13.252614 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:32:13.252803 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m22:32:13.252956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.270126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:32:13.270411 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:32:13.270601 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:32:13.271588 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.272433 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m22:32:13.273151 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m22:32:13.273479 [info ] [Thread-1 (]: 24 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:32:13.273759 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:32:13.273946 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:32:13.274117 [info ] [Thread-1 (]: 25 of 30 START test not_null_stg_users_user_name ............................... [RUN]
[0m22:32:13.274349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m22:32:13.274578 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:32:13.277177 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:32:13.277712 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:32:13.278811 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:32:13.279204 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:32:13.279372 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m22:32:13.279525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.295875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:32:13.296153 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:32:13.296348 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m22:32:13.297410 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.298308 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m22:32:13.298986 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m22:32:13.299436 [info ] [Thread-1 (]: 25 of 30 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m22:32:13.299822 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:32:13.300046 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:32:13.300299 [info ] [Thread-1 (]: 26 of 30 SKIP test relationships_stg_activity_user_id__user_id__ref_stg_users_ . [[33mSKIP[0m]
[0m22:32:13.300539 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:32:13.300731 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:32:13.300907 [info ] [Thread-1 (]: 27 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m22:32:13.301139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m22:32:13.301313 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:32:13.303402 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:32:13.303583 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02' to be skipped because of status 'skipped'. 
[0m22:32:13.304074 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:32:13.305541 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:32:13.305933 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:32:13.306095 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m22:32:13.306236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.323010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:32:13.323249 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:32:13.323415 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:13.324976 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.325875 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m22:32:13.326581 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m22:32:13.326958 [info ] [Thread-1 (]: 27 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m22:32:13.327266 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:32:13.327478 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m22:32:13.327730 [info ] [Thread-1 (]: 28 of 30 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m22:32:13.327951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m22:32:13.328128 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m22:32:13.330183 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.330711 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m22:32:13.332836 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.333199 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

    
  
    

  create temporary table "stg_lost_reasons__dbt_tmp223213331981"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(value->>'id' AS INT) AS lost_reason_id -- Unique identifier for the lost reason
        , value->>'name' AS lost_reason_name -- Name of the lost reason
    FROM raw
        , jsonb_array_elements(raw.field_value_options) AS value  -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


    WHERE lost_reason_id NOT IN (SELECT lost_reason_id FROM "postgres"."public_pipedrive_analytics"."stg_lost_reasons")

  );
  
  
[0m22:32:13.333519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.353389 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m22:32:13.355161 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.355367 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m22:32:13.356304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:32:13.356492 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.356665 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons__dbt_tmp223213331981'
        
      order by ordinal_position

  
[0m22:32:13.361935 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m22:32:13.363664 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.363880 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:13.367388 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m22:32:13.369398 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.369589 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons__dbt_tmp223213331981'
        
      order by ordinal_position

  
[0m22:32:13.371757 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:13.373413 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.373639 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:13.375603 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:13.376544 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_lost_reasons":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:13.377116 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.377672 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.377881 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_lost_reasons" as DBT_INTERNAL_DEST
        where (lost_reason_id) in (
            select distinct lost_reason_id
            from "stg_lost_reasons__dbt_tmp223213331981" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_lost_reasons" ("lost_reason_id", "lost_reason_name", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "lost_reason_id", "lost_reason_name", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_lost_reasons__dbt_tmp223213331981"
    )
  
[0m22:32:13.379086 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:13.379969 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:32:13.380170 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:13.380345 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:32:13.381475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:13.382019 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m22:32:13.382888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51657d1d-5ece-4cfe-81a7-e1121830acb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d13950>]}
[0m22:32:13.383412 [info ] [Thread-1 (]: 28 of 30 OK created sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[32mINSERT 0 0[0m in 0.05s]
[0m22:32:13.383783 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m22:32:13.384241 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:32:13.384472 [info ] [Thread-1 (]: 29 of 30 START test not_null_stg_lost_reasons_lost_reason_id ................... [RUN]
[0m22:32:13.384928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_lost_reasons, now test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768)
[0m22:32:13.385214 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:32:13.389600 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:32:13.390387 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:32:13.392156 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:32:13.392876 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:32:13.393067 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: BEGIN
[0m22:32:13.393228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.411827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:32:13.412113 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:32:13.412322 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lost_reason_id
from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is null



  
  
      
    ) dbt_internal_test
[0m22:32:13.413265 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.414187 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: ROLLBACK
[0m22:32:13.414861 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: Close
[0m22:32:13.415210 [info ] [Thread-1 (]: 29 of 30 PASS not_null_stg_lost_reasons_lost_reason_id ......................... [[32mPASS[0m in 0.03s]
[0m22:32:13.415509 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:32:13.415711 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:32:13.415919 [info ] [Thread-1 (]: 30 of 30 START test unique_stg_lost_reasons_lost_reason_id ..................... [RUN]
[0m22:32:13.416215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768, now test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d)
[0m22:32:13.416414 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:32:13.418631 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:32:13.419179 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:32:13.420645 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:32:13.421033 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:32:13.421203 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: BEGIN
[0m22:32:13.421408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.440257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:32:13.440501 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:32:13.440680 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    lost_reason_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is not null
group by lost_reason_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:13.441828 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:13.442695 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: ROLLBACK
[0m22:32:13.443314 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: Close
[0m22:32:13.443696 [info ] [Thread-1 (]: 30 of 30 PASS unique_stg_lost_reasons_lost_reason_id ........................... [[32mPASS[0m in 0.03s]
[0m22:32:13.444000 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:32:13.444651 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:13.444808 [debug] [MainThread]: On master: BEGIN
[0m22:32:13.444936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:32:13.461710 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m22:32:13.461998 [debug] [MainThread]: On master: COMMIT
[0m22:32:13.462163 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:13.462309 [debug] [MainThread]: On master: COMMIT
[0m22:32:13.463058 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:32:13.463279 [debug] [MainThread]: On master: Close
[0m22:32:13.463561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:13.463702 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' was properly closed.
[0m22:32:13.463911 [info ] [MainThread]: 
[0m22:32:13.464079 [info ] [MainThread]: Finished running 7 incremental models, 23 data tests in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m22:32:13.465645 [debug] [MainThread]: Command end result
[0m22:32:13.482761 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:32:13.484378 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:32:13.488292 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:32:13.488478 [info ] [MainThread]: 
[0m22:32:13.488653 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:32:13.488792 [info ] [MainThread]: 
[0m22:32:13.488973 [error] [MainThread]: [31mFailure in model stg_activity (models/staging/stg_activity.sql)[0m
[0m22:32:13.489139 [error] [MainThread]:   Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:32:13.489258 [info ] [MainThread]: 
[0m22:32:13.489404 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:32:13.489524 [info ] [MainThread]: 
[0m22:32:13.489668 [error] [MainThread]: [31mFailure in model stg_deal_changes (models/staging/stg_deal_changes.sql)[0m
[0m22:32:13.489823 [error] [MainThread]:   Database Error in model stg_deal_changes (models/staging/stg_deal_changes.sql)
  column "changed_time" does not exist
  LINE 32:             ORDER BY changed_time, changed_field_key, new_va...
                                ^
  HINT:  Perhaps you meant to reference the column "raw.change_time".
  compiled code at target/run/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:32:13.489944 [info ] [MainThread]: 
[0m22:32:13.490084 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_deal_changes.sql
[0m22:32:13.490206 [info ] [MainThread]: 
[0m22:32:13.490343 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=2 SKIP=12 NO-OP=0 TOTAL=30
[0m22:32:13.492170 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5748277, "process_in_blocks": "0", "process_kernel_time": 0.283898, "process_mem_max_rss": "133267456", "process_out_blocks": "0", "process_user_time": 1.614284}
[0m22:32:13.492436 [debug] [MainThread]: Command `dbt build` failed at 22:32:13.492391 after 1.58 seconds
[0m22:32:13.492634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fabd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fab7d0>]}
[0m22:32:13.492806 [debug] [MainThread]: Flushing usage events
[0m22:32:15.275869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:32:40.353139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e64050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cafb10>]}


============================== 22:32:40.358652 | 413542f5-fa0d-4f51-839a-1a1f45f7ff18 ==============================
[0m22:32:40.358652 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:32:40.359188 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'False', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt build -s tag:staging', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m22:32:40.477241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fafe10>]}
[0m22:32:40.506384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2fbd0>]}
[0m22:32:40.507254 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:32:40.560572 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:32:40.639780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:32:40.640237 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m22:32:40.889732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af9450>]}
[0m22:32:40.934907 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:32:40.936425 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:32:40.959231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2bd40>]}
[0m22:32:40.959533 [info ] [MainThread]: Found 7 models, 23 data tests, 6 sources, 434 macros
[0m22:32:40.961025 [info ] [MainThread]: 
[0m22:32:40.961224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:32:40.961359 [info ] [MainThread]: 
[0m22:32:40.961622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:32:40.964115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:32:41.026531 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:32:41.026770 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:32:41.026907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:41.085028 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.058 seconds
[0m22:32:41.086000 [debug] [ThreadPool]: On list_postgres: Close
[0m22:32:41.087110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m22:32:41.090369 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:32:41.090573 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:32:41.090715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:41.108947 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m22:32:41.109220 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:32:41.109391 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:32:41.112742 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m22:32:41.113641 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:32:41.114292 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:32:41.117612 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:41.117861 [debug] [MainThread]: On master: BEGIN
[0m22:32:41.118002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:41.138367 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m22:32:41.138637 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:41.138861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:32:41.142667 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m22:32:41.143413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052397f0>]}
[0m22:32:41.143678 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:41.144306 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:41.144449 [debug] [MainThread]: On master: BEGIN
[0m22:32:41.145433 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:32:41.145582 [debug] [MainThread]: On master: COMMIT
[0m22:32:41.145716 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:41.145840 [debug] [MainThread]: On master: COMMIT
[0m22:32:41.146396 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:32:41.146539 [debug] [MainThread]: On master: Close
[0m22:32:41.148773 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m22:32:41.149152 [info ] [Thread-1 (]: 1 of 30 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m22:32:41.149486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m22:32:41.149693 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m22:32:41.154732 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m22:32:41.155305 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m22:32:41.184299 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m22:32:41.184928 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:32:41.185092 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m22:32:41.185233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.201017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:32:41.201330 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:32:41.201543 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM raw
    QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:32:41.202381 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ROW_NUMBER"
LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                     ^

[0m22:32:41.202585 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: ROLLBACK
[0m22:32:41.203267 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m22:32:41.209293 [debug] [Thread-1 (]: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:32:41.210521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062065b0>]}
[0m22:32:41.210855 [error] [Thread-1 (]: 1 of 30 ERROR creating sql incremental model public_pipedrive_analytics.stg_activity  [[31mERROR[0m in 0.06s]
[0m22:32:41.211140 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m22:32:41.211325 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m22:32:41.211574 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_activity' to be skipped because of status 'error'.  Reason: Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql.
[0m22:32:41.211812 [info ] [Thread-1 (]: 2 of 30 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m22:32:41.212290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m22:32:41.212475 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m22:32:41.214697 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.215115 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m22:32:41.218396 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.218646 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

    
  
    

  create temporary table "stg_activity_types__dbt_tmp223241216064"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE activity_type_id NOT IN (SELECT activity_type_id FROM "postgres"."public_pipedrive_analytics"."stg_activity_types")

  );
  
  
[0m22:32:41.218826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.237830 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m22:32:41.244940 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.245172 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m22:32:41.245955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:32:41.246155 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.246335 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223241216064'
        
      order by ordinal_position

  
[0m22:32:41.255858 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m22:32:41.258930 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.259174 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:41.262094 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m22:32:41.269793 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.270076 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223241216064'
        
      order by ordinal_position

  
[0m22:32:41.272431 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:32:41.274496 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.274728 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:41.276851 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m22:32:41.282202 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:41.290601 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.291193 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.291390 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_activity_types" as DBT_INTERNAL_DEST
        where (activity_type_id) in (
            select distinct activity_type_id
            from "stg_activity_types__dbt_tmp223241216064" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_activity_types" ("activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_activity_types__dbt_tmp223241216064"
    )
  
[0m22:32:41.292842 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:41.300464 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:32:41.300736 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:32:41.300903 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:32:41.303873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:32:41.304850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m22:32:41.305174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e09cd0>]}
[0m22:32:41.305505 [info ] [Thread-1 (]: 2 of 30 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mINSERT 0 0[0m in 0.09s]
[0m22:32:41.305784 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m22:32:41.305971 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m22:32:41.306237 [info ] [Thread-1 (]: 3 of 30 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m22:32:41.306522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m22:32:41.306714 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m22:32:41.309119 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:32:41.309618 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m22:32:41.311397 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:32:41.311843 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:32:41.312043 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m22:32:41.312203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.328535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:32:41.328832 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:32:41.329052 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m22:32:41.384316 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.055 seconds
[0m22:32:41.387986 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m22:32:41.388240 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:32:41.388441 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m22:32:41.393601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:32:41.394151 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m22:32:41.394530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d628e0>]}
[0m22:32:41.394943 [info ] [Thread-1 (]: 3 of 30 OK created sql incremental model public_pipedrive_analytics.stg_deal_changes  [[32mSELECT 15406[0m in 0.09s]
[0m22:32:41.395295 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m22:32:41.395534 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m22:32:41.395858 [info ] [Thread-1 (]: 4 of 30 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m22:32:41.396254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m22:32:41.396466 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m22:32:41.399239 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m22:32:41.399904 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m22:32:41.402193 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:41.402477 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

    
  
    

  create temporary table "stg_fields__dbt_tmp223241401194"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE field_key NOT IN (SELECT field_key FROM "postgres"."public_pipedrive_analytics"."stg_fields")

  );
  
  
[0m22:32:41.402725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.427457 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.025 seconds
[0m22:32:41.429505 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:41.429721 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m22:32:41.430386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m22:32:41.430563 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:41.430741 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields__dbt_tmp223241401194'
        
      order by ordinal_position

  
[0m22:32:41.435149 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m22:32:41.437027 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:41.437256 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:41.439465 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:32:41.441101 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:41.441317 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields__dbt_tmp223241401194'
        
      order by ordinal_position

  
[0m22:32:41.443609 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:32:41.445804 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:41.446058 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:41.448368 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:32:41.449732 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_fields":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:41.450511 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m22:32:41.451095 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:41.451308 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_fields" as DBT_INTERNAL_DEST
        where (field_key) in (
            select distinct field_key
            from "stg_fields__dbt_tmp223241401194" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_fields" ("field_key", "field_name", "field_value_options", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "field_key", "field_name", "field_value_options", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_fields__dbt_tmp223241401194"
    )
  
[0m22:32:41.452870 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:41.453774 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:32:41.453991 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:32:41.454168 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:32:41.455094 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:41.455461 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m22:32:41.455758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631cd70>]}
[0m22:32:41.456082 [info ] [Thread-1 (]: 4 of 30 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mINSERT 0 0[0m in 0.06s]
[0m22:32:41.456361 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m22:32:41.456554 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m22:32:41.456829 [info ] [Thread-1 (]: 5 of 30 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m22:32:41.457090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m22:32:41.457259 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m22:32:41.459366 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m22:32:41.459868 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m22:32:41.462064 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:41.462342 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

    
  
    

  create temporary table "stg_stages__dbt_tmp223241461223"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE stage_id NOT IN (SELECT stage_id FROM "postgres"."public_pipedrive_analytics"."stg_stages")

  );
  
  
[0m22:32:41.462550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.619149 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.156 seconds
[0m22:32:41.620996 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:41.621258 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m22:32:41.622464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:32:41.622739 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:41.622920 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223241461223'
        
      order by ordinal_position

  
[0m22:32:41.630407 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m22:32:41.632535 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:41.632772 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:41.635543 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m22:32:41.637056 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:41.637242 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223241461223'
        
      order by ordinal_position

  
[0m22:32:41.639012 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:41.640399 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:41.640588 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:41.642335 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:41.643260 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_stages":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:41.645724 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m22:32:41.646247 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:41.646430 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_stages" as DBT_INTERNAL_DEST
        where (stage_id) in (
            select distinct stage_id
            from "stg_stages__dbt_tmp223241461223" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_stages" ("stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_stages__dbt_tmp223241461223"
    )
  
[0m22:32:41.647336 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:41.648010 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:32:41.648174 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:32:41.648319 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:32:41.649314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:41.649642 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m22:32:41.649917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063445d0>]}
[0m22:32:41.650230 [info ] [Thread-1 (]: 5 of 30 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mINSERT 0 0[0m in 0.19s]
[0m22:32:41.650489 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m22:32:41.650683 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m22:32:41.650943 [info ] [Thread-1 (]: 6 of 30 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m22:32:41.651225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m22:32:41.651448 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m22:32:41.653485 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m22:32:41.653966 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m22:32:41.655984 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:41.656197 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

    
  
    

  create temporary table "stg_users__dbt_tmp223241654905"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


      -- Only insert rows that don’t already exist in the target table
    WHERE user_id NOT IN (SELECT user_id FROM "postgres"."public_pipedrive_analytics"."stg_users")

  );
  
  
[0m22:32:41.656440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.680728 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.024 seconds
[0m22:32:41.682633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:41.682872 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m22:32:41.683616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:32:41.683838 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:41.684031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223241654905'
        
      order by ordinal_position

  
[0m22:32:41.689970 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m22:32:41.691767 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:41.691990 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:41.694488 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:32:41.696433 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:41.696649 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223241654905'
        
      order by ordinal_position

  
[0m22:32:41.698773 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:32:41.700505 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:41.700736 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:41.702859 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:32:41.703869 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:41.704499 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m22:32:41.705083 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:41.705285 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_users" as DBT_INTERNAL_DEST
        where (user_id) in (
            select distinct user_id
            from "stg_users__dbt_tmp223241654905" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_users" ("user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_users__dbt_tmp223241654905"
    )
  
[0m22:32:41.706248 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:41.707086 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:32:41.707287 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:32:41.707469 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:32:41.708692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:41.709146 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m22:32:41.709507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f0830>]}
[0m22:32:41.709895 [info ] [Thread-1 (]: 6 of 30 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mINSERT 0 0[0m in 0.06s]
[0m22:32:41.710220 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m22:32:41.710449 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:32:41.710732 [info ] [Thread-1 (]: 7 of 30 SKIP test not_null_stg_activity_activity_id ............................ [[33mSKIP[0m]
[0m22:32:41.711107 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:32:41.711378 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:32:41.711814 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5' to be skipped because of status 'skipped'. 
[0m22:32:41.711616 [info ] [Thread-1 (]: 8 of 30 SKIP test not_null_stg_activity_activity_type_short .................... [[33mSKIP[0m]
[0m22:32:41.712149 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:32:41.712384 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:32:41.712554 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844' to be skipped because of status 'skipped'. 
[0m22:32:41.712754 [info ] [Thread-1 (]: 9 of 30 SKIP test not_null_stg_activity_user_id ................................ [[33mSKIP[0m]
[0m22:32:41.713014 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:32:41.713201 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:32:41.713359 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272' to be skipped because of status 'skipped'. 
[0m22:32:41.713622 [info ] [Thread-1 (]: 10 of 30 SKIP test unique_stg_activity_activity_id ............................. [[33mSKIP[0m]
[0m22:32:41.713994 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:32:41.714172 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:32:41.714335 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9' to be skipped because of status 'skipped'. 
[0m22:32:41.714523 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m22:32:41.714816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m22:32:41.715008 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:32:41.721133 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:32:41.721736 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:32:41.731035 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:32:41.731529 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:32:41.731709 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m22:32:41.731871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.751333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:32:41.751621 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:32:41.751811 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m22:32:41.752996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:41.754906 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m22:32:41.755562 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m22:32:41.755939 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.04s]
[0m22:32:41.756252 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:32:41.756458 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:32:41.756650 [info ] [Thread-1 (]: 12 of 30 SKIP test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[33mSKIP[0m]
[0m22:32:41.756850 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:32:41.757015 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:32:41.757183 [info ] [Thread-1 (]: 13 of 30 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m22:32:41.757506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m22:32:41.757765 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:32:41.757956 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c' to be skipped because of status 'skipped'. 
[0m22:32:41.761607 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:32:41.762273 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:32:41.763798 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:32:41.764210 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:32:41.764378 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m22:32:41.764522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.780262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:32:41.780550 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:32:41.780738 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:41.782610 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:32:41.783658 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m22:32:41.784679 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m22:32:41.785115 [info ] [Thread-1 (]: 13 of 30 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m22:32:41.785439 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:32:41.785714 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:32:41.785943 [info ] [Thread-1 (]: 14 of 30 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m22:32:41.786226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m22:32:41.786462 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:32:41.788797 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:32:41.789402 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:32:41.790919 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:32:41.791460 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:32:41.791639 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m22:32:41.791793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.811189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:32:41.811469 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:32:41.811664 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m22:32:41.813781 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:32:41.814655 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m22:32:41.815369 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m22:32:41.815741 [info ] [Thread-1 (]: 14 of 30 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m22:32:41.816214 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:32:41.816465 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:32:41.816701 [info ] [Thread-1 (]: 15 of 30 START test not_null_stg_deal_changes_deal_id_sk ....................... [RUN]
[0m22:32:41.817013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e)
[0m22:32:41.817191 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:32:41.819379 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:32:41.819915 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:32:41.821017 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:32:41.821427 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:32:41.821593 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: BEGIN
[0m22:32:41.821744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.843500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m22:32:41.843788 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:32:41.843976 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m22:32:41.845623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:41.846534 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: ROLLBACK
[0m22:32:41.847530 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: Close
[0m22:32:41.847876 [info ] [Thread-1 (]: 15 of 30 PASS not_null_stg_deal_changes_deal_id_sk ............................. [[32mPASS[0m in 0.03s]
[0m22:32:41.848168 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:32:41.848377 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:32:41.848559 [info ] [Thread-1 (]: 16 of 30 START test not_null_stg_deal_changes_deal_updated_field_key ........... [RUN]
[0m22:32:41.848852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624)
[0m22:32:41.849031 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:32:41.851910 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:32:41.852531 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:32:41.853668 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:32:41.854115 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:32:41.854292 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: BEGIN
[0m22:32:41.854455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.871786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:32:41.872072 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:32:41.872255 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_updated_field_key
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_updated_field_key is null



  
  
      
    ) dbt_internal_test
[0m22:32:41.874096 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:32:41.875010 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: ROLLBACK
[0m22:32:41.875746 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: Close
[0m22:32:41.876108 [info ] [Thread-1 (]: 16 of 30 PASS not_null_stg_deal_changes_deal_updated_field_key ................. [[32mPASS[0m in 0.03s]
[0m22:32:41.876409 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:32:41.876608 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:32:41.876798 [info ] [Thread-1 (]: 17 of 30 SKIP test relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_  [[33mSKIP[0m]
[0m22:32:41.877035 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:32:41.877209 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:32:41.877633 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb' to be skipped because of status 'skipped'. 
[0m22:32:41.877451 [info ] [Thread-1 (]: 18 of 30 START test unique_stg_deal_changes_deal_id_sk ......................... [RUN]
[0m22:32:41.878024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624, now test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600)
[0m22:32:41.878240 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:32:41.880352 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:32:41.880829 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:32:41.882323 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:32:41.882763 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:32:41.882926 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: BEGIN
[0m22:32:41.883071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.901405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:32:41.901756 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:32:41.901976 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:41.907528 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:32:41.908543 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: ROLLBACK
[0m22:32:41.909385 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: Close
[0m22:32:41.909761 [info ] [Thread-1 (]: 18 of 30 PASS unique_stg_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.03s]
[0m22:32:41.910199 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:32:41.910445 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:32:41.910690 [info ] [Thread-1 (]: 19 of 30 START test not_null_stg_fields_field_key .............................. [RUN]
[0m22:32:41.910944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m22:32:41.911175 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:32:41.913350 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:32:41.913886 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:32:41.915251 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:32:41.915662 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:32:41.915829 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m22:32:41.916021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.935457 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:32:41.935751 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:32:41.935948 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m22:32:41.936918 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:41.937795 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m22:32:41.938415 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m22:32:41.938755 [info ] [Thread-1 (]: 19 of 30 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m22:32:41.939044 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:32:41.939247 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:32:41.939429 [info ] [Thread-1 (]: 20 of 30 START test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [RUN]
[0m22:32:41.939684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa)
[0m22:32:41.939901 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:32:41.942945 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:32:41.943516 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:32:41.944633 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:32:41.945028 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:32:41.945201 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: BEGIN
[0m22:32:41.945359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.963328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:32:41.963631 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:32:41.963838 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_updated_field_key as from_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where deal_updated_field_key is not null
),

parent as (
    select field_key as to_field
    from "postgres"."public_pipedrive_analytics"."stg_fields"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:32:41.967131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:32:41.968091 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: ROLLBACK
[0m22:32:41.968800 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: Close
[0m22:32:41.969159 [info ] [Thread-1 (]: 20 of 30 PASS relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[32mPASS[0m in 0.03s]
[0m22:32:41.969466 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:32:41.969675 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:32:41.969892 [info ] [Thread-1 (]: 21 of 30 START test unique_stg_fields_field_key ................................ [RUN]
[0m22:32:41.970116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m22:32:41.970298 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:32:41.972966 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:32:41.973545 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:32:41.974694 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:32:41.975111 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:32:41.975331 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m22:32:41.975528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:41.992766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:32:41.993042 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:32:41.993211 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:41.994281 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:41.995083 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m22:32:41.995567 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m22:32:41.995878 [info ] [Thread-1 (]: 21 of 30 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m22:32:41.996147 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:32:41.996324 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:32:41.996521 [info ] [Thread-1 (]: 22 of 30 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m22:32:41.996803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m22:32:41.997009 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:32:41.999004 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:32:41.999567 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:32:42.001043 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:32:42.001504 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:32:42.001667 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m22:32:42.001813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.017160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m22:32:42.017519 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:32:42.017794 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m22:32:42.019148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:42.020049 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m22:32:42.020764 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m22:32:42.021116 [info ] [Thread-1 (]: 22 of 30 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.02s]
[0m22:32:42.021410 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:32:42.021607 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:32:42.021813 [info ] [Thread-1 (]: 23 of 30 START test unique_stg_stages_stage_id ................................. [RUN]
[0m22:32:42.022019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m22:32:42.022188 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:32:42.024336 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:32:42.024828 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:32:42.025930 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:32:42.026295 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:32:42.026475 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m22:32:42.026933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.046186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:32:42.046497 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:32:42.046706 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:42.048673 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:32:42.049721 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m22:32:42.050802 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m22:32:42.051268 [info ] [Thread-1 (]: 23 of 30 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:32:42.051622 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:32:42.051838 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:32:42.052017 [info ] [Thread-1 (]: 24 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:32:42.052278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m22:32:42.052461 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:32:42.054773 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:32:42.055288 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:32:42.056401 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:32:42.057069 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:32:42.057333 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m22:32:42.057511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.077200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m22:32:42.077540 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:32:42.077792 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:32:42.079088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:42.079985 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m22:32:42.080726 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m22:32:42.081140 [info ] [Thread-1 (]: 24 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:32:42.081473 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:32:42.081690 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:32:42.081928 [info ] [Thread-1 (]: 25 of 30 START test not_null_stg_users_user_name ............................... [RUN]
[0m22:32:42.082169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m22:32:42.082353 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:32:42.086763 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:32:42.087480 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:32:42.088642 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:32:42.089089 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:32:42.089283 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m22:32:42.089447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.113456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:32:42.113742 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:32:42.113928 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m22:32:42.115094 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:42.116045 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m22:32:42.116929 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m22:32:42.117328 [info ] [Thread-1 (]: 25 of 30 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.04s]
[0m22:32:42.117721 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:32:42.117948 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:32:42.118205 [info ] [Thread-1 (]: 26 of 30 SKIP test relationships_stg_activity_user_id__user_id__ref_stg_users_ . [[33mSKIP[0m]
[0m22:32:42.118472 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:32:42.118684 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:32:42.118863 [info ] [Thread-1 (]: 27 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m22:32:42.119092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m22:32:42.119261 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:32:42.121402 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:32:42.121594 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02' to be skipped because of status 'skipped'. 
[0m22:32:42.122104 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:32:42.123589 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:32:42.124016 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:32:42.124173 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m22:32:42.124312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.143890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:32:42.144182 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:32:42.144369 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:42.146097 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:32:42.147216 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m22:32:42.148307 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m22:32:42.148912 [info ] [Thread-1 (]: 27 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m22:32:42.149346 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:32:42.149592 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m22:32:42.149975 [info ] [Thread-1 (]: 28 of 30 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m22:32:42.150544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m22:32:42.150886 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m22:32:42.153533 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.154248 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m22:32:42.157453 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.157784 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

    
  
    

  create temporary table "stg_lost_reasons__dbt_tmp223242156049"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(value->>'id' AS INT) AS lost_reason_id -- Unique identifier for the lost reason
        , value->>'name' AS lost_reason_name -- Name of the lost reason
    FROM raw
        , jsonb_array_elements(raw.field_value_options) AS value  -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


    WHERE lost_reason_id NOT IN (SELECT lost_reason_id FROM "postgres"."public_pipedrive_analytics"."stg_lost_reasons")

  );
  
  
[0m22:32:42.158073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.179980 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.022 seconds
[0m22:32:42.181769 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.181997 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m22:32:42.182991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:32:42.183208 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.183387 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons__dbt_tmp223242156049'
        
      order by ordinal_position

  
[0m22:32:42.188802 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m22:32:42.190622 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.190837 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:42.193150 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:42.195186 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.195412 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons__dbt_tmp223242156049'
        
      order by ordinal_position

  
[0m22:32:42.197346 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:42.198999 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.199241 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:32:42.201356 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:32:42.202283 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_lost_reasons":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:42.202858 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.203401 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.203604 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_lost_reasons" as DBT_INTERNAL_DEST
        where (lost_reason_id) in (
            select distinct lost_reason_id
            from "stg_lost_reasons__dbt_tmp223242156049" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_lost_reasons" ("lost_reason_id", "lost_reason_name", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "lost_reason_id", "lost_reason_name", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_lost_reasons__dbt_tmp223242156049"
    )
  
[0m22:32:42.205232 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:32:42.205997 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:32:42.206181 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:32:42.206351 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:32:42.207425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:42.207879 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m22:32:42.208251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '413542f5-fa0d-4f51-839a-1a1f45f7ff18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052af830>]}
[0m22:32:42.208662 [info ] [Thread-1 (]: 28 of 30 OK created sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[32mINSERT 0 0[0m in 0.06s]
[0m22:32:42.209000 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m22:32:42.209403 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:32:42.209656 [info ] [Thread-1 (]: 29 of 30 START test not_null_stg_lost_reasons_lost_reason_id ................... [RUN]
[0m22:32:42.209914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_lost_reasons, now test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768)
[0m22:32:42.210100 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:32:42.212719 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:32:42.213297 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:32:42.214429 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:32:42.214809 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:32:42.215118 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: BEGIN
[0m22:32:42.215314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.236661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:32:42.236952 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:32:42.237154 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lost_reason_id
from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is null



  
  
      
    ) dbt_internal_test
[0m22:32:42.238274 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:32:42.239209 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: ROLLBACK
[0m22:32:42.240007 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: Close
[0m22:32:42.240379 [info ] [Thread-1 (]: 29 of 30 PASS not_null_stg_lost_reasons_lost_reason_id ......................... [[32mPASS[0m in 0.03s]
[0m22:32:42.240767 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:32:42.241019 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:32:42.241250 [info ] [Thread-1 (]: 30 of 30 START test unique_stg_lost_reasons_lost_reason_id ..................... [RUN]
[0m22:32:42.241529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768, now test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d)
[0m22:32:42.241812 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:32:42.244081 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:32:42.244590 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:32:42.246149 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:32:42.246579 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:32:42.246750 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: BEGIN
[0m22:32:42.246901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.264968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:32:42.265260 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:32:42.265464 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    lost_reason_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is not null
group by lost_reason_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:32:42.267311 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:32:42.268372 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: ROLLBACK
[0m22:32:42.269296 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: Close
[0m22:32:42.269798 [info ] [Thread-1 (]: 30 of 30 PASS unique_stg_lost_reasons_lost_reason_id ........................... [[32mPASS[0m in 0.03s]
[0m22:32:42.270131 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:32:42.271213 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:42.271402 [debug] [MainThread]: On master: BEGIN
[0m22:32:42.271543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:32:42.313073 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m22:32:42.313411 [debug] [MainThread]: On master: COMMIT
[0m22:32:42.313636 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:42.313849 [debug] [MainThread]: On master: COMMIT
[0m22:32:42.314506 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:32:42.314681 [debug] [MainThread]: On master: Close
[0m22:32:42.314957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:42.315106 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' was properly closed.
[0m22:32:42.315326 [info ] [MainThread]: 
[0m22:32:42.315560 [info ] [MainThread]: Finished running 7 incremental models, 23 data tests in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m22:32:42.317622 [debug] [MainThread]: Command end result
[0m22:32:42.335169 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:32:42.336362 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:32:42.340186 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:32:42.340363 [info ] [MainThread]: 
[0m22:32:42.340534 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:32:42.340673 [info ] [MainThread]: 
[0m22:32:42.340848 [error] [MainThread]: [31mFailure in model stg_activity (models/staging/stg_activity.sql)[0m
[0m22:32:42.341012 [error] [MainThread]:   Database Error in model stg_activity (models/staging/stg_activity.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 32:     QUALIFY ROW_NUMBER() OVER (PARTITION BY activity_id ORDE...
                       ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:32:42.341132 [info ] [MainThread]: 
[0m22:32:42.341277 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_activity.sql
[0m22:32:42.341399 [info ] [MainThread]: 
[0m22:32:42.341532 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=1 SKIP=7 NO-OP=0 TOTAL=30
[0m22:32:42.343293 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.0372498, "process_in_blocks": "0", "process_kernel_time": 0.315171, "process_mem_max_rss": "133873664", "process_out_blocks": "0", "process_user_time": 1.756234}
[0m22:32:42.343519 [debug] [MainThread]: Command `dbt build` failed at 22:32:42.343478 after 2.04 seconds
[0m22:32:42.343704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b68410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f116d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639b7d0>]}
[0m22:32:42.343876 [debug] [MainThread]: Flushing usage events
[0m22:32:44.001073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:33:51.664976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113788050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d33b10>]}


============================== 22:33:51.668388 | 311ab882-cffd-4645-913b-20995d2fac43 ==============================
[0m22:33:51.668388 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:33:51.668717 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt build -s tag:staging', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'printer_width': '80', 'use_experimental_parser': 'False'}
[0m22:33:51.779886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c33e10>]}
[0m22:33:51.809588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ab3bd0>]}
[0m22:33:51.810312 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:33:51.860586 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:33:51.942174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:33:51.942637 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_activity.sql
[0m22:33:52.186856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116428c50>]}
[0m22:33:52.229946 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:33:52.231292 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:33:52.258053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116453a70>]}
[0m22:33:52.258350 [info ] [MainThread]: Found 7 models, 23 data tests, 6 sources, 434 macros
[0m22:33:52.259723 [info ] [MainThread]: 
[0m22:33:52.259903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:33:52.260035 [info ] [MainThread]: 
[0m22:33:52.260262 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:33:52.262264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:33:52.307965 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:33:52.308210 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:33:52.308358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:52.414225 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.106 seconds
[0m22:33:52.415129 [debug] [ThreadPool]: On list_postgres: Close
[0m22:33:52.416306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m22:33:52.419770 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:33:52.420010 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:33:52.420210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:33:52.442125 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m22:33:52.442796 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:33:52.443067 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:33:52.450898 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:33:52.451742 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:33:52.452378 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:33:52.455345 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:52.455525 [debug] [MainThread]: On master: BEGIN
[0m22:33:52.455649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:33:52.471859 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m22:33:52.472108 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:52.472302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:33:52.476372 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m22:33:52.477150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157ce510>]}
[0m22:33:52.477472 [debug] [MainThread]: On master: ROLLBACK
[0m22:33:52.478371 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:52.478549 [debug] [MainThread]: On master: BEGIN
[0m22:33:52.479641 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:33:52.479789 [debug] [MainThread]: On master: COMMIT
[0m22:33:52.479916 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:52.480034 [debug] [MainThread]: On master: COMMIT
[0m22:33:52.480591 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:33:52.480755 [debug] [MainThread]: On master: Close
[0m22:33:52.483197 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m22:33:52.483555 [info ] [Thread-1 (]: 1 of 30 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m22:33:52.483832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m22:33:52.484010 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m22:33:52.488570 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m22:33:52.489253 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m22:33:52.518810 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m22:33:52.519390 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:33:52.519561 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m22:33:52.519709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:52.536356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:33:52.536648 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:33:52.536876 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM (
        SELECT *,
               ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) AS rn
        FROM raw
    ) t
    WHERE rn = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:33:52.557133 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.020 seconds
[0m22:33:52.568280 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m22:33:52.568596 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:33:52.568790 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m22:33:52.571251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:33:52.572464 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m22:33:52.573723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116d6ec30>]}
[0m22:33:52.574157 [info ] [Thread-1 (]: 1 of 30 OK created sql incremental model public_pipedrive_analytics.stg_activity  [[32mSELECT 4568[0m in 0.09s]
[0m22:33:52.574493 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m22:33:52.574718 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m22:33:52.575064 [info ] [Thread-1 (]: 2 of 30 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m22:33:52.575450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m22:33:52.575658 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m22:33:52.578135 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.578678 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m22:33:52.582178 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.582492 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

    
  
    

  create temporary table "stg_activity_types__dbt_tmp223352579765"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE activity_type_id NOT IN (SELECT activity_type_id FROM "postgres"."public_pipedrive_analytics"."stg_activity_types")

  );
  
  
[0m22:33:52.582926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:52.607317 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.025 seconds
[0m22:33:52.615839 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.616615 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m22:33:52.618139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:33:52.618415 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.618619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223352579765'
        
      order by ordinal_position

  
[0m22:33:52.629152 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.010 seconds
[0m22:33:52.632895 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.633216 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.636558 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m22:33:52.645205 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.645591 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp223352579765'
        
      order by ordinal_position

  
[0m22:33:52.648733 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m22:33:52.651261 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.651546 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.655111 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m22:33:52.667790 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:33:52.695362 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.696736 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.697077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_activity_types" as DBT_INTERNAL_DEST
        where (activity_type_id) in (
            select distinct activity_type_id
            from "stg_activity_types__dbt_tmp223352579765" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_activity_types" ("activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_activity_types__dbt_tmp223352579765"
    )
  
[0m22:33:52.698770 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:33:52.699743 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:33:52.699962 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:33:52.700135 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:33:52.701610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:33:52.702182 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m22:33:52.702582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168490d0>]}
[0m22:33:52.703741 [info ] [Thread-1 (]: 2 of 30 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mINSERT 0 0[0m in 0.13s]
[0m22:33:52.704329 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m22:33:52.704623 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m22:33:52.705123 [info ] [Thread-1 (]: 3 of 30 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m22:33:52.705804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m22:33:52.706011 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m22:33:52.720754 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.721886 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m22:33:52.724502 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.724763 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp223352723315"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


    -- Only include new rows based on surrogate key
    WHERE deal_id_sk NOT IN (SELECT deal_id_sk FROM "postgres"."public_pipedrive_analytics"."stg_deal_changes")

  );
  
  
[0m22:33:52.724984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:52.772637 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.048 seconds
[0m22:33:52.774453 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.774638 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m22:33:52.775365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:33:52.775569 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.775744 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp223352723315'
        
      order by ordinal_position

  
[0m22:33:52.779649 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m22:33:52.781307 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.781505 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.783452 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m22:33:52.784998 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.785185 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp223352723315'
        
      order by ordinal_position

  
[0m22:33:52.786903 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m22:33:52.788638 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.788833 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.790620 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m22:33:52.791571 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_deal_changes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:33:52.792105 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.792583 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.792763 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_deal_changes" as DBT_INTERNAL_DEST
        where (deal_id_sk) in (
            select distinct deal_id_sk
            from "stg_deal_changes__dbt_tmp223352723315" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_deal_changes" ("deal_id_sk", "deal_id", "deal_change_timestamp", "deal_updated_field_key", "deal_new_value", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "deal_id_sk", "deal_id", "deal_change_timestamp", "deal_updated_field_key", "deal_new_value", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_deal_changes__dbt_tmp223352723315"
    )
  
[0m22:33:52.793692 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:33:52.794375 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m22:33:52.794546 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:33:52.794697 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m22:33:52.796716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:33:52.797059 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m22:33:52.797336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168273e0>]}
[0m22:33:52.797636 [info ] [Thread-1 (]: 3 of 30 OK created sql incremental model public_pipedrive_analytics.stg_deal_changes  [[32mINSERT 0 0[0m in 0.09s]
[0m22:33:52.797884 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m22:33:52.798087 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m22:33:52.798405 [info ] [Thread-1 (]: 4 of 30 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m22:33:52.798724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m22:33:52.798912 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m22:33:52.800975 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m22:33:52.801532 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m22:33:52.803533 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:33:52.803732 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

    
  
    

  create temporary table "stg_fields__dbt_tmp223352802766"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE field_key NOT IN (SELECT field_key FROM "postgres"."public_pipedrive_analytics"."stg_fields")

  );
  
  
[0m22:33:52.803960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:52.824618 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.021 seconds
[0m22:33:52.826209 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:33:52.826394 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m22:33:52.827188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:33:52.827348 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:33:52.827503 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields__dbt_tmp223352802766'
        
      order by ordinal_position

  
[0m22:33:52.831717 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m22:33:52.834101 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:33:52.834416 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.837925 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m22:33:52.839644 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:33:52.839871 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields__dbt_tmp223352802766'
        
      order by ordinal_position

  
[0m22:33:52.842093 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:33:52.843764 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:33:52.843967 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_fields'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.846064 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:33:52.847050 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_fields":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:33:52.847587 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m22:33:52.848209 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:33:52.848404 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_fields" as DBT_INTERNAL_DEST
        where (field_key) in (
            select distinct field_key
            from "stg_fields__dbt_tmp223352802766" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_fields" ("field_key", "field_name", "field_value_options", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "field_key", "field_name", "field_value_options", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_fields__dbt_tmp223352802766"
    )
  
[0m22:33:52.849596 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:33:52.850604 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:33:52.850772 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:33:52.850913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:33:52.851660 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:33:52.851993 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m22:33:52.852268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e0b7f0>]}
[0m22:33:52.852572 [info ] [Thread-1 (]: 4 of 30 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mINSERT 0 0[0m in 0.05s]
[0m22:33:52.852815 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m22:33:52.852983 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m22:33:52.853211 [info ] [Thread-1 (]: 5 of 30 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m22:33:52.853481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m22:33:52.853671 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m22:33:52.855574 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m22:33:52.856156 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m22:33:52.859302 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:33:52.859710 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

    
  
    

  create temporary table "stg_stages__dbt_tmp223352857250"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE stage_id NOT IN (SELECT stage_id FROM "postgres"."public_pipedrive_analytics"."stg_stages")

  );
  
  
[0m22:33:52.859912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:52.880220 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m22:33:52.883741 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:33:52.883945 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m22:33:52.884633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:33:52.884825 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:33:52.884996 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223352857250'
        
      order by ordinal_position

  
[0m22:33:52.889962 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m22:33:52.891577 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:33:52.891772 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.893803 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:33:52.895522 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:33:52.895708 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages__dbt_tmp223352857250'
        
      order by ordinal_position

  
[0m22:33:52.897505 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:33:52.898922 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:33:52.899102 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_stages'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.901078 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:33:52.901918 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_stages":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:33:52.902415 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m22:33:52.902859 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:33:52.903031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_stages" as DBT_INTERNAL_DEST
        where (stage_id) in (
            select distinct stage_id
            from "stg_stages__dbt_tmp223352857250" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_stages" ("stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "stage_id", "stage_name", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_stages__dbt_tmp223352857250"
    )
  
[0m22:33:52.904177 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:33:52.904959 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:33:52.905143 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:33:52.905298 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:33:52.906081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:33:52.906455 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m22:33:52.906750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116d32dd0>]}
[0m22:33:52.907059 [info ] [Thread-1 (]: 5 of 30 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mINSERT 0 0[0m in 0.05s]
[0m22:33:52.907312 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m22:33:52.907485 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m22:33:52.907715 [info ] [Thread-1 (]: 6 of 30 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m22:33:52.907980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m22:33:52.908199 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m22:33:52.910433 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m22:33:52.910904 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m22:33:52.913172 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:33:52.913397 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

    
  
    

  create temporary table "stg_users__dbt_tmp223352912339"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


      -- Only insert rows that don’t already exist in the target table
    WHERE user_id NOT IN (SELECT user_id FROM "postgres"."public_pipedrive_analytics"."stg_users")

  );
  
  
[0m22:33:52.913582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:52.935380 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.022 seconds
[0m22:33:52.937004 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:33:52.937193 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m22:33:52.938043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:33:52.938205 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:33:52.938361 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223352912339'
        
      order by ordinal_position

  
[0m22:33:52.941991 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m22:33:52.943844 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:33:52.944035 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.945971 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:33:52.947404 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:33:52.947588 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_users__dbt_tmp223352912339'
        
      order by ordinal_position

  
[0m22:33:52.949449 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m22:33:52.950862 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:33:52.951046 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_users'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:52.952703 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.001 seconds
[0m22:33:52.953631 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:33:52.954468 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m22:33:52.954929 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:33:52.955111 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_users" as DBT_INTERNAL_DEST
        where (user_id) in (
            select distinct user_id
            from "stg_users__dbt_tmp223352912339" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_users" ("user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "user_id", "user_name", "user_email", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_users__dbt_tmp223352912339"
    )
  
[0m22:33:52.955911 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:33:52.956545 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:33:52.956707 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:33:52.956850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:33:52.957729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:33:52.958053 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m22:33:52.958328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116dad780>]}
[0m22:33:52.958680 [info ] [Thread-1 (]: 6 of 30 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mINSERT 0 0[0m in 0.05s]
[0m22:33:52.959051 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m22:33:52.959262 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:33:52.959498 [info ] [Thread-1 (]: 7 of 30 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m22:33:52.959782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m22:33:52.959950 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:33:52.964154 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m22:33:52.964660 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:33:52.974646 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m22:33:52.975314 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m22:33:52.975497 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m22:33:52.975657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:52.993425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:33:52.993704 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m22:33:52.993895 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m22:33:52.995264 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:52.997110 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m22:33:52.997878 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m22:33:52.998344 [info ] [Thread-1 (]: 7 of 30 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.04s]
[0m22:33:52.998665 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:33:52.998864 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:33:52.999039 [info ] [Thread-1 (]: 8 of 30 START test not_null_stg_activity_activity_type_short ................... [RUN]
[0m22:33:52.999313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844)
[0m22:33:52.999518 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:33:53.001618 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m22:33:53.002245 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:33:53.003363 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m22:33:53.003796 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m22:33:53.003970 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: BEGIN
[0m22:33:53.004128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.020376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:33:53.020644 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m22:33:53.020821 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_short
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_type_short is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.021926 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.022769 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: ROLLBACK
[0m22:33:53.023412 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: Close
[0m22:33:53.023746 [info ] [Thread-1 (]: 8 of 30 PASS not_null_stg_activity_activity_type_short ......................... [[32mPASS[0m in 0.02s]
[0m22:33:53.024033 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:33:53.024223 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:33:53.024389 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_activity_user_id ............................... [RUN]
[0m22:33:53.024635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844, now test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272)
[0m22:33:53.024824 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:33:53.027431 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m22:33:53.028013 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:33:53.029044 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m22:33:53.029423 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m22:33:53.029577 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: BEGIN
[0m22:33:53.029720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.046420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:33:53.046706 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m22:33:53.046895 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.048112 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.049027 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: ROLLBACK
[0m22:33:53.049862 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: Close
[0m22:33:53.050341 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_activity_user_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:33:53.050741 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:33:53.050967 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:33:53.051148 [info ] [Thread-1 (]: 10 of 30 START test unique_stg_activity_activity_id ............................ [RUN]
[0m22:33:53.051413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m22:33:53.051640 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:33:53.055369 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m22:33:53.055955 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:33:53.057005 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m22:33:53.057437 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m22:33:53.057600 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m22:33:53.057746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.074611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:33:53.074900 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m22:33:53.075096 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:33:53.077821 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:33:53.078676 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m22:33:53.079303 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m22:33:53.079630 [info ] [Thread-1 (]: 10 of 30 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.03s]
[0m22:33:53.079904 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:33:53.080094 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:33:53.080264 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m22:33:53.080526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m22:33:53.080755 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:33:53.082928 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:33:53.083558 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:33:53.085156 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:33:53.085789 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:33:53.085968 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m22:33:53.086121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.103578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:33:53.103857 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:33:53.104052 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.104973 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.105876 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m22:33:53.106500 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m22:33:53.106898 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m22:33:53.107212 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:33:53.107420 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:33:53.107668 [info ] [Thread-1 (]: 12 of 30 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m22:33:53.107960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m22:33:53.108173 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:33:53.110956 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:33:53.111528 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:33:53.112780 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:33:53.113242 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:33:53.113432 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m22:33:53.113594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.133150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:33:53.133473 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:33:53.133685 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.135832 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:53.136747 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m22:33:53.137467 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m22:33:53.137857 [info ] [Thread-1 (]: 12 of 30 PASS relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[32mPASS[0m in 0.03s]
[0m22:33:53.138219 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:33:53.138443 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:33:53.138665 [info ] [Thread-1 (]: 13 of 30 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m22:33:53.138921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m22:33:53.139127 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:33:53.141735 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:33:53.142244 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:33:53.143319 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:33:53.143687 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:33:53.143859 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m22:33:53.144015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.161101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:33:53.161355 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:33:53.161540 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:33:53.162797 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.163722 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m22:33:53.164327 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m22:33:53.164675 [info ] [Thread-1 (]: 13 of 30 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m22:33:53.164980 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:33:53.165183 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:33:53.165391 [info ] [Thread-1 (]: 14 of 30 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m22:33:53.165597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m22:33:53.165873 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:33:53.168890 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:33:53.169506 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:33:53.170697 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:33:53.171159 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:33:53.171326 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m22:33:53.171479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.188810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:33:53.189114 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:33:53.189319 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.191247 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:53.192165 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m22:33:53.192987 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m22:33:53.193401 [info ] [Thread-1 (]: 14 of 30 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m22:33:53.193808 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:33:53.194030 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:33:53.194221 [info ] [Thread-1 (]: 15 of 30 START test not_null_stg_deal_changes_deal_id_sk ....................... [RUN]
[0m22:33:53.194508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e)
[0m22:33:53.194710 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:33:53.197020 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:33:53.197596 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:33:53.199108 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:33:53.200077 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:33:53.200314 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: BEGIN
[0m22:33:53.200491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.224977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:33:53.225288 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:33:53.225483 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.227569 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:53.228568 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: ROLLBACK
[0m22:33:53.229393 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: Close
[0m22:33:53.229749 [info ] [Thread-1 (]: 15 of 30 PASS not_null_stg_deal_changes_deal_id_sk ............................. [[32mPASS[0m in 0.04s]
[0m22:33:53.230117 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:33:53.230348 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:33:53.230571 [info ] [Thread-1 (]: 16 of 30 START test not_null_stg_deal_changes_deal_updated_field_key ........... [RUN]
[0m22:33:53.230799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624)
[0m22:33:53.230978 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:33:53.233580 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:33:53.234169 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:33:53.235440 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:33:53.235996 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:33:53.236187 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: BEGIN
[0m22:33:53.236346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.254149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:33:53.254412 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:33:53.254583 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_updated_field_key
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_updated_field_key is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.256400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:53.257267 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: ROLLBACK
[0m22:33:53.258014 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: Close
[0m22:33:53.258336 [info ] [Thread-1 (]: 16 of 30 PASS not_null_stg_deal_changes_deal_updated_field_key ................. [[32mPASS[0m in 0.03s]
[0m22:33:53.258603 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:33:53.258787 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:33:53.258952 [info ] [Thread-1 (]: 17 of 30 START test relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_  [RUN]
[0m22:33:53.259147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624, now test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb)
[0m22:33:53.259305 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:33:53.263513 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb"
[0m22:33:53.264121 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:33:53.265413 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb"
[0m22:33:53.266082 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb"
[0m22:33:53.266351 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb: BEGIN
[0m22:33:53.266537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.284798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:33:53.285112 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb"
[0m22:33:53.285323 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where deal_id is not null
),

parent as (
    select deal_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.288688 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:33:53.289676 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb: ROLLBACK
[0m22:33:53.290521 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb: Close
[0m22:33:53.290888 [error] [Thread-1 (]: 17 of 30 FAIL 4560 relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_  [[31mFAIL 4560[0m in 0.03s]
[0m22:33:53.291206 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb
[0m22:33:53.291410 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:33:53.291664 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb' to be skipped because of status 'fail'.  Reason: Got 4560 results, configured to fail if != 0.
[0m22:33:53.291870 [info ] [Thread-1 (]: 18 of 30 START test unique_stg_deal_changes_deal_id_sk ......................... [RUN]
[0m22:33:53.292397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_.535140fefb, now test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600)
[0m22:33:53.292641 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:33:53.295123 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:33:53.295620 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:33:53.296710 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:33:53.297084 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:33:53.297311 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: BEGIN
[0m22:33:53.297480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.318774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:33:53.319078 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:33:53.319275 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:33:53.324317 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:33:53.325336 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: ROLLBACK
[0m22:33:53.326116 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: Close
[0m22:33:53.326486 [info ] [Thread-1 (]: 18 of 30 PASS unique_stg_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.03s]
[0m22:33:53.326795 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:33:53.326997 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:33:53.327230 [info ] [Thread-1 (]: 19 of 30 START test not_null_stg_fields_field_key .............................. [RUN]
[0m22:33:53.327495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m22:33:53.327692 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:33:53.330022 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:33:53.330561 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:33:53.332150 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:33:53.332988 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:33:53.333216 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m22:33:53.333388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.355471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m22:33:53.355757 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:33:53.355947 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.356962 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.357835 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m22:33:53.358571 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m22:33:53.358904 [info ] [Thread-1 (]: 19 of 30 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m22:33:53.359231 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:33:53.359464 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:33:53.359686 [info ] [Thread-1 (]: 20 of 30 START test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [RUN]
[0m22:33:53.359906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa)
[0m22:33:53.360182 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:33:53.363170 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:33:53.363694 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:33:53.364804 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:33:53.365379 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:33:53.365612 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: BEGIN
[0m22:33:53.365791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.389512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:33:53.389795 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:33:53.389982 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_updated_field_key as from_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where deal_updated_field_key is not null
),

parent as (
    select field_key as to_field
    from "postgres"."public_pipedrive_analytics"."stg_fields"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.392994 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:33:53.393830 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: ROLLBACK
[0m22:33:53.394588 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: Close
[0m22:33:53.394972 [info ] [Thread-1 (]: 20 of 30 PASS relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[32mPASS[0m in 0.04s]
[0m22:33:53.395360 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:33:53.395558 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:33:53.395757 [info ] [Thread-1 (]: 21 of 30 START test unique_stg_fields_field_key ................................ [RUN]
[0m22:33:53.395987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m22:33:53.396346 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:33:53.398906 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:33:53.399843 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:33:53.400912 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:33:53.401375 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:33:53.401555 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m22:33:53.401704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.425369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:33:53.425677 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:33:53.425885 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:33:53.427213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.428151 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m22:33:53.428858 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m22:33:53.429278 [info ] [Thread-1 (]: 21 of 30 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m22:33:53.429686 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:33:53.429954 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:33:53.430250 [info ] [Thread-1 (]: 22 of 30 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m22:33:53.430493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m22:33:53.430745 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:33:53.433434 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:33:53.433958 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:33:53.435151 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:33:53.435663 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:33:53.435850 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m22:33:53.436016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.469970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m22:33:53.470257 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:33:53.470452 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.471603 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.472534 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m22:33:53.473279 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m22:33:53.473652 [info ] [Thread-1 (]: 22 of 30 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.04s]
[0m22:33:53.473974 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:33:53.474179 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:33:53.474427 [info ] [Thread-1 (]: 23 of 30 START test unique_stg_stages_stage_id ................................. [RUN]
[0m22:33:53.474728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m22:33:53.474946 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:33:53.477205 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:33:53.477744 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:33:53.479351 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:33:53.479840 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:33:53.480056 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m22:33:53.480226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.499067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:33:53.499407 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:33:53.499616 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:33:53.501019 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.501966 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m22:33:53.502945 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m22:33:53.503307 [info ] [Thread-1 (]: 23 of 30 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:33:53.503610 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:33:53.503811 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:33:53.504052 [info ] [Thread-1 (]: 24 of 30 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:33:53.504335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m22:33:53.504538 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:33:53.506810 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:33:53.507321 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:33:53.508463 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:33:53.508828 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:33:53.508990 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m22:33:53.509139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.527920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:33:53.528215 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:33:53.528412 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.529460 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.530347 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m22:33:53.531231 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m22:33:53.531579 [info ] [Thread-1 (]: 24 of 30 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:33:53.531949 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:33:53.532162 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:33:53.532449 [info ] [Thread-1 (]: 25 of 30 START test not_null_stg_users_user_name ............................... [RUN]
[0m22:33:53.532709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m22:33:53.532989 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:33:53.535837 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:33:53.536534 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:33:53.537685 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:33:53.538160 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:33:53.538346 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m22:33:53.538502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.559224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:33:53.559562 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:33:53.559778 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.561194 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.562131 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m22:33:53.562826 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m22:33:53.563176 [info ] [Thread-1 (]: 25 of 30 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m22:33:53.563471 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:33:53.563676 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:33:53.563926 [info ] [Thread-1 (]: 26 of 30 START test relationships_stg_activity_user_id__user_id__ref_stg_users_  [RUN]
[0m22:33:53.564214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02)
[0m22:33:53.564426 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:33:53.567897 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m22:33:53.568505 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:33:53.569735 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m22:33:53.570294 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m22:33:53.570610 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: BEGIN
[0m22:33:53.570784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.594020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m22:33:53.594324 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m22:33:53.594544 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.596581 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:33:53.597524 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: ROLLBACK
[0m22:33:53.598350 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: Close
[0m22:33:53.598818 [info ] [Thread-1 (]: 26 of 30 PASS relationships_stg_activity_user_id__user_id__ref_stg_users_ ...... [[32mPASS[0m in 0.03s]
[0m22:33:53.599657 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:33:53.600177 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:33:53.600484 [info ] [Thread-1 (]: 27 of 30 START test unique_stg_users_user_id ................................... [RUN]
[0m22:33:53.600784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m22:33:53.601008 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:33:53.603483 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:33:53.604001 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:33:53.605664 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:33:53.606168 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:33:53.606351 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m22:33:53.606514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.632487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m22:33:53.632861 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:33:53.633102 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:33:53.636896 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:33:53.637881 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m22:33:53.638638 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m22:33:53.639070 [info ] [Thread-1 (]: 27 of 30 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m22:33:53.639557 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:33:53.639804 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m22:33:53.640100 [info ] [Thread-1 (]: 28 of 30 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m22:33:53.640370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m22:33:53.640606 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m22:33:53.643293 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.643874 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m22:33:53.646444 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.646715 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

    
  
    

  create temporary table "stg_lost_reasons__dbt_tmp223353645221"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(value->>'id' AS INT) AS lost_reason_id -- Unique identifier for the lost reason
        , value->>'name' AS lost_reason_name -- Name of the lost reason
    FROM raw
        , jsonb_array_elements(raw.field_value_options) AS value  -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


    WHERE lost_reason_id NOT IN (SELECT lost_reason_id FROM "postgres"."public_pipedrive_analytics"."stg_lost_reasons")

  );
  
  
[0m22:33:53.646933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.667872 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.021 seconds
[0m22:33:53.669574 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.669775 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m22:33:53.670656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:33:53.670826 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.670992 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons__dbt_tmp223353645221'
        
      order by ordinal_position

  
[0m22:33:53.674961 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m22:33:53.676541 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.676733 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:53.678652 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:33:53.680439 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.680652 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons__dbt_tmp223353645221'
        
      order by ordinal_position

  
[0m22:33:53.682381 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:33:53.683867 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.684062 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_lost_reasons'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m22:33:53.685836 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:33:53.686643 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_lost_reasons":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:33:53.687134 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.687561 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.687733 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_lost_reasons" as DBT_INTERNAL_DEST
        where (lost_reason_id) in (
            select distinct lost_reason_id
            from "stg_lost_reasons__dbt_tmp223353645221" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_lost_reasons" ("lost_reason_id", "lost_reason_name", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "lost_reason_id", "lost_reason_name", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_lost_reasons__dbt_tmp223353645221"
    )
  
[0m22:33:53.688681 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:33:53.689410 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:33:53.689573 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:33:53.689718 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:33:53.690713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:33:53.691103 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m22:33:53.691406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '311ab882-cffd-4645-913b-20995d2fac43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116d67bf0>]}
[0m22:33:53.691725 [info ] [Thread-1 (]: 28 of 30 OK created sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[32mINSERT 0 0[0m in 0.05s]
[0m22:33:53.691995 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m22:33:53.692378 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:33:53.692634 [info ] [Thread-1 (]: 29 of 30 START test not_null_stg_lost_reasons_lost_reason_id ................... [RUN]
[0m22:33:53.692852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_lost_reasons, now test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768)
[0m22:33:53.693098 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:33:53.695444 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:33:53.695937 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:33:53.697028 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:33:53.697498 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:33:53.697668 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: BEGIN
[0m22:33:53.697816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.717050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:33:53.717312 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:33:53.717490 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lost_reason_id
from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is null



  
  
      
    ) dbt_internal_test
[0m22:33:53.718472 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.719293 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: ROLLBACK
[0m22:33:53.719850 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: Close
[0m22:33:53.720208 [info ] [Thread-1 (]: 29 of 30 PASS not_null_stg_lost_reasons_lost_reason_id ......................... [[32mPASS[0m in 0.03s]
[0m22:33:53.720485 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:33:53.720668 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:33:53.720862 [info ] [Thread-1 (]: 30 of 30 START test unique_stg_lost_reasons_lost_reason_id ..................... [RUN]
[0m22:33:53.721056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768, now test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d)
[0m22:33:53.721213 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:33:53.723191 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:33:53.723609 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:33:53.726174 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:33:53.726550 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:33:53.726711 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: BEGIN
[0m22:33:53.726850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:53.752594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m22:33:53.752861 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:33:53.753041 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    lost_reason_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is not null
group by lost_reason_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:33:53.754532 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:33:53.755357 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: ROLLBACK
[0m22:33:53.756113 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: Close
[0m22:33:53.756429 [info ] [Thread-1 (]: 30 of 30 PASS unique_stg_lost_reasons_lost_reason_id ........................... [[32mPASS[0m in 0.04s]
[0m22:33:53.756719 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:33:53.757379 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:53.757517 [debug] [MainThread]: On master: BEGIN
[0m22:33:53.757632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:33:53.775381 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m22:33:53.775624 [debug] [MainThread]: On master: COMMIT
[0m22:33:53.775761 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:53.775882 [debug] [MainThread]: On master: COMMIT
[0m22:33:53.776383 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:33:53.776510 [debug] [MainThread]: On master: Close
[0m22:33:53.776719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:53.776836 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' was properly closed.
[0m22:33:53.777033 [info ] [MainThread]: 
[0m22:33:53.777183 [info ] [MainThread]: Finished running 7 incremental models, 23 data tests in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m22:33:53.779058 [debug] [MainThread]: Command end result
[0m22:33:53.794413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:33:53.795582 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:33:53.799430 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:33:53.799811 [info ] [MainThread]: 
[0m22:33:53.800088 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:33:53.800260 [info ] [MainThread]: 
[0m22:33:53.800540 [error] [MainThread]: [31mFailure in test relationships_stg_activity_deal_id__deal_id__ref_stg_deal_changes_ (models/staging/stg_schema.yml)[0m
[0m22:33:53.800729 [error] [MainThread]:   Got 4560 results, configured to fail if != 0
[0m22:33:53.800848 [info ] [MainThread]: 
[0m22:33:53.801000 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_schema.yml/relationships_stg_activity_05eb496c717b2eba8c23f3a71c5d91b7.sql
[0m22:33:53.801131 [info ] [MainThread]: 
[0m22:33:53.801267 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=30
[0m22:33:53.803057 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.1813712, "process_in_blocks": "0", "process_kernel_time": 0.335795, "process_mem_max_rss": "134447104", "process_out_blocks": "0", "process_user_time": 1.813032}
[0m22:33:53.803314 [debug] [MainThread]: Command `dbt build` failed at 22:33:53.803267 after 2.18 seconds
[0m22:33:53.803503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107492630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e23dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e23830>]}
[0m22:33:53.803674 [debug] [MainThread]: Flushing usage events
[0m22:33:55.747429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:34.781648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105984050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cfb10>]}


============================== 22:41:34.784990 | 19efe6c6-bda3-4b3e-a7a5-1a0501acb97e ==============================
[0m22:41:34.784990 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:41:34.785308 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'introspect': 'True', 'invocation_command': 'dbt build -s tag:staging -f', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True'}
[0m22:41:35.951709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105acbe10>]}
[0m22:41:35.989264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664fbd0>]}
[0m22:41:35.990397 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:41:36.136662 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:41:36.264570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:41:36.265210 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_schema.yml
[0m22:41:36.542582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760d450>]}
[0m22:41:36.585827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:41:36.588352 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:41:36.610148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d8050>]}
[0m22:41:36.610443 [info ] [MainThread]: Found 7 models, 22 data tests, 6 sources, 434 macros
[0m22:41:36.611773 [info ] [MainThread]: 
[0m22:41:36.611955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:36.612086 [info ] [MainThread]: 
[0m22:41:36.612319 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:41:36.614287 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:41:36.685526 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:41:36.685752 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:41:36.685888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:36.808092 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.122 seconds
[0m22:41:36.809127 [debug] [ThreadPool]: On list_postgres: Close
[0m22:41:36.810147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m22:41:36.813010 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:41:36.813185 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:41:36.813324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:36.885190 [debug] [ThreadPool]: SQL status: BEGIN in 0.071 seconds
[0m22:41:36.890165 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:41:36.890540 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:41:36.908294 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.017 seconds
[0m22:41:36.909819 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:41:36.914220 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:41:36.917606 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:36.917816 [debug] [MainThread]: On master: BEGIN
[0m22:41:36.917943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:36.945106 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m22:41:36.945386 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:36.945616 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:41:36.950755 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m22:41:36.951630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d584b0>]}
[0m22:41:36.951901 [debug] [MainThread]: On master: ROLLBACK
[0m22:41:36.952676 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:36.952886 [debug] [MainThread]: On master: BEGIN
[0m22:41:36.954078 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:41:36.954244 [debug] [MainThread]: On master: COMMIT
[0m22:41:36.954381 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:36.954506 [debug] [MainThread]: On master: COMMIT
[0m22:41:36.955065 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:41:36.955203 [debug] [MainThread]: On master: Close
[0m22:41:36.957672 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m22:41:36.958042 [info ] [Thread-1 (]: 1 of 29 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m22:41:36.958320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m22:41:36.958510 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m22:41:36.964688 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m22:41:36.965891 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m22:41:36.998394 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m22:41:36.999191 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:41:36.999380 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m22:41:36.999537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.017202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:41:37.017504 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:41:37.017722 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM (
        SELECT *,
               ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) AS rn
        FROM raw
    ) t
    WHERE rn = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:41:37.055409 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.037 seconds
[0m22:41:37.061227 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:41:37.061461 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m22:41:37.065012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:41:37.066619 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:41:37.066822 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m22:41:37.067758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:37.076341 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m22:41:37.076632 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:41:37.076796 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m22:41:37.079269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:41:37.083053 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m22:41:37.086315 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m22:41:37.086604 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m22:41:37.093371 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m22:41:37.095347 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m22:41:37.096689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d94a10>]}
[0m22:41:37.097113 [info ] [Thread-1 (]: 1 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity  [[32mSELECT 4568[0m in 0.14s]
[0m22:41:37.097533 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m22:41:37.097745 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m22:41:37.098140 [info ] [Thread-1 (]: 2 of 29 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m22:41:37.098593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m22:41:37.098821 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m22:41:37.100852 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m22:41:37.101411 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m22:41:37.103872 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m22:41:37.104654 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:41:37.104843 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m22:41:37.105000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.127845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m22:41:37.128141 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:41:37.128334 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:41:37.132283 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m22:41:37.134062 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:41:37.134333 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m22:41:37.135387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:37.136886 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:41:37.137072 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m22:41:37.137982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:37.138923 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:41:37.139149 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:41:37.139312 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m22:41:37.140931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:41:37.142428 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m22:41:37.142813 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m22:41:37.142996 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m22:41:37.145028 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:41:37.145797 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m22:41:37.146117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079293d0>]}
[0m22:41:37.146458 [info ] [Thread-1 (]: 2 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mSELECT 4[0m in 0.05s]
[0m22:41:37.146830 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m22:41:37.147066 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m22:41:37.147397 [info ] [Thread-1 (]: 3 of 29 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m22:41:37.147708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m22:41:37.147938 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m22:41:37.150111 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:41:37.150694 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m22:41:37.152905 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m22:41:37.153410 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:41:37.153610 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m22:41:37.153833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.173888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m22:41:37.174187 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:41:37.174397 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m22:41:37.203675 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.029 seconds
[0m22:41:37.205491 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:41:37.205703 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m22:41:37.206710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:37.208234 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:41:37.208423 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m22:41:37.209179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:37.209931 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m22:41:37.210099 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:41:37.210242 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m22:41:37.214314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:41:37.215865 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m22:41:37.216220 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m22:41:37.216386 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m22:41:37.218821 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:41:37.219667 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m22:41:37.220093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bd7b0>]}
[0m22:41:37.220632 [info ] [Thread-1 (]: 3 of 29 OK created sql incremental model public_pipedrive_analytics.stg_deal_changes  [[32mSELECT 15406[0m in 0.07s]
[0m22:41:37.221020 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m22:41:37.221210 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m22:41:37.221476 [info ] [Thread-1 (]: 4 of 29 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m22:41:37.221761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m22:41:37.221927 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m22:41:37.223941 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m22:41:37.224414 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m22:41:37.226549 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m22:41:37.227335 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:41:37.227522 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m22:41:37.227670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.251621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:41:37.252057 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:41:37.252331 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:41:37.258285 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m22:41:37.260670 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:41:37.260897 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m22:41:37.262009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:37.263396 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:41:37.263557 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m22:41:37.264376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:37.265155 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:41:37.265339 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:41:37.265491 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m22:41:37.267997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:41:37.269586 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup"
[0m22:41:37.269933 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m22:41:37.270097 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m22:41:37.273548 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:41:37.274394 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m22:41:37.274779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e50ff0>]}
[0m22:41:37.275180 [info ] [Thread-1 (]: 4 of 29 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mSELECT 4[0m in 0.05s]
[0m22:41:37.275502 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m22:41:37.275756 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m22:41:37.276023 [info ] [Thread-1 (]: 5 of 29 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m22:41:37.276510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m22:41:37.276738 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m22:41:37.278861 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m22:41:37.279725 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m22:41:37.282716 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m22:41:37.284744 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:41:37.284959 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m22:41:37.285178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.313089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m22:41:37.313365 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:41:37.313561 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m22:41:37.315726 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m22:41:37.317537 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:41:37.317763 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m22:41:37.319813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:41:37.322129 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:41:37.322369 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m22:41:37.323922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:37.324904 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:41:37.325140 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:41:37.325326 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m22:41:37.329195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:41:37.335457 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m22:41:37.335937 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m22:41:37.336143 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m22:41:37.339491 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:41:37.340456 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m22:41:37.340827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c22550>]}
[0m22:41:37.341536 [info ] [Thread-1 (]: 5 of 29 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mSELECT 9[0m in 0.06s]
[0m22:41:37.342353 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m22:41:37.342784 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m22:41:37.343371 [info ] [Thread-1 (]: 6 of 29 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m22:41:37.343724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m22:41:37.344182 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m22:41:37.347009 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m22:41:37.347887 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m22:41:37.356689 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m22:41:37.358402 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:41:37.359280 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m22:41:37.359670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.417865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m22:41:37.418177 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:41:37.418372 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


  );
  
  
[0m22:41:37.437152 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.018 seconds
[0m22:41:37.441971 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:41:37.442338 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m22:41:37.443752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:37.446860 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:41:37.447244 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:41:37.449802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:41:37.451254 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:41:37.451819 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:41:37.452703 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m22:41:37.459385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m22:41:37.461241 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m22:41:37.461650 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m22:41:37.461831 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m22:41:37.465937 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:41:37.466801 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m22:41:37.467365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0f690>]}
[0m22:41:37.467762 [info ] [Thread-1 (]: 6 of 29 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mSELECT 1787[0m in 0.12s]
[0m22:41:37.468081 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m22:41:37.468403 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:41:37.468633 [info ] [Thread-1 (]: 7 of 29 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m22:41:37.469002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m22:41:37.469183 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:41:37.474262 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m22:41:37.475103 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:41:37.485464 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m22:41:37.486210 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m22:41:37.486416 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m22:41:37.486582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.512225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m22:41:37.512576 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m22:41:37.512761 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.514801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:37.516799 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m22:41:37.517746 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m22:41:37.518146 [info ] [Thread-1 (]: 7 of 29 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.05s]
[0m22:41:37.518431 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m22:41:37.518622 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:41:37.518796 [info ] [Thread-1 (]: 8 of 29 START test not_null_stg_activity_activity_type_short ................... [RUN]
[0m22:41:37.519066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844)
[0m22:41:37.519226 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:41:37.521342 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m22:41:37.522008 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:41:37.523377 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m22:41:37.523781 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m22:41:37.523939 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: BEGIN
[0m22:41:37.524080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.546274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m22:41:37.546574 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m22:41:37.546761 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_short
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_type_short is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.548343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:37.549919 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: ROLLBACK
[0m22:41:37.551057 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: Close
[0m22:41:37.551509 [info ] [Thread-1 (]: 8 of 29 PASS not_null_stg_activity_activity_type_short ......................... [[32mPASS[0m in 0.03s]
[0m22:41:37.551819 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m22:41:37.552002 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:41:37.552230 [info ] [Thread-1 (]: 9 of 29 START test not_null_stg_activity_user_id ............................... [RUN]
[0m22:41:37.552449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844, now test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272)
[0m22:41:37.552637 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:41:37.555057 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m22:41:37.555839 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:41:37.557086 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m22:41:37.557694 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m22:41:37.558080 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: BEGIN
[0m22:41:37.558274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.578188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m22:41:37.578480 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m22:41:37.578675 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.579982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:37.580847 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: ROLLBACK
[0m22:41:37.581645 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: Close
[0m22:41:37.582147 [info ] [Thread-1 (]: 9 of 29 PASS not_null_stg_activity_user_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:41:37.582621 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m22:41:37.582907 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:41:37.583137 [info ] [Thread-1 (]: 10 of 29 START test unique_stg_activity_activity_id ............................ [RUN]
[0m22:41:37.583412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m22:41:37.583593 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:41:37.587103 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m22:41:37.589062 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:41:37.590190 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m22:41:37.590655 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m22:41:37.590849 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m22:41:37.591027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.617634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m22:41:37.617903 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m22:41:37.618083 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:41:37.621637 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:41:37.622554 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m22:41:37.623311 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m22:41:37.623678 [info ] [Thread-1 (]: 10 of 29 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.04s]
[0m22:41:37.624077 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m22:41:37.624462 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:41:37.624754 [info ] [Thread-1 (]: 11 of 29 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m22:41:37.625100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m22:41:37.625278 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:41:37.627668 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:41:37.628429 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:41:37.630336 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:41:37.630885 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:41:37.631076 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m22:41:37.631238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.652091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:41:37.652394 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m22:41:37.653259 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.655657 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:37.658610 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m22:41:37.661762 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m22:41:37.664212 [info ] [Thread-1 (]: 11 of 29 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.04s]
[0m22:41:37.665086 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m22:41:37.665332 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:41:37.665513 [info ] [Thread-1 (]: 12 of 29 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m22:41:37.665849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m22:41:37.666167 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:41:37.669939 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:41:37.670637 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:41:37.673403 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:41:37.674276 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:41:37.674472 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m22:41:37.674813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.697068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m22:41:37.697356 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m22:41:37.697551 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.700070 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:37.701042 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m22:41:37.701954 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m22:41:37.702320 [info ] [Thread-1 (]: 12 of 29 PASS relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[32mPASS[0m in 0.04s]
[0m22:41:37.702610 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m22:41:37.702804 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:41:37.703004 [info ] [Thread-1 (]: 13 of 29 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m22:41:37.703212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m22:41:37.703382 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:41:37.705541 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:41:37.706197 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:41:37.707366 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:41:37.707773 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:41:37.708069 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m22:41:37.708285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.732221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:41:37.732487 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m22:41:37.732660 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:41:37.733875 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:37.734650 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m22:41:37.737251 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m22:41:37.737778 [info ] [Thread-1 (]: 13 of 29 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m22:41:37.738172 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m22:41:37.738565 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:41:37.738800 [info ] [Thread-1 (]: 14 of 29 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m22:41:37.739019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m22:41:37.739183 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:41:37.741807 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:41:37.742506 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:41:37.743796 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:41:37.744321 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:41:37.744500 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m22:41:37.744653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.769166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:41:37.769434 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m22:41:37.769609 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.771788 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:37.772597 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m22:41:37.773282 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m22:41:37.773657 [info ] [Thread-1 (]: 14 of 29 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m22:41:37.773944 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m22:41:37.774131 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:41:37.774361 [info ] [Thread-1 (]: 15 of 29 START test not_null_stg_deal_changes_deal_id_sk ....................... [RUN]
[0m22:41:37.774595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e)
[0m22:41:37.774768 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:41:37.776825 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:41:37.777297 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:41:37.778631 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:41:37.778982 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:41:37.779138 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: BEGIN
[0m22:41:37.779276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.801019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m22:41:37.801292 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m22:41:37.801470 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.803208 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:37.804006 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: ROLLBACK
[0m22:41:37.804749 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: Close
[0m22:41:37.805062 [info ] [Thread-1 (]: 15 of 29 PASS not_null_stg_deal_changes_deal_id_sk ............................. [[32mPASS[0m in 0.03s]
[0m22:41:37.805347 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m22:41:37.805537 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:41:37.805762 [info ] [Thread-1 (]: 16 of 29 START test not_null_stg_deal_changes_deal_updated_field_key ........... [RUN]
[0m22:41:37.806203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624)
[0m22:41:37.806598 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:41:37.809719 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:41:37.810349 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:41:37.813061 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:41:37.813615 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:41:37.813787 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: BEGIN
[0m22:41:37.813937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.833529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m22:41:37.833813 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m22:41:37.833996 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_updated_field_key
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_updated_field_key is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.835801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:37.836614 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: ROLLBACK
[0m22:41:37.837184 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: Close
[0m22:41:37.837591 [info ] [Thread-1 (]: 16 of 29 PASS not_null_stg_deal_changes_deal_updated_field_key ................. [[32mPASS[0m in 0.03s]
[0m22:41:37.837905 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m22:41:37.838103 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:41:37.838300 [info ] [Thread-1 (]: 17 of 29 START test unique_stg_deal_changes_deal_id_sk ......................... [RUN]
[0m22:41:37.838554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624, now test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600)
[0m22:41:37.838875 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:41:37.841031 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:41:37.841722 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:41:37.842805 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:41:37.843292 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:41:37.843476 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: BEGIN
[0m22:41:37.843623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.869487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m22:41:37.869780 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m22:41:37.869968 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:41:37.877361 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:41:37.878427 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: ROLLBACK
[0m22:41:37.879388 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: Close
[0m22:41:37.879765 [info ] [Thread-1 (]: 17 of 29 PASS unique_stg_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.04s]
[0m22:41:37.880112 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m22:41:37.880309 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:41:37.880502 [info ] [Thread-1 (]: 18 of 29 START test not_null_stg_fields_field_key .............................. [RUN]
[0m22:41:37.881221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m22:41:37.881885 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:41:37.885217 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:41:37.885987 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:41:37.887440 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:41:37.888246 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:41:37.888444 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m22:41:37.888601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.919772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m22:41:37.920056 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m22:41:37.920237 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.924606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m22:41:37.925400 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m22:41:37.927617 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m22:41:37.928017 [info ] [Thread-1 (]: 18 of 29 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.05s]
[0m22:41:37.928491 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m22:41:37.928716 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:41:37.928908 [info ] [Thread-1 (]: 19 of 29 START test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [RUN]
[0m22:41:37.929195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa)
[0m22:41:37.929469 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:41:37.932642 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:41:37.933086 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:41:37.935945 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:41:37.936435 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:41:37.936609 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: BEGIN
[0m22:41:37.936758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.955360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:41:37.955633 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m22:41:37.955830 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_updated_field_key as from_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where deal_updated_field_key is not null
),

parent as (
    select field_key as to_field
    from "postgres"."public_pipedrive_analytics"."stg_fields"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:41:37.959146 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:41:37.960109 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: ROLLBACK
[0m22:41:37.960730 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: Close
[0m22:41:37.961098 [info ] [Thread-1 (]: 19 of 29 PASS relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[32mPASS[0m in 0.03s]
[0m22:41:37.961408 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m22:41:37.961621 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:41:37.961862 [info ] [Thread-1 (]: 20 of 29 START test unique_stg_fields_field_key ................................ [RUN]
[0m22:41:37.962130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m22:41:37.962309 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:41:37.964531 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:41:37.965022 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:41:37.966748 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:41:37.967385 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:41:37.967595 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m22:41:37.967764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:37.990554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m22:41:37.990873 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m22:41:37.991070 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:41:37.992572 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:37.993555 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m22:41:37.994716 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m22:41:37.995146 [info ] [Thread-1 (]: 20 of 29 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m22:41:37.995505 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m22:41:37.995707 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:41:37.995936 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m22:41:37.996272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m22:41:37.996503 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:41:37.998981 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:41:37.999796 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:41:38.001136 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:41:38.001897 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:41:38.002097 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m22:41:38.002264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:38.025023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m22:41:38.025359 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m22:41:38.025636 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m22:41:38.027175 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:38.028146 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m22:41:38.029045 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m22:41:38.029406 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m22:41:38.029919 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m22:41:38.030152 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:41:38.030370 [info ] [Thread-1 (]: 22 of 29 START test unique_stg_stages_stage_id ................................. [RUN]
[0m22:41:38.030610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m22:41:38.030788 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:41:38.033887 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:41:38.034571 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:41:38.035954 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:41:38.036602 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:41:38.036796 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m22:41:38.036966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:38.061512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:41:38.061832 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m22:41:38.062025 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:41:38.063520 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:38.064457 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m22:41:38.065550 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m22:41:38.066233 [info ] [Thread-1 (]: 22 of 29 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.04s]
[0m22:41:38.066618 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m22:41:38.066864 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:41:38.067092 [info ] [Thread-1 (]: 23 of 29 START test not_null_stg_users_user_id ................................. [RUN]
[0m22:41:38.067379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m22:41:38.067551 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:41:38.069629 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:41:38.070094 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:41:38.071415 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:41:38.071777 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:41:38.071929 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m22:41:38.072063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:38.091382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:41:38.091670 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m22:41:38.091859 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:41:38.093175 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:38.094125 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m22:41:38.094884 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m22:41:38.095249 [info ] [Thread-1 (]: 23 of 29 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m22:41:38.095547 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m22:41:38.095742 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:41:38.095918 [info ] [Thread-1 (]: 24 of 29 START test not_null_stg_users_user_name ............................... [RUN]
[0m22:41:38.096138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m22:41:38.096370 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:41:38.098758 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:41:38.099695 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:41:38.101569 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:41:38.102184 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:41:38.102370 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m22:41:38.102529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:38.125513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m22:41:38.125818 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m22:41:38.125998 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m22:41:38.127371 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:38.128327 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m22:41:38.129248 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m22:41:38.129591 [info ] [Thread-1 (]: 24 of 29 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m22:41:38.129877 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m22:41:38.130151 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:41:38.130377 [info ] [Thread-1 (]: 25 of 29 START test relationships_stg_activity_user_id__user_id__ref_stg_users_  [RUN]
[0m22:41:38.130612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02)
[0m22:41:38.130788 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:41:38.133834 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m22:41:38.134628 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:41:38.136299 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m22:41:38.136907 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m22:41:38.137086 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: BEGIN
[0m22:41:38.137239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:38.157828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:41:38.158128 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m22:41:38.158322 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:41:38.160529 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:38.161412 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: ROLLBACK
[0m22:41:38.162000 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: Close
[0m22:41:38.162328 [info ] [Thread-1 (]: 25 of 29 PASS relationships_stg_activity_user_id__user_id__ref_stg_users_ ...... [[32mPASS[0m in 0.03s]
[0m22:41:38.162601 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m22:41:38.162786 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:41:38.162977 [info ] [Thread-1 (]: 26 of 29 START test unique_stg_users_user_id ................................... [RUN]
[0m22:41:38.163173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m22:41:38.163331 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:41:38.166137 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:41:38.166944 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:41:38.168493 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:41:38.169093 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:41:38.169299 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m22:41:38.169469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:38.190829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:41:38.191092 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m22:41:38.191264 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:41:38.193229 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:41:38.194020 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m22:41:38.194645 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m22:41:38.194952 [info ] [Thread-1 (]: 26 of 29 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m22:41:38.195210 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m22:41:38.195408 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m22:41:38.195673 [info ] [Thread-1 (]: 27 of 29 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m22:41:38.195866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m22:41:38.196024 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m22:41:38.197983 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:41:38.198464 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m22:41:38.200973 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m22:41:38.201675 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:41:38.201844 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m22:41:38.201988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:38.218469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:41:38.218760 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:41:38.218978 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(value->>'id' AS INT) AS lost_reason_id -- Unique identifier for the lost reason
        , value->>'name' AS lost_reason_name -- Name of the lost reason
    FROM raw
        , jsonb_array_elements(raw.field_value_options) AS value  -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


  );
  
  
[0m22:41:38.222392 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m22:41:38.224131 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:41:38.224324 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons" rename to "stg_lost_reasons__dbt_backup"
[0m22:41:38.225103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:38.227038 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:41:38.227263 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp" rename to "stg_lost_reasons"
[0m22:41:38.228791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:41:38.229801 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:41:38.230014 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:41:38.230182 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m22:41:38.231183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:41:38.232595 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup"
[0m22:41:38.233052 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m22:41:38.233236 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup" cascade
[0m22:41:38.236293 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:41:38.237187 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m22:41:38.237551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19efe6c6-bda3-4b3e-a7a5-1a0501acb97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2ffb0>]}
[0m22:41:38.237903 [info ] [Thread-1 (]: 27 of 29 OK created sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[32mSELECT 5[0m in 0.04s]
[0m22:41:38.238187 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m22:41:38.238612 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:41:38.238845 [info ] [Thread-1 (]: 28 of 29 START test not_null_stg_lost_reasons_lost_reason_id ................... [RUN]
[0m22:41:38.239071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_lost_reasons, now test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768)
[0m22:41:38.239245 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:41:38.241547 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:41:38.242148 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:41:38.243820 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:41:38.244320 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:41:38.244499 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: BEGIN
[0m22:41:38.244658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:38.265563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:41:38.265895 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m22:41:38.266096 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lost_reason_id
from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is null



  
  
      
    ) dbt_internal_test
[0m22:41:38.267307 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:38.268194 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: ROLLBACK
[0m22:41:38.268880 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: Close
[0m22:41:38.269198 [info ] [Thread-1 (]: 28 of 29 PASS not_null_stg_lost_reasons_lost_reason_id ......................... [[32mPASS[0m in 0.03s]
[0m22:41:38.269554 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m22:41:38.269769 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:41:38.269945 [info ] [Thread-1 (]: 29 of 29 START test unique_stg_lost_reasons_lost_reason_id ..................... [RUN]
[0m22:41:38.270167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768, now test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d)
[0m22:41:38.270344 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:41:38.272446 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:41:38.272913 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:41:38.274203 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:41:38.274581 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:41:38.274757 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: BEGIN
[0m22:41:38.274917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:38.294106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:41:38.294442 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m22:41:38.294631 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    lost_reason_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is not null
group by lost_reason_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:41:38.296186 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:41:38.297127 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: ROLLBACK
[0m22:41:38.298335 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: Close
[0m22:41:38.299047 [info ] [Thread-1 (]: 29 of 29 PASS unique_stg_lost_reasons_lost_reason_id ........................... [[32mPASS[0m in 0.03s]
[0m22:41:38.299554 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m22:41:38.301402 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:38.301658 [debug] [MainThread]: On master: BEGIN
[0m22:41:38.301945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:38.323377 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m22:41:38.323632 [debug] [MainThread]: On master: COMMIT
[0m22:41:38.323781 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:38.323902 [debug] [MainThread]: On master: COMMIT
[0m22:41:38.324449 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:41:38.324583 [debug] [MainThread]: On master: Close
[0m22:41:38.324792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:38.324913 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' was properly closed.
[0m22:41:38.325098 [info ] [MainThread]: 
[0m22:41:38.325244 [info ] [MainThread]: Finished running 7 incremental models, 22 data tests in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m22:41:38.327165 [debug] [MainThread]: Command end result
[0m22:41:38.344202 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m22:41:38.345454 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m22:41:38.350188 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m22:41:38.350430 [info ] [MainThread]: 
[0m22:41:38.350626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:41:38.350824 [info ] [MainThread]: 
[0m22:41:38.351055 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=29
[0m22:41:38.354352 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.6133246, "process_in_blocks": "0", "process_kernel_time": 0.422383, "process_mem_max_rss": "129646592", "process_out_blocks": "0", "process_user_time": 1.907234}
[0m22:41:38.354674 [debug] [MainThread]: Command `dbt build` succeeded at 22:41:38.354625 after 3.61 seconds
[0m22:41:38.354869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107690650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105216330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dad0d0>]}
[0m22:41:38.355045 [debug] [MainThread]: Flushing usage events
[0m22:41:40.331785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:59:35.992259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107633b10>]}


============================== 00:59:35.996488 | 5d202cc6-6f0a-40be-92bd-45bc8c781877 ==============================
[0m00:59:35.996488 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:59:35.996850 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'partial_parse': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt build -s tag:intermediate -f', 'fail_fast': 'False', 'target_path': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs'}
[0m00:59:36.166467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d202cc6-6f0a-40be-92bd-45bc8c781877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106607e10>]}
[0m00:59:36.195915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d202cc6-6f0a-40be-92bd-45bc8c781877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b3bd0>]}
[0m00:59:36.196704 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:59:36.272228 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:59:36.340987 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: intermediate/int_schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |     - name: deal_new_value
    28 |       description: New value after the deal change. Can represent different types of updates depending on deal_updated_field_key i.e. timestamp of deal creation (add_time), user assigned to the deal (user_id), stage ID (maps to stages table), lost reason ID (maps to stg_lost_reasons table)
    29 |     - name: stage_name
    30 |       description: Stage name for stage_id changes. Examples: Lead Generation, Qualified Lead, Needs Assessment, etc.
    31 |     - name: lost_reason_name
    32 |       description: Lost reason name for lost_reason changes. Examples: Customer Not Ready, Pricing Issue, Unreachable Customer, etc.
    33 |     - name: dwh_creation_timestamp
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 30, column 61
[0m00:59:36.343229 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.41736642, "process_in_blocks": "0", "process_kernel_time": 0.295901, "process_mem_max_rss": "101498880", "process_out_blocks": "0", "process_user_time": 0.991632}
[0m00:59:36.343531 [debug] [MainThread]: Command `dbt build` failed at 00:59:36.343468 after 0.42 seconds
[0m00:59:36.343759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd64e0>]}
[0m00:59:36.343951 [debug] [MainThread]: Flushing usage events
[0m00:59:37.990722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:34.225533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b33b10>]}


============================== 01:01:34.229096 | 6a781b47-e3aa-4019-89bc-c2d63cf59d96 ==============================
[0m01:01:34.229096 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:01:34.229489 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s tag:intermediate -f', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'empty': 'False', 'introspect': 'True', 'debug': 'False'}
[0m01:01:34.344931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a781b47-e3aa-4019-89bc-c2d63cf59d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622fe10>]}
[0m01:01:34.374187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a781b47-e3aa-4019-89bc-c2d63cf59d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b3bd0>]}
[0m01:01:34.375326 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:01:34.427294 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:01:34.484443 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: intermediate/int_schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |     - name: deal_new_value
    28 |       description: New value after the deal change. Can represent different types of updates depending on deal_updated_field_key i.e. timestamp of deal creation (add_time), user assigned to the deal (user_id), stage ID (maps to stages table), lost reason ID (maps to stg_lost_reasons table)
    29 |     - name: stage_name
    30 |       description: Stage name for stage_id changes. Examples: Lead Generation, Qualified Lead, Needs Assessment, etc.
    31 |     - name: lost_reason_name
    32 |       description: Name of the lost reason. Examples are Customer Not Ready, Pricing Issue, Unreachable Customer, etc. Used for reporting and display purposes.
    33 |     - name: dwh_creation_timestamp
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 30, column 61
[0m01:01:34.486237 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.30501553, "process_in_blocks": "0", "process_kernel_time": 0.176821, "process_mem_max_rss": "116162560", "process_out_blocks": "0", "process_user_time": 0.851309}
[0m01:01:34.486493 [debug] [MainThread]: Command `dbt build` failed at 01:01:34.486443 after 0.31 seconds
[0m01:01:34.486687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111033d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111033b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110e24e0>]}
[0m01:01:34.486860 [debug] [MainThread]: Flushing usage events
[0m01:01:38.044914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:06.773985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128037b10>]}


============================== 01:02:06.777420 | 89c9d356-8919-42a1-8d18-73ced10df6a4 ==============================
[0m01:02:06.777420 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:02:06.777738 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt build -s tag:intermediate -f', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'empty': 'False', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None'}
[0m01:02:06.902180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89c9d356-8919-42a1-8d18-73ced10df6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662fe10>]}
[0m01:02:06.931213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89c9d356-8919-42a1-8d18-73ced10df6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db3bd0>]}
[0m01:02:06.931853 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:06.986206 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:02:07.103578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m01:02:07.104026 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_activity.sql
[0m01:02:07.104207 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_deal_changes.sql
[0m01:02:07.104421 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_schema.yml
[0m01:02:07.104714 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_schema.yml
[0m01:02:07.352462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89c9d356-8919-42a1-8d18-73ced10df6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ed1350>]}
[0m01:02:07.398176 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:02:07.400307 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:02:07.424590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89c9d356-8919-42a1-8d18-73ced10df6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129073c50>]}
[0m01:02:07.424865 [info ] [MainThread]: Found 9 models, 27 data tests, 6 sources, 434 macros
[0m01:02:07.426028 [info ] [MainThread]: 
[0m01:02:07.426210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:07.426350 [info ] [MainThread]: 
[0m01:02:07.426578 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:07.428385 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:02:07.476461 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:07.476710 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:07.476846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:07.846566 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.370 seconds
[0m01:02:07.847530 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:07.848663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m01:02:07.852398 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:02:07.852695 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:02:07.852838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:07.875534 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m01:02:07.875812 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:02:07.875973 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:02:07.896202 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m01:02:07.897216 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:02:07.897958 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:02:07.901501 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:07.901730 [debug] [MainThread]: On master: BEGIN
[0m01:02:07.901864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:07.920916 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m01:02:07.921336 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:07.921579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:07.932107 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m01:02:07.933386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c9d356-8919-42a1-8d18-73ced10df6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128610d70>]}
[0m01:02:07.933868 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:07.934799 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:07.934987 [debug] [MainThread]: On master: BEGIN
[0m01:02:07.935990 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:02:07.936141 [debug] [MainThread]: On master: COMMIT
[0m01:02:07.936273 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:07.936389 [debug] [MainThread]: On master: COMMIT
[0m01:02:07.936849 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:07.937007 [debug] [MainThread]: On master: Close
[0m01:02:07.941555 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity
[0m01:02:07.942444 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_analytics.int_activity ..... [RUN]
[0m01:02:07.943089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.int_activity)
[0m01:02:07.943891 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity
[0m01:02:07.953566 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity"
[0m01:02:07.954749 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activity
[0m01:02:07.992159 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activity"
[0m01:02:07.992880 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:07.993062 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: BEGIN
[0m01:02:07.993218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:08.018345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m01:02:08.018641 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:08.018850 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_activity"
  
  
    as
  
  (
    

-- Intermediate model that enriches activities with descriptive user and activity type information. 
-- Keeps 1 row per activity_id (deduped in stg_activity).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_activity"
),

user_enriched AS (
    SELECT
        b.activity_id
        , b.deal_id
        , b.user_id
        , u.user_name
        , u.user_email
        , b.activity_type_short
        , b.is_activity_done_status
        , b.activity_due_timestamp
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_users" u
      ON b.user_id = u.user_id
),

activity_type_enriched AS (
    SELECT
        ue.*
        , at.activity_type_name,
        , at.is_activity_type_active
    FROM user_enriched ue
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_activity_types" at
      ON ue.activity_type_short = at.activity_type_short
)

SELECT *
FROM activity_type_enriched


  );
  
  
[0m01:02:08.020120 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 44:         , at.is_activity_type_active
                 ^

[0m01:02:08.020360 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: ROLLBACK
[0m01:02:08.020976 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: Close
[0m01:02:08.029985 [debug] [Thread-1 (]: Database Error in model int_activity (models/intermediate/int_activity.sql)
  syntax error at or near ","
  LINE 44:         , at.is_activity_type_active
                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_activity.sql
[0m01:02:08.031266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c9d356-8919-42a1-8d18-73ced10df6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1297b24e0>]}
[0m01:02:08.031655 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model public_pipedrive_analytics.int_activity  [[31mERROR[0m in 0.09s]
[0m01:02:08.031971 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity
[0m01:02:08.032165 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes
[0m01:02:08.032407 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.int_activity' to be skipped because of status 'error'.  Reason: Database Error in model int_activity (models/intermediate/int_activity.sql)
  syntax error at or near ","
  LINE 44:         , at.is_activity_type_active
                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_activity.sql.
[0m01:02:08.032643 [info ] [Thread-1 (]: 2 of 7 START sql incremental model public_pipedrive_analytics.int_deal_changes . [RUN]
[0m01:02:08.033144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity, now model.enpal_assessment_project.int_deal_changes)
[0m01:02:08.033400 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes
[0m01:02:08.036172 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes"
[0m01:02:08.036758 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes
[0m01:02:08.038782 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes"
[0m01:02:08.039446 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:02:08.039830 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: BEGIN
[0m01:02:08.040108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:08.073652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m01:02:08.074233 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:02:08.074981 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_changes"
  
  
    as
  
  (
    

-- Intermediate model that enriches deal changes with descriptive fields such as stage name or lost reason name. 
-- Keeps 1 row per deal change (normalized, auditable history).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_deal_changes"
),

-- Bring in stage names when the change refers to stage_id
stage_enriched AS (
    SELECT
        b.deal_id_sk
        , b.deal_id,
        , b.deal_change_timestamp
        , b.deal_updated_field_key
        , b.deal_new_value
        , s.stage_name
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_stages" s
      ON b.deal_updated_field_key = 'stage_id'
     AND b.deal_new_value = CAST(s.stage_id AS TEXT)
),

-- Bring in lost reason names when the change refers to lost_reason
lost_reason_enriched AS (
    SELECT
        se.*
        , lr.lost_reason_name
    FROM stage_enriched se
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_lost_reasons" lr
      ON se.deal_updated_field_key = 'lost_reason'
     AND se.deal_new_value = CAST(lr.lost_reason_id AS TEXT)
),

final AS (
    SELECT
        deal_id_sk
        , deal_id
        , deal_change_timestamp
        , deal_updated_field_key
        , deal_new_value
        , stage_name
        , lost_reason_name
        , dwh_creation_timestamp
        , dwh_modified_timestamp
    FROM lost_reason_enriched
)

SELECT *
FROM final


  );
  
  
[0m01:02:08.077161 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 28:         , b.deal_change_timestamp
                 ^

[0m01:02:08.077536 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: ROLLBACK
[0m01:02:08.079486 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: Close
[0m01:02:08.084579 [debug] [Thread-1 (]: Database Error in model int_deal_changes (models/intermediate/int_deal_changes.sql)
  syntax error at or near ","
  LINE 28:         , b.deal_change_timestamp
                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes.sql
[0m01:02:08.085378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c9d356-8919-42a1-8d18-73ced10df6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129361250>]}
[0m01:02:08.085977 [error] [Thread-1 (]: 2 of 7 ERROR creating sql incremental model public_pipedrive_analytics.int_deal_changes  [[31mERROR[0m in 0.05s]
[0m01:02:08.086874 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes
[0m01:02:08.087671 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:08.088346 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.int_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model int_deal_changes (models/intermediate/int_deal_changes.sql)
  syntax error at or near ","
  LINE 28:         , b.deal_change_timestamp
                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes.sql.
[0m01:02:08.088084 [info ] [Thread-1 (]: 3 of 7 SKIP test not_null_int_activity_activity_id ............................. [[33mSKIP[0m]
[0m01:02:08.088783 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:08.089004 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:08.089171 [info ] [Thread-1 (]: 4 of 7 SKIP test unique_int_activity_activity_id ............................... [[33mSKIP[0m]
[0m01:02:08.089334 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f' to be skipped because of status 'skipped'. 
[0m01:02:08.089512 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:08.089747 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:02:08.089914 [info ] [Thread-1 (]: 5 of 7 SKIP test not_null_int_deal_changes_deal_id ............................. [[33mSKIP[0m]
[0m01:02:08.090086 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:02:08.090243 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:02:08.090371 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e' to be skipped because of status 'skipped'. 
[0m01:02:08.090684 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1' to be skipped because of status 'skipped'. 
[0m01:02:08.090545 [info ] [Thread-1 (]: 6 of 7 SKIP test not_null_int_deal_changes_deal_id_sk .......................... [[33mSKIP[0m]
[0m01:02:08.090909 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:02:08.091060 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:02:08.091186 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813' to be skipped because of status 'skipped'. 
[0m01:02:08.091336 [info ] [Thread-1 (]: 7 of 7 SKIP test unique_int_deal_changes_deal_id_sk ............................ [[33mSKIP[0m]
[0m01:02:08.091590 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:02:08.091756 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a' to be skipped because of status 'skipped'. 
[0m01:02:08.092526 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:08.092679 [debug] [MainThread]: On master: BEGIN
[0m01:02:08.092800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:08.113171 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m01:02:08.113514 [debug] [MainThread]: On master: COMMIT
[0m01:02:08.113811 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:08.113984 [debug] [MainThread]: On master: COMMIT
[0m01:02:08.115542 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:02:08.115741 [debug] [MainThread]: On master: Close
[0m01:02:08.115982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:08.116145 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_deal_changes' was properly closed.
[0m01:02:08.116339 [info ] [MainThread]: 
[0m01:02:08.116500 [info ] [MainThread]: Finished running 2 incremental models, 5 data tests in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m01:02:08.116967 [debug] [MainThread]: Command end result
[0m01:02:08.133416 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:02:08.134736 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:02:08.140272 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m01:02:08.140513 [info ] [MainThread]: 
[0m01:02:08.140702 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:02:08.140849 [info ] [MainThread]: 
[0m01:02:08.141038 [error] [MainThread]: [31mFailure in model int_activity (models/intermediate/int_activity.sql)[0m
[0m01:02:08.141212 [error] [MainThread]:   Database Error in model int_activity (models/intermediate/int_activity.sql)
  syntax error at or near ","
  LINE 44:         , at.is_activity_type_active
                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_activity.sql
[0m01:02:08.141335 [info ] [MainThread]: 
[0m01:02:08.141586 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/intermediate/int_activity.sql
[0m01:02:08.141811 [info ] [MainThread]: 
[0m01:02:08.141979 [error] [MainThread]: [31mFailure in model int_deal_changes (models/intermediate/int_deal_changes.sql)[0m
[0m01:02:08.142148 [error] [MainThread]:   Database Error in model int_deal_changes (models/intermediate/int_deal_changes.sql)
  syntax error at or near ","
  LINE 28:         , b.deal_change_timestamp
                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes.sql
[0m01:02:08.142273 [info ] [MainThread]: 
[0m01:02:08.142416 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/intermediate/int_deal_changes.sql
[0m01:02:08.142535 [info ] [MainThread]: 
[0m01:02:08.142673 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=5 NO-OP=0 TOTAL=7
[0m01:02:08.144437 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4179451, "process_in_blocks": "0", "process_kernel_time": 0.262865, "process_mem_max_rss": "131383296", "process_out_blocks": "0", "process_user_time": 1.364709}
[0m01:02:08.144644 [debug] [MainThread]: Command `dbt build` failed at 01:02:08.144604 after 1.42 seconds
[0m01:02:08.144822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1296bb540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1297736b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129773570>]}
[0m01:02:08.144987 [debug] [MainThread]: Flushing usage events
[0m01:02:09.777798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:23.023760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e30050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c7b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c7bb10>]}


============================== 01:02:23.027035 | 84d2937c-28de-48de-ac2d-51af8c2b92d8 ==============================
[0m01:02:23.027035 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:02:23.027367 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt build -s tag:intermediate -f', 'printer_width': '80', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'False', 'warn_error': 'None', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default'}
[0m01:02:23.132074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84d2937c-28de-48de-ac2d-51af8c2b92d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f7be10>]}
[0m01:02:23.160394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84d2937c-28de-48de-ac2d-51af8c2b92d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afbbd0>]}
[0m01:02:23.161247 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:23.212014 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:02:23.287985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:02:23.288428 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/int_activity.sql
[0m01:02:23.522828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84d2937c-28de-48de-ac2d-51af8c2b92d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b20150>]}
[0m01:02:23.566623 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:02:23.567946 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:02:23.592214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84d2937c-28de-48de-ac2d-51af8c2b92d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5f890>]}
[0m01:02:23.592542 [info ] [MainThread]: Found 9 models, 27 data tests, 6 sources, 434 macros
[0m01:02:23.593855 [info ] [MainThread]: 
[0m01:02:23.594038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:23.594170 [info ] [MainThread]: 
[0m01:02:23.594423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:23.596336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:02:23.651967 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:23.652223 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:23.652368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:23.725080 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.073 seconds
[0m01:02:23.726077 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:23.727169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m01:02:23.730928 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:02:23.731193 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:02:23.731347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:23.748366 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m01:02:23.748607 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:02:23.748768 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:02:23.753038 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m01:02:23.753949 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:02:23.754600 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:02:23.758134 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:23.758363 [debug] [MainThread]: On master: BEGIN
[0m01:02:23.758509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:23.775166 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m01:02:23.775435 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:23.775656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:23.778708 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:02:23.779858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84d2937c-28de-48de-ac2d-51af8c2b92d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5d8d0>]}
[0m01:02:23.780143 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:23.780746 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:23.780899 [debug] [MainThread]: On master: BEGIN
[0m01:02:23.782053 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:02:23.782218 [debug] [MainThread]: On master: COMMIT
[0m01:02:23.782360 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:23.782497 [debug] [MainThread]: On master: COMMIT
[0m01:02:23.782973 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:23.783116 [debug] [MainThread]: On master: Close
[0m01:02:23.784868 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity
[0m01:02:23.785201 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_analytics.int_activity ..... [RUN]
[0m01:02:23.785462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.int_activity)
[0m01:02:23.785652 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity
[0m01:02:23.790846 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity"
[0m01:02:23.791435 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activity
[0m01:02:23.820116 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activity"
[0m01:02:23.820725 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:23.820900 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: BEGIN
[0m01:02:23.821057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:23.839636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:02:23.839919 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:23.840125 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_activity"
  
  
    as
  
  (
    

-- Intermediate model that enriches activities with descriptive user and activity type information. 
-- Keeps 1 row per activity_id (deduped in stg_activity).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_activity"
),

user_enriched AS (
    SELECT
        b.activity_id
        , b.deal_id
        , b.user_id
        , u.user_name
        , u.user_email
        , b.activity_type_short
        , b.is_activity_done_status
        , b.activity_due_timestamp
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_users" u
      ON b.user_id = u.user_id
),

activity_type_enriched AS (
    SELECT
        ue.*
        , at.activity_type_name
        , at.is_activity_type_active
    FROM user_enriched ue
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_activity_types" at
      ON ue.activity_type_short = at.activity_type_short
)

SELECT *
FROM activity_type_enriched


  );
  
  
[0m01:02:23.897911 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.057 seconds
[0m01:02:23.910315 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m01:02:23.910611 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:23.910835 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m01:02:23.915490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m01:02:23.916741 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: Close
[0m01:02:23.918184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d2937c-28de-48de-ac2d-51af8c2b92d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106286a90>]}
[0m01:02:23.918670 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model public_pipedrive_analytics.int_activity  [[32mSELECT 4568[0m in 0.13s]
[0m01:02:23.919050 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity
[0m01:02:23.919313 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes
[0m01:02:23.919679 [info ] [Thread-1 (]: 2 of 7 START sql incremental model public_pipedrive_analytics.int_deal_changes . [RUN]
[0m01:02:23.920061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity, now model.enpal_assessment_project.int_deal_changes)
[0m01:02:23.920283 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes
[0m01:02:23.923103 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes"
[0m01:02:23.923617 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes
[0m01:02:23.925986 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes"
[0m01:02:23.926540 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:02:23.926740 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: BEGIN
[0m01:02:23.926924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:23.949990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m01:02:23.950308 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:02:23.950561 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_changes"
  
  
    as
  
  (
    

-- Intermediate model that enriches deal changes with descriptive fields such as stage name or lost reason name. 
-- Keeps 1 row per deal change (normalized, auditable history).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_deal_changes"
),

-- Bring in stage names when the change refers to stage_id
stage_enriched AS (
    SELECT
        b.deal_id_sk
        , b.deal_id,
        , b.deal_change_timestamp
        , b.deal_updated_field_key
        , b.deal_new_value
        , s.stage_name
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_stages" s
      ON b.deal_updated_field_key = 'stage_id'
     AND b.deal_new_value = CAST(s.stage_id AS TEXT)
),

-- Bring in lost reason names when the change refers to lost_reason
lost_reason_enriched AS (
    SELECT
        se.*
        , lr.lost_reason_name
    FROM stage_enriched se
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_lost_reasons" lr
      ON se.deal_updated_field_key = 'lost_reason'
     AND se.deal_new_value = CAST(lr.lost_reason_id AS TEXT)
),

final AS (
    SELECT
        deal_id_sk
        , deal_id
        , deal_change_timestamp
        , deal_updated_field_key
        , deal_new_value
        , stage_name
        , lost_reason_name
        , dwh_creation_timestamp
        , dwh_modified_timestamp
    FROM lost_reason_enriched
)

SELECT *
FROM final


  );
  
  
[0m01:02:23.951410 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 28:         , b.deal_change_timestamp
                 ^

[0m01:02:23.951659 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: ROLLBACK
[0m01:02:23.952305 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: Close
[0m01:02:23.960861 [debug] [Thread-1 (]: Database Error in model int_deal_changes (models/intermediate/int_deal_changes.sql)
  syntax error at or near ","
  LINE 28:         , b.deal_change_timestamp
                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes.sql
[0m01:02:23.961180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d2937c-28de-48de-ac2d-51af8c2b92d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e44b90>]}
[0m01:02:23.961522 [error] [Thread-1 (]: 2 of 7 ERROR creating sql incremental model public_pipedrive_analytics.int_deal_changes  [[31mERROR[0m in 0.04s]
[0m01:02:23.961813 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes
[0m01:02:23.962010 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:23.962258 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.int_deal_changes' to be skipped because of status 'error'.  Reason: Database Error in model int_deal_changes (models/intermediate/int_deal_changes.sql)
  syntax error at or near ","
  LINE 28:         , b.deal_change_timestamp
                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes.sql.
[0m01:02:23.962461 [info ] [Thread-1 (]: 3 of 7 START test not_null_int_activity_activity_id ............................ [RUN]
[0m01:02:23.962941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes, now test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f)
[0m01:02:23.963111 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:23.969813 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:02:23.970819 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:23.980293 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:02:23.981180 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:02:23.981372 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: BEGIN
[0m01:02:23.981528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:23.998450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:02:23.998719 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:02:23.998907 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m01:02:24.001577 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:02:24.003463 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: ROLLBACK
[0m01:02:24.004025 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: Close
[0m01:02:24.004371 [info ] [Thread-1 (]: 3 of 7 PASS not_null_int_activity_activity_id .................................. [[32mPASS[0m in 0.04s]
[0m01:02:24.004662 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:24.004854 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:24.005058 [info ] [Thread-1 (]: 4 of 7 START test unique_int_activity_activity_id .............................. [RUN]
[0m01:02:24.005254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f, now test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e)
[0m01:02:24.005418 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:24.008745 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:02:24.009458 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:24.010555 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:02:24.010939 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:02:24.011109 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: BEGIN
[0m01:02:24.011271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:24.029777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m01:02:24.030088 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:02:24.030286 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:24.032952 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:02:24.033926 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: ROLLBACK
[0m01:02:24.034582 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: Close
[0m01:02:24.034944 [info ] [Thread-1 (]: 4 of 7 PASS unique_int_activity_activity_id .................................... [[32mPASS[0m in 0.03s]
[0m01:02:24.035244 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:24.035446 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:02:24.035680 [info ] [Thread-1 (]: 5 of 7 SKIP test not_null_int_deal_changes_deal_id ............................. [[33mSKIP[0m]
[0m01:02:24.035883 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:02:24.036064 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:02:24.036390 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1' to be skipped because of status 'skipped'. 
[0m01:02:24.036241 [info ] [Thread-1 (]: 6 of 7 SKIP test not_null_int_deal_changes_deal_id_sk .......................... [[33mSKIP[0m]
[0m01:02:24.036721 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:02:24.036896 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:02:24.037054 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813' to be skipped because of status 'skipped'. 
[0m01:02:24.037262 [info ] [Thread-1 (]: 7 of 7 SKIP test unique_int_deal_changes_deal_id_sk ............................ [[33mSKIP[0m]
[0m01:02:24.037520 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:02:24.037690 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a' to be skipped because of status 'skipped'. 
[0m01:02:24.038282 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:24.038442 [debug] [MainThread]: On master: BEGIN
[0m01:02:24.038573 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:24.055444 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m01:02:24.055698 [debug] [MainThread]: On master: COMMIT
[0m01:02:24.055842 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:24.055965 [debug] [MainThread]: On master: COMMIT
[0m01:02:24.056514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:24.056705 [debug] [MainThread]: On master: Close
[0m01:02:24.056983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:24.057253 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e' was properly closed.
[0m01:02:24.057438 [info ] [MainThread]: 
[0m01:02:24.057600 [info ] [MainThread]: Finished running 2 incremental models, 5 data tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m01:02:24.058130 [debug] [MainThread]: Command end result
[0m01:02:24.075809 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:02:24.077046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:02:24.080137 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m01:02:24.080303 [info ] [MainThread]: 
[0m01:02:24.080478 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:02:24.080623 [info ] [MainThread]: 
[0m01:02:24.080801 [error] [MainThread]: [31mFailure in model int_deal_changes (models/intermediate/int_deal_changes.sql)[0m
[0m01:02:24.080971 [error] [MainThread]:   Database Error in model int_deal_changes (models/intermediate/int_deal_changes.sql)
  syntax error at or near ","
  LINE 28:         , b.deal_change_timestamp
                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes.sql
[0m01:02:24.081092 [info ] [MainThread]: 
[0m01:02:24.081245 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/intermediate/int_deal_changes.sql
[0m01:02:24.081369 [info ] [MainThread]: 
[0m01:02:24.081506 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=7
[0m01:02:24.084201 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1023781, "process_in_blocks": "0", "process_kernel_time": 0.239877, "process_mem_max_rss": "134053888", "process_out_blocks": "0", "process_user_time": 1.342236}
[0m01:02:24.084490 [debug] [MainThread]: Command `dbt build` failed at 01:02:24.084446 after 1.10 seconds
[0m01:02:24.084680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618bd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062528f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106252b70>]}
[0m01:02:24.084858 [debug] [MainThread]: Flushing usage events
[0m01:02:25.408322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:45.140375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120333b10>]}


============================== 01:02:45.144173 | 089b57a8-d810-45c9-9beb-44da3978329b ==============================
[0m01:02:45.144173 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:02:45.144577 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build -s tag:intermediate -f', 'empty': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'no_print': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'log_format': 'default'}
[0m01:02:45.255288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '089b57a8-d810-45c9-9beb-44da3978329b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732fe10>]}
[0m01:02:45.285597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '089b57a8-d810-45c9-9beb-44da3978329b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200b3bd0>]}
[0m01:02:45.286373 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:45.336990 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:02:45.415650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:02:45.416107 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/int_deal_changes.sql
[0m01:02:45.649206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '089b57a8-d810-45c9-9beb-44da3978329b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12183d050>]}
[0m01:02:45.696345 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:02:45.697779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:02:45.720949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '089b57a8-d810-45c9-9beb-44da3978329b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12187f890>]}
[0m01:02:45.721246 [info ] [MainThread]: Found 9 models, 27 data tests, 6 sources, 434 macros
[0m01:02:45.722444 [info ] [MainThread]: 
[0m01:02:45.722615 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:45.722744 [info ] [MainThread]: 
[0m01:02:45.722976 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:45.724875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:02:45.785775 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:45.786046 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:45.786194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:45.839417 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.053 seconds
[0m01:02:45.840465 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:45.841651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m01:02:45.845108 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:02:45.845317 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:02:45.845458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:45.862634 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m01:02:45.862991 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:02:45.863188 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:02:45.868301 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m01:02:45.869224 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:02:45.870288 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:02:45.873796 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:45.874019 [debug] [MainThread]: On master: BEGIN
[0m01:02:45.874156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:45.891001 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m01:02:45.891267 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:45.891489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:45.894223 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:02:45.895391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '089b57a8-d810-45c9-9beb-44da3978329b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120317690>]}
[0m01:02:45.895758 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:45.896524 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:45.896710 [debug] [MainThread]: On master: BEGIN
[0m01:02:45.897929 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:02:45.898111 [debug] [MainThread]: On master: COMMIT
[0m01:02:45.898259 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:45.898394 [debug] [MainThread]: On master: COMMIT
[0m01:02:45.899014 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:45.899160 [debug] [MainThread]: On master: Close
[0m01:02:45.900745 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity
[0m01:02:45.901053 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_analytics.int_activity ..... [RUN]
[0m01:02:45.901285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.int_activity)
[0m01:02:45.901460 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity
[0m01:02:45.907066 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity"
[0m01:02:45.907754 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activity
[0m01:02:45.936046 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activity"
[0m01:02:45.936631 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:45.936803 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: BEGIN
[0m01:02:45.936949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:45.956847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:02:45.957126 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:45.957343 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp"
  
  
    as
  
  (
    

-- Intermediate model that enriches activities with descriptive user and activity type information. 
-- Keeps 1 row per activity_id (deduped in stg_activity).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_activity"
),

user_enriched AS (
    SELECT
        b.activity_id
        , b.deal_id
        , b.user_id
        , u.user_name
        , u.user_email
        , b.activity_type_short
        , b.is_activity_done_status
        , b.activity_due_timestamp
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_users" u
      ON b.user_id = u.user_id
),

activity_type_enriched AS (
    SELECT
        ue.*
        , at.activity_type_name
        , at.is_activity_type_active
    FROM user_enriched ue
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_activity_types" at
      ON ue.activity_type_short = at.activity_type_short
)

SELECT *
FROM activity_type_enriched


  );
  
  
[0m01:02:45.982302 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.025 seconds
[0m01:02:45.988791 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:45.989050 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity" rename to "int_activity__dbt_backup"
[0m01:02:45.991204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:02:45.992911 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:45.993135 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp" rename to "int_activity"
[0m01:02:45.994425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:46.003883 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m01:02:46.004112 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:46.004283 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m01:02:46.007532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:02:46.011174 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup"
[0m01:02:46.013647 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:02:46.013851 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup" cascade
[0m01:02:46.022019 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m01:02:46.023512 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: Close
[0m01:02:46.024777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089b57a8-d810-45c9-9beb-44da3978329b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122180600>]}
[0m01:02:46.025172 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model public_pipedrive_analytics.int_activity  [[32mSELECT 4568[0m in 0.12s]
[0m01:02:46.025488 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity
[0m01:02:46.025699 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes
[0m01:02:46.026039 [info ] [Thread-1 (]: 2 of 7 START sql incremental model public_pipedrive_analytics.int_deal_changes . [RUN]
[0m01:02:46.026273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity, now model.enpal_assessment_project.int_deal_changes)
[0m01:02:46.026458 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes
[0m01:02:46.028868 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes"
[0m01:02:46.029394 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes
[0m01:02:46.031826 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes"
[0m01:02:46.032389 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:02:46.032587 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: BEGIN
[0m01:02:46.032754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.049897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:02:46.050190 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:02:46.050424 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_changes"
  
  
    as
  
  (
    

-- Intermediate model that enriches deal changes with descriptive fields such as stage name or lost reason name. 
-- Keeps 1 row per deal change (normalized, auditable history).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_deal_changes"
),

-- Bring in stage names when the change refers to stage_id
stage_enriched AS (
    SELECT
        b.deal_id_sk
        , b.deal_id
        , b.deal_change_timestamp
        , b.deal_updated_field_key
        , b.deal_new_value
        , s.stage_name
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_stages" s
      ON b.deal_updated_field_key = 'stage_id'
     AND b.deal_new_value = CAST(s.stage_id AS TEXT)
),

-- Bring in lost reason names when the change refers to lost_reason
lost_reason_enriched AS (
    SELECT
        se.*
        , lr.lost_reason_name
    FROM stage_enriched se
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_lost_reasons" lr
      ON se.deal_updated_field_key = 'lost_reason'
     AND se.deal_new_value = CAST(lr.lost_reason_id AS TEXT)
),

final AS (
    SELECT
        deal_id_sk
        , deal_id
        , deal_change_timestamp
        , deal_updated_field_key
        , deal_new_value
        , stage_name
        , lost_reason_name
        , dwh_creation_timestamp
        , dwh_modified_timestamp
    FROM lost_reason_enriched
)

SELECT *
FROM final


  );
  
  
[0m01:02:46.100644 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.050 seconds
[0m01:02:46.101707 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m01:02:46.101923 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:02:46.102104 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m01:02:46.124123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m01:02:46.124598 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: Close
[0m01:02:46.124915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089b57a8-d810-45c9-9beb-44da3978329b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d51310>]}
[0m01:02:46.125246 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model public_pipedrive_analytics.int_deal_changes  [[32mSELECT 15406[0m in 0.10s]
[0m01:02:46.125518 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes
[0m01:02:46.125708 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:46.125924 [info ] [Thread-1 (]: 3 of 7 START test not_null_int_activity_activity_id ............................ [RUN]
[0m01:02:46.126225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes, now test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f)
[0m01:02:46.126429 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:46.132762 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:02:46.133362 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:46.144155 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:02:46.144869 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:02:46.145081 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: BEGIN
[0m01:02:46.145275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.170220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m01:02:46.170514 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:02:46.170710 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.172205 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:02:46.174652 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: ROLLBACK
[0m01:02:46.175634 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: Close
[0m01:02:46.176035 [info ] [Thread-1 (]: 3 of 7 PASS not_null_int_activity_activity_id .................................. [[32mPASS[0m in 0.05s]
[0m01:02:46.176346 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:02:46.176543 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:46.176722 [info ] [Thread-1 (]: 4 of 7 START test unique_int_activity_activity_id .............................. [RUN]
[0m01:02:46.176934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f, now test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e)
[0m01:02:46.177157 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:46.180635 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:02:46.181162 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:46.182306 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:02:46.182815 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:02:46.182981 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: BEGIN
[0m01:02:46.183125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.200359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:02:46.200981 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:02:46.201192 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:46.203946 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:02:46.204929 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: ROLLBACK
[0m01:02:46.205550 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: Close
[0m01:02:46.205893 [info ] [Thread-1 (]: 4 of 7 PASS unique_int_activity_activity_id .................................... [[32mPASS[0m in 0.03s]
[0m01:02:46.206171 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:02:46.206357 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:02:46.206547 [info ] [Thread-1 (]: 5 of 7 START test not_null_int_deal_changes_deal_id ............................ [RUN]
[0m01:02:46.206738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1)
[0m01:02:46.206908 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:02:46.209134 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:02:46.209772 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:02:46.210918 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:02:46.211320 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:02:46.211653 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: BEGIN
[0m01:02:46.211809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.230426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:02:46.230732 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:02:46.230925 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.233405 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:02:46.234331 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: ROLLBACK
[0m01:02:46.235285 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: Close
[0m01:02:46.235629 [info ] [Thread-1 (]: 5 of 7 PASS not_null_int_deal_changes_deal_id .................................. [[32mPASS[0m in 0.03s]
[0m01:02:46.235981 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:02:46.236173 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:02:46.236381 [info ] [Thread-1 (]: 6 of 7 START test not_null_int_deal_changes_deal_id_sk ......................... [RUN]
[0m01:02:46.236612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813)
[0m01:02:46.236849 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:02:46.239939 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:02:46.240562 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:02:46.241790 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:02:46.242244 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:02:46.242413 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: BEGIN
[0m01:02:46.242568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.262066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:02:46.262352 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:02:46.262544 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m01:02:46.264782 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:02:46.265741 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: ROLLBACK
[0m01:02:46.266356 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: Close
[0m01:02:46.266704 [info ] [Thread-1 (]: 6 of 7 PASS not_null_int_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.03s]
[0m01:02:46.266996 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:02:46.267195 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:02:46.267399 [info ] [Thread-1 (]: 7 of 7 START test unique_int_deal_changes_deal_id_sk ........................... [RUN]
[0m01:02:46.267603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813, now test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a)
[0m01:02:46.267771 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:02:46.270066 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:02:46.270636 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:02:46.272136 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:02:46.272582 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:02:46.272749 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: BEGIN
[0m01:02:46.272902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:46.293088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:02:46.293378 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:02:46.293573 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:02:46.300070 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m01:02:46.301075 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: ROLLBACK
[0m01:02:46.301741 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: Close
[0m01:02:46.302110 [info ] [Thread-1 (]: 7 of 7 PASS unique_int_deal_changes_deal_id_sk ................................. [[32mPASS[0m in 0.03s]
[0m01:02:46.302403 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:02:46.303159 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:46.303373 [debug] [MainThread]: On master: BEGIN
[0m01:02:46.303531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:46.320623 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m01:02:46.320899 [debug] [MainThread]: On master: COMMIT
[0m01:02:46.321062 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:46.321201 [debug] [MainThread]: On master: COMMIT
[0m01:02:46.321942 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:02:46.322073 [debug] [MainThread]: On master: Close
[0m01:02:46.322288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:46.322408 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a' was properly closed.
[0m01:02:46.322578 [info ] [MainThread]: 
[0m01:02:46.322727 [info ] [MainThread]: Finished running 2 incremental models, 5 data tests in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m01:02:46.323380 [debug] [MainThread]: Command end result
[0m01:02:46.341681 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:02:46.342959 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:02:46.346203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m01:02:46.346370 [info ] [MainThread]: 
[0m01:02:46.346540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:46.346710 [info ] [MainThread]: 
[0m01:02:46.346854 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m01:02:46.348720 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2522982, "process_in_blocks": "0", "process_kernel_time": 0.259678, "process_mem_max_rss": "136364032", "process_out_blocks": "0", "process_user_time": 1.409252}
[0m01:02:46.349013 [debug] [MainThread]: Command `dbt build` succeeded at 01:02:46.348963 after 1.25 seconds
[0m01:02:46.349199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220a3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220b23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220b0050>]}
[0m01:02:46.349380 [debug] [MainThread]: Flushing usage events
[0m01:02:48.008836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:17.212285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d50050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9fb10>]}


============================== 01:54:17.215982 | 3c64682a-8863-476a-93d4-d5b2dae39e39 ==============================
[0m01:54:17.215982 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:54:17.216331 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt build -s tag:intermediate -f', 'introspect': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'fail_fast': 'False', 'no_print': 'None', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'warn_error': 'None', 'version_check': 'True', 'empty': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True', 'partial_parse': 'True'}
[0m01:54:17.329680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c64682a-8863-476a-93d4-d5b2dae39e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e97e10>]}
[0m01:54:17.358007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c64682a-8863-476a-93d4-d5b2dae39e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1bbd0>]}
[0m01:54:17.358553 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:54:17.410609 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:54:17.499105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:54:17.499885 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/reporting/rep_sales_funnel_monthly.sql
[0m01:54:17.500267 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/reporting/rep_schema.yml
[0m01:54:17.709683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c64682a-8863-476a-93d4-d5b2dae39e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e3c50>]}
[0m01:54:17.755747 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:54:17.757499 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:54:17.783364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c64682a-8863-476a-93d4-d5b2dae39e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b994f0>]}
[0m01:54:17.783685 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m01:54:17.784991 [info ] [MainThread]: 
[0m01:54:17.785180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:17.785313 [info ] [MainThread]: 
[0m01:54:17.785559 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:54:17.787487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:54:17.839827 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:54:17.840068 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:54:17.840207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:18.312653 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.472 seconds
[0m01:54:18.313800 [debug] [ThreadPool]: On list_postgres: Close
[0m01:54:18.315345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m01:54:18.320981 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:54:18.321326 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:54:18.321498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:18.361483 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m01:54:18.361909 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:54:18.362162 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:54:18.372747 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m01:54:18.373766 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:54:18.375182 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:54:18.379454 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:18.379790 [debug] [MainThread]: On master: BEGIN
[0m01:54:18.380028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:18.399814 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m01:54:18.400068 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:18.400260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:54:18.405086 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:54:18.406235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c64682a-8863-476a-93d4-d5b2dae39e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107067a10>]}
[0m01:54:18.406511 [debug] [MainThread]: On master: ROLLBACK
[0m01:54:18.407075 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:18.407266 [debug] [MainThread]: On master: BEGIN
[0m01:54:18.408181 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:54:18.408360 [debug] [MainThread]: On master: COMMIT
[0m01:54:18.408509 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:18.408649 [debug] [MainThread]: On master: COMMIT
[0m01:54:18.409189 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:54:18.409345 [debug] [MainThread]: On master: Close
[0m01:54:18.411009 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity
[0m01:54:18.411334 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_analytics.int_activity ..... [RUN]
[0m01:54:18.411590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.int_activity)
[0m01:54:18.411781 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity
[0m01:54:18.418025 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity"
[0m01:54:18.418889 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activity
[0m01:54:18.457518 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activity"
[0m01:54:18.458551 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:18.458820 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: BEGIN
[0m01:54:18.459040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:18.482053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m01:54:18.482448 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:18.482748 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp"
  
  
    as
  
  (
    

-- Intermediate model that enriches activities with descriptive user and activity type information. 
-- Keeps 1 row per activity_id (deduped in stg_activity).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_activity"
),

user_enriched AS (
    SELECT
        b.activity_id
        , b.deal_id
        , b.user_id
        , u.user_name
        , u.user_email
        , b.activity_type_short
        , b.is_activity_done_status
        , b.activity_due_timestamp
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_users" u
      ON b.user_id = u.user_id
),

activity_type_enriched AS (
    SELECT
        ue.*
        , at.activity_type_name
        , at.is_activity_type_active
    FROM user_enriched ue
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_activity_types" at
      ON ue.activity_type_short = at.activity_type_short
)

SELECT *
FROM activity_type_enriched


  );
  
  
[0m01:54:18.518690 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.036 seconds
[0m01:54:18.524162 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:18.524388 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity" rename to "int_activity__dbt_backup"
[0m01:54:18.525829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:18.527270 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:18.527468 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp" rename to "int_activity"
[0m01:54:18.528244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:18.538008 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m01:54:18.538315 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:18.538506 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m01:54:18.542970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m01:54:18.546726 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup"
[0m01:54:18.549547 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:18.549782 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup" cascade
[0m01:54:18.563831 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m01:54:18.565404 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: Close
[0m01:54:18.566658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c64682a-8863-476a-93d4-d5b2dae39e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802ef70>]}
[0m01:54:18.567065 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model public_pipedrive_analytics.int_activity  [[32mSELECT 4568[0m in 0.15s]
[0m01:54:18.567387 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity
[0m01:54:18.567599 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes
[0m01:54:18.567885 [info ] [Thread-1 (]: 2 of 7 START sql incremental model public_pipedrive_analytics.int_deal_changes . [RUN]
[0m01:54:18.568199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity, now model.enpal_assessment_project.int_deal_changes)
[0m01:54:18.568400 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes
[0m01:54:18.570775 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes"
[0m01:54:18.571457 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes
[0m01:54:18.573805 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes"
[0m01:54:18.574340 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:18.574539 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: BEGIN
[0m01:54:18.574723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:18.597681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m01:54:18.598019 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:18.598279 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Intermediate model that enriches deal changes with descriptive fields such as stage name or lost reason name. 
-- Keeps 1 row per deal change (normalized, auditable history).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_deal_changes"
),

-- Bring in stage names when the change refers to stage_id
stage_enriched AS (
    SELECT
        b.deal_id_sk
        , b.deal_id
        , b.deal_change_timestamp
        , b.deal_updated_field_key
        , b.deal_new_value
        , s.stage_name
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_stages" s
      ON b.deal_updated_field_key = 'stage_id'
     AND b.deal_new_value = CAST(s.stage_id AS TEXT)
),

-- Bring in lost reason names when the change refers to lost_reason
lost_reason_enriched AS (
    SELECT
        se.*
        , lr.lost_reason_name
    FROM stage_enriched se
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_lost_reasons" lr
      ON se.deal_updated_field_key = 'lost_reason'
     AND se.deal_new_value = CAST(lr.lost_reason_id AS TEXT)
),

final AS (
    SELECT
        deal_id_sk
        , deal_id
        , deal_change_timestamp
        , deal_updated_field_key
        , deal_new_value
        , stage_name
        , lost_reason_name
        , dwh_creation_timestamp
        , dwh_modified_timestamp
    FROM lost_reason_enriched
)

SELECT *
FROM final


  );
  
  
[0m01:54:18.638322 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.040 seconds
[0m01:54:18.640120 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:18.640316 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes" rename to "int_deal_changes__dbt_backup"
[0m01:54:18.641203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:18.642571 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:18.642750 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_tmp" rename to "int_deal_changes"
[0m01:54:18.643483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:18.644239 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m01:54:18.644418 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:18.644573 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m01:54:18.649994 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m01:54:18.651528 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_backup"
[0m01:54:18.651896 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:18.652080 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_backup" cascade
[0m01:54:18.657979 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m01:54:18.658821 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: Close
[0m01:54:18.659147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c64682a-8863-476a-93d4-d5b2dae39e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3d0d0>]}
[0m01:54:18.659640 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model public_pipedrive_analytics.int_deal_changes  [[32mSELECT 15406[0m in 0.09s]
[0m01:54:18.660150 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes
[0m01:54:18.660399 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:54:18.660642 [info ] [Thread-1 (]: 3 of 7 START test not_null_int_activity_activity_id ............................ [RUN]
[0m01:54:18.660920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes, now test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f)
[0m01:54:18.661208 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:54:18.667914 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:54:18.668507 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:54:18.679350 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:54:18.680017 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:54:18.680229 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: BEGIN
[0m01:54:18.680404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:18.697163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:18.697478 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:54:18.697688 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:18.699330 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:18.701487 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: ROLLBACK
[0m01:54:18.702232 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: Close
[0m01:54:18.702661 [info ] [Thread-1 (]: 3 of 7 PASS not_null_int_activity_activity_id .................................. [[32mPASS[0m in 0.04s]
[0m01:54:18.703009 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:54:18.703236 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:54:18.703471 [info ] [Thread-1 (]: 4 of 7 START test unique_int_activity_activity_id .............................. [RUN]
[0m01:54:18.703704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f, now test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e)
[0m01:54:18.703899 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:54:18.707507 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:54:18.708053 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:54:18.709369 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:54:18.710064 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:54:18.710278 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: BEGIN
[0m01:54:18.710455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:18.729439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:18.729752 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:54:18.730206 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:18.734908 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:54:18.736357 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: ROLLBACK
[0m01:54:18.737249 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: Close
[0m01:54:18.737631 [info ] [Thread-1 (]: 4 of 7 PASS unique_int_activity_activity_id .................................... [[32mPASS[0m in 0.03s]
[0m01:54:18.737936 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:54:18.738143 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:54:18.738331 [info ] [Thread-1 (]: 5 of 7 START test not_null_int_deal_changes_deal_id ............................ [RUN]
[0m01:54:18.738600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1)
[0m01:54:18.738780 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:54:18.741110 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:54:18.741989 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:54:18.743337 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:54:18.743921 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:54:18.744105 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: BEGIN
[0m01:54:18.744267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:18.764159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:54:18.764450 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:54:18.764641 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:18.767999 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:54:18.768916 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: ROLLBACK
[0m01:54:18.769569 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: Close
[0m01:54:18.769919 [info ] [Thread-1 (]: 5 of 7 PASS not_null_int_deal_changes_deal_id .................................. [[32mPASS[0m in 0.03s]
[0m01:54:18.770335 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:54:18.770578 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:54:18.770843 [info ] [Thread-1 (]: 6 of 7 START test not_null_int_deal_changes_deal_id_sk ......................... [RUN]
[0m01:54:18.771137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813)
[0m01:54:18.771347 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:54:18.774306 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:54:18.775606 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:54:18.777605 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:54:18.778581 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:54:18.778907 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: BEGIN
[0m01:54:18.779083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:18.799941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m01:54:18.800228 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:54:18.800419 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m01:54:18.802446 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:54:18.803389 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: ROLLBACK
[0m01:54:18.804181 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: Close
[0m01:54:18.804566 [info ] [Thread-1 (]: 6 of 7 PASS not_null_int_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.03s]
[0m01:54:18.804887 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:54:18.805097 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:54:18.805328 [info ] [Thread-1 (]: 7 of 7 START test unique_int_deal_changes_deal_id_sk ........................... [RUN]
[0m01:54:18.805589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813, now test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a)
[0m01:54:18.805784 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:54:18.807969 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:54:18.808475 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:54:18.810016 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:54:18.810566 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:54:18.810795 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: BEGIN
[0m01:54:18.810970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:18.829319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m01:54:18.829605 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:54:18.829805 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:18.840694 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m01:54:18.841704 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: ROLLBACK
[0m01:54:18.842603 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: Close
[0m01:54:18.842979 [info ] [Thread-1 (]: 7 of 7 PASS unique_int_deal_changes_deal_id_sk ................................. [[32mPASS[0m in 0.04s]
[0m01:54:18.843268 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:54:18.844042 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:18.844257 [debug] [MainThread]: On master: BEGIN
[0m01:54:18.844409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:18.863747 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m01:54:18.864052 [debug] [MainThread]: On master: COMMIT
[0m01:54:18.864213 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:18.864344 [debug] [MainThread]: On master: COMMIT
[0m01:54:18.864981 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:54:18.865129 [debug] [MainThread]: On master: Close
[0m01:54:18.865365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:18.865493 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a' was properly closed.
[0m01:54:18.865675 [info ] [MainThread]: 
[0m01:54:18.865839 [info ] [MainThread]: Finished running 2 incremental models, 5 data tests in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m01:54:18.866513 [debug] [MainThread]: Command end result
[0m01:54:18.884217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:54:18.885382 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:54:18.888769 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m01:54:18.888939 [info ] [MainThread]: 
[0m01:54:18.889121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:54:18.889257 [info ] [MainThread]: 
[0m01:54:18.889400 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m01:54:18.891456 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7233126, "process_in_blocks": "0", "process_kernel_time": 0.293, "process_mem_max_rss": "130138112", "process_out_blocks": "0", "process_user_time": 1.425364}
[0m01:54:18.891678 [debug] [MainThread]: Command `dbt build` succeeded at 01:54:18.891636 after 1.72 seconds
[0m01:54:18.891851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f573e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809b250>]}
[0m01:54:18.892013 [debug] [MainThread]: Flushing usage events
[0m01:54:20.609742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:26.221897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c2c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a779d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a77b10>]}


============================== 01:54:26.225184 | 28488926-9660-40f7-9de2-63fe45a314c2 ==============================
[0m01:54:26.225184 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:54:26.225525 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'invocation_command': 'dbt build -s tag:staging -f', 'indirect_selection': 'eager', 'empty': 'False', 'version_check': 'True', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'introspect': 'True', 'log_format': 'default'}
[0m01:54:26.320401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d73e10>]}
[0m01:54:26.350238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f7bd0>]}
[0m01:54:26.351178 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:54:26.401583 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:54:26.480096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:54:26.480357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:54:26.504934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bf350>]}
[0m01:54:26.556586 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:54:26.558021 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:54:26.582519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105966d50>]}
[0m01:54:26.582879 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m01:54:26.584687 [info ] [MainThread]: 
[0m01:54:26.585014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:26.585171 [info ] [MainThread]: 
[0m01:54:26.585457 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:54:26.587904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:54:26.646190 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:54:26.646464 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:54:26.646616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:26.681703 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.035 seconds
[0m01:54:26.682593 [debug] [ThreadPool]: On list_postgres: Close
[0m01:54:26.683626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m01:54:26.686733 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:54:26.686968 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:54:26.687101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:26.703422 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m01:54:26.703684 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:54:26.703853 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:54:26.706254 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m01:54:26.707044 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:54:26.707539 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:54:26.711025 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:26.711229 [debug] [MainThread]: On master: BEGIN
[0m01:54:26.711368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:26.726206 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m01:54:26.726508 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:26.726745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:54:26.729489 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:54:26.730172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a37af0>]}
[0m01:54:26.730427 [debug] [MainThread]: On master: ROLLBACK
[0m01:54:26.730999 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:26.731195 [debug] [MainThread]: On master: BEGIN
[0m01:54:26.732074 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:54:26.732282 [debug] [MainThread]: On master: COMMIT
[0m01:54:26.732440 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:26.732578 [debug] [MainThread]: On master: COMMIT
[0m01:54:26.733888 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:54:26.734125 [debug] [MainThread]: On master: Close
[0m01:54:26.780898 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m01:54:26.781287 [info ] [Thread-1 (]: 1 of 29 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m01:54:26.781545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m01:54:26.781733 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m01:54:26.788476 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m01:54:26.789420 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m01:54:26.816818 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m01:54:26.817613 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:54:26.817806 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m01:54:26.817963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:26.834554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:26.834840 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:54:26.835069 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM (
        SELECT *,
               ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) AS rn
        FROM raw
    ) t
    WHERE rn = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m01:54:26.847860 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.013 seconds
[0m01:54:26.854059 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:54:26.854302 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m01:54:26.855240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:26.856775 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:54:26.856981 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m01:54:26.857685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:26.866870 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m01:54:26.867093 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:54:26.867265 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m01:54:26.870264 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:54:26.873917 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m01:54:26.876546 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:54:26.876754 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m01:54:26.881444 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:54:26.883002 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m01:54:26.884302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6fad0>]}
[0m01:54:26.884675 [info ] [Thread-1 (]: 1 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity  [[32mSELECT 4568[0m in 0.10s]
[0m01:54:26.884983 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m01:54:26.885197 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m01:54:26.885485 [info ] [Thread-1 (]: 2 of 29 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m01:54:26.885773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m01:54:26.885953 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m01:54:26.888063 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m01:54:26.888571 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m01:54:26.891028 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m01:54:26.891581 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:54:26.891775 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m01:54:26.891983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:26.909826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m01:54:26.910149 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:54:26.910366 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m01:54:26.912489 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m01:54:26.914227 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:54:26.914432 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m01:54:26.915140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:26.916528 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:54:26.916712 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m01:54:26.917321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:54:26.918078 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m01:54:26.918259 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:54:26.918417 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m01:54:26.919871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:54:26.921364 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m01:54:26.921740 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:54:26.921932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m01:54:26.923590 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:54:26.924337 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m01:54:26.924673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0bb90>]}
[0m01:54:26.925017 [info ] [Thread-1 (]: 2 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mSELECT 4[0m in 0.04s]
[0m01:54:26.925316 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m01:54:26.925521 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m01:54:26.925810 [info ] [Thread-1 (]: 3 of 29 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m01:54:26.926097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m01:54:26.926284 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m01:54:26.928545 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m01:54:26.929125 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m01:54:26.931454 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m01:54:26.932036 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:54:26.932229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m01:54:26.932397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:26.951782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:26.952080 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:54:26.952310 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m01:54:26.987087 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.034 seconds
[0m01:54:26.989024 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:54:26.989248 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m01:54:26.990119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:26.991603 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:54:26.991801 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m01:54:26.993453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:26.994684 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m01:54:26.994881 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:54:26.995052 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m01:54:26.999022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m01:54:27.000249 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m01:54:27.000619 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:54:27.000802 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m01:54:27.004761 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:54:27.005543 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m01:54:27.005858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bf8b0>]}
[0m01:54:27.006204 [info ] [Thread-1 (]: 3 of 29 OK created sql incremental model public_pipedrive_analytics.stg_deal_changes  [[32mSELECT 15406[0m in 0.08s]
[0m01:54:27.006513 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m01:54:27.006724 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m01:54:27.007003 [info ] [Thread-1 (]: 4 of 29 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m01:54:27.007321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m01:54:27.007530 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m01:54:27.009821 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m01:54:27.010377 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m01:54:27.012811 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m01:54:27.013299 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:54:27.013489 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m01:54:27.013707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.030668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.030962 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:54:27.031179 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m01:54:27.034349 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m01:54:27.036346 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:54:27.036571 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m01:54:27.037405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:27.038914 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:54:27.039111 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m01:54:27.040101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:27.041277 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m01:54:27.041472 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:54:27.041646 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m01:54:27.042670 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:54:27.043943 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup"
[0m01:54:27.044344 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:54:27.044545 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m01:54:27.046273 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:54:27.047025 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m01:54:27.047352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4eb70>]}
[0m01:54:27.047697 [info ] [Thread-1 (]: 4 of 29 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mSELECT 4[0m in 0.04s]
[0m01:54:27.047997 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m01:54:27.048203 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m01:54:27.048480 [info ] [Thread-1 (]: 5 of 29 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m01:54:27.048769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m01:54:27.048957 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m01:54:27.051189 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m01:54:27.051857 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m01:54:27.054192 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m01:54:27.054683 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:54:27.054873 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m01:54:27.055037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.073149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m01:54:27.073454 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:54:27.073674 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m01:54:27.075362 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m01:54:27.077261 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:54:27.077505 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m01:54:27.078463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:27.079982 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:54:27.080471 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m01:54:27.081170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:27.081981 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m01:54:27.082175 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:54:27.082343 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m01:54:27.083340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:54:27.084435 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m01:54:27.084802 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:54:27.084985 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m01:54:27.086412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:54:27.087161 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m01:54:27.087466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d91cd0>]}
[0m01:54:27.087808 [info ] [Thread-1 (]: 5 of 29 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mSELECT 9[0m in 0.04s]
[0m01:54:27.088099 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m01:54:27.088302 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m01:54:27.088571 [info ] [Thread-1 (]: 6 of 29 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m01:54:27.088923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m01:54:27.089112 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m01:54:27.091315 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m01:54:27.091859 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m01:54:27.095501 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m01:54:27.096108 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:54:27.096304 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m01:54:27.096472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.115767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:27.116093 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:54:27.116309 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


  );
  
  
[0m01:54:27.126291 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.010 seconds
[0m01:54:27.128208 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:54:27.128432 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m01:54:27.129315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:27.131190 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:54:27.131394 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m01:54:27.132099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:27.132918 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m01:54:27.133129 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:54:27.133300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m01:54:27.134800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:54:27.136113 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m01:54:27.136508 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:54:27.136700 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m01:54:27.139036 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:54:27.139862 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m01:54:27.140188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eadfd0>]}
[0m01:54:27.140529 [info ] [Thread-1 (]: 6 of 29 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mSELECT 1787[0m in 0.05s]
[0m01:54:27.140829 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m01:54:27.141038 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m01:54:27.141265 [info ] [Thread-1 (]: 7 of 29 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m01:54:27.141537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m01:54:27.141714 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m01:54:27.148567 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m01:54:27.149375 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m01:54:27.158921 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m01:54:27.159677 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m01:54:27.159863 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m01:54:27.160012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.176472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m01:54:27.176786 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m01:54:27.177040 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.178513 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.180433 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m01:54:27.181059 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m01:54:27.181427 [info ] [Thread-1 (]: 7 of 29 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.04s]
[0m01:54:27.181717 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m01:54:27.181909 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m01:54:27.182083 [info ] [Thread-1 (]: 8 of 29 START test not_null_stg_activity_activity_type_short ................... [RUN]
[0m01:54:27.182319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844)
[0m01:54:27.182490 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m01:54:27.184674 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m01:54:27.185196 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m01:54:27.186643 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m01:54:27.187282 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m01:54:27.187510 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: BEGIN
[0m01:54:27.187678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.204878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.205178 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m01:54:27.205373 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_short
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_type_short is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.206586 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.207442 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: ROLLBACK
[0m01:54:27.208114 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: Close
[0m01:54:27.208482 [info ] [Thread-1 (]: 8 of 29 PASS not_null_stg_activity_activity_type_short ......................... [[32mPASS[0m in 0.03s]
[0m01:54:27.208871 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m01:54:27.209067 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m01:54:27.209352 [info ] [Thread-1 (]: 9 of 29 START test not_null_stg_activity_user_id ............................... [RUN]
[0m01:54:27.209652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844, now test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272)
[0m01:54:27.209837 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m01:54:27.212561 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m01:54:27.213155 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m01:54:27.214327 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m01:54:27.214791 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m01:54:27.214958 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: BEGIN
[0m01:54:27.215112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.233432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m01:54:27.233742 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m01:54:27.233937 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.235368 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.236633 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: ROLLBACK
[0m01:54:27.237379 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: Close
[0m01:54:27.237720 [info ] [Thread-1 (]: 9 of 29 PASS not_null_stg_activity_user_id ..................................... [[32mPASS[0m in 0.03s]
[0m01:54:27.238142 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m01:54:27.238354 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m01:54:27.238537 [info ] [Thread-1 (]: 10 of 29 START test unique_stg_activity_activity_id ............................ [RUN]
[0m01:54:27.238910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m01:54:27.239437 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m01:54:27.243342 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m01:54:27.243896 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m01:54:27.245116 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m01:54:27.245529 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m01:54:27.245697 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m01:54:27.245850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.263217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.263562 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m01:54:27.264321 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:27.268292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:54:27.269256 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m01:54:27.270524 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m01:54:27.270891 [info ] [Thread-1 (]: 10 of 29 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.03s]
[0m01:54:27.271202 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m01:54:27.271400 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m01:54:27.271582 [info ] [Thread-1 (]: 11 of 29 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m01:54:27.271856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m01:54:27.272100 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m01:54:27.274803 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m01:54:27.275363 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m01:54:27.276493 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m01:54:27.277225 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m01:54:27.277442 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m01:54:27.277604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.294530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.294835 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m01:54:27.295042 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.296857 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:54:27.297833 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m01:54:27.298481 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m01:54:27.298869 [info ] [Thread-1 (]: 11 of 29 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m01:54:27.299296 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m01:54:27.299530 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m01:54:27.299754 [info ] [Thread-1 (]: 12 of 29 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m01:54:27.300003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m01:54:27.300204 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m01:54:27.305011 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m01:54:27.305651 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m01:54:27.306802 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m01:54:27.307187 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m01:54:27.307358 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m01:54:27.307511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.326779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:27.327151 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m01:54:27.327382 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.330188 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:54:27.331091 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m01:54:27.331648 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m01:54:27.332006 [info ] [Thread-1 (]: 12 of 29 PASS relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[32mPASS[0m in 0.03s]
[0m01:54:27.332301 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m01:54:27.332498 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m01:54:27.332738 [info ] [Thread-1 (]: 13 of 29 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m01:54:27.333019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m01:54:27.333227 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m01:54:27.340505 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m01:54:27.341059 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m01:54:27.342631 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m01:54:27.343077 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m01:54:27.343255 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m01:54:27.343414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.361640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m01:54:27.361941 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m01:54:27.362145 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:27.363236 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.364089 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m01:54:27.364679 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m01:54:27.365066 [info ] [Thread-1 (]: 13 of 29 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m01:54:27.365384 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m01:54:27.365595 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m01:54:27.365805 [info ] [Thread-1 (]: 14 of 29 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m01:54:27.366021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m01:54:27.366194 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m01:54:27.368343 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m01:54:27.369003 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m01:54:27.370166 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m01:54:27.370600 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m01:54:27.370776 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m01:54:27.370936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.389855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:27.390154 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m01:54:27.390358 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.392401 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:54:27.393449 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m01:54:27.394315 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m01:54:27.394701 [info ] [Thread-1 (]: 14 of 29 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m01:54:27.395007 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m01:54:27.395206 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m01:54:27.395383 [info ] [Thread-1 (]: 15 of 29 START test not_null_stg_deal_changes_deal_id_sk ....................... [RUN]
[0m01:54:27.395627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e)
[0m01:54:27.395839 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m01:54:27.398360 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m01:54:27.398921 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m01:54:27.400017 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m01:54:27.400672 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m01:54:27.400853 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: BEGIN
[0m01:54:27.401009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.417874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.418184 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m01:54:27.418384 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.420006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.420945 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: ROLLBACK
[0m01:54:27.421563 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: Close
[0m01:54:27.421911 [info ] [Thread-1 (]: 15 of 29 PASS not_null_stg_deal_changes_deal_id_sk ............................. [[32mPASS[0m in 0.03s]
[0m01:54:27.422208 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m01:54:27.422404 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m01:54:27.422583 [info ] [Thread-1 (]: 16 of 29 START test not_null_stg_deal_changes_deal_updated_field_key ........... [RUN]
[0m01:54:27.422822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624)
[0m01:54:27.422999 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m01:54:27.425465 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m01:54:27.425959 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m01:54:27.427191 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m01:54:27.427762 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m01:54:27.427972 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: BEGIN
[0m01:54:27.428143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.444872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.445258 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m01:54:27.445460 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_updated_field_key
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_updated_field_key is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.447254 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:54:27.448148 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: ROLLBACK
[0m01:54:27.448738 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: Close
[0m01:54:27.449080 [info ] [Thread-1 (]: 16 of 29 PASS not_null_stg_deal_changes_deal_updated_field_key ................. [[32mPASS[0m in 0.03s]
[0m01:54:27.449378 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m01:54:27.449573 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m01:54:27.449755 [info ] [Thread-1 (]: 17 of 29 START test unique_stg_deal_changes_deal_id_sk ......................... [RUN]
[0m01:54:27.449983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624, now test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600)
[0m01:54:27.450214 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m01:54:27.452387 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m01:54:27.453071 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m01:54:27.454555 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m01:54:27.454978 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m01:54:27.455149 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: BEGIN
[0m01:54:27.455312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.474492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:27.474775 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m01:54:27.474975 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:27.480466 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:54:27.481465 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: ROLLBACK
[0m01:54:27.482170 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: Close
[0m01:54:27.482539 [info ] [Thread-1 (]: 17 of 29 PASS unique_stg_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.03s]
[0m01:54:27.482868 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m01:54:27.483082 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m01:54:27.483306 [info ] [Thread-1 (]: 18 of 29 START test not_null_stg_fields_field_key .............................. [RUN]
[0m01:54:27.483529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m01:54:27.483713 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m01:54:27.485900 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m01:54:27.486646 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m01:54:27.487741 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m01:54:27.488106 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m01:54:27.488269 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m01:54:27.488420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.505745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.506028 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m01:54:27.506218 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.507131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.507985 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m01:54:27.508731 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m01:54:27.509144 [info ] [Thread-1 (]: 18 of 29 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m01:54:27.509546 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m01:54:27.509844 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m01:54:27.510119 [info ] [Thread-1 (]: 19 of 29 START test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [RUN]
[0m01:54:27.510407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa)
[0m01:54:27.510619 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m01:54:27.514192 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m01:54:27.514785 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m01:54:27.515933 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m01:54:27.516392 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m01:54:27.516587 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: BEGIN
[0m01:54:27.516753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.536960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:54:27.537287 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m01:54:27.537508 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_updated_field_key as from_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where deal_updated_field_key is not null
),

parent as (
    select field_key as to_field
    from "postgres"."public_pipedrive_analytics"."stg_fields"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.540993 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:54:27.541981 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: ROLLBACK
[0m01:54:27.542762 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: Close
[0m01:54:27.543221 [info ] [Thread-1 (]: 19 of 29 PASS relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[32mPASS[0m in 0.03s]
[0m01:54:27.543582 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m01:54:27.543816 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m01:54:27.544090 [info ] [Thread-1 (]: 20 of 29 START test unique_stg_fields_field_key ................................ [RUN]
[0m01:54:27.544369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m01:54:27.544570 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m01:54:27.548435 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m01:54:27.549012 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m01:54:27.550202 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m01:54:27.550654 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m01:54:27.550840 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m01:54:27.551003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.568529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.568841 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m01:54:27.569050 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:27.570438 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.571373 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m01:54:27.572101 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m01:54:27.572516 [info ] [Thread-1 (]: 20 of 29 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m01:54:27.572909 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m01:54:27.573231 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m01:54:27.573422 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m01:54:27.573805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m01:54:27.574050 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m01:54:27.576247 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m01:54:27.576791 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m01:54:27.578444 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m01:54:27.578937 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m01:54:27.579119 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m01:54:27.579276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.598243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:27.598533 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m01:54:27.598723 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.599780 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.600626 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m01:54:27.601359 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m01:54:27.601693 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m01:54:27.601978 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m01:54:27.602168 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m01:54:27.602339 [info ] [Thread-1 (]: 22 of 29 START test unique_stg_stages_stage_id ................................. [RUN]
[0m01:54:27.602589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m01:54:27.602870 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m01:54:27.605110 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m01:54:27.605683 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m01:54:27.606806 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m01:54:27.607192 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m01:54:27.607370 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m01:54:27.607526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.624499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.624774 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m01:54:27.625036 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:27.626456 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.627411 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m01:54:27.628098 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m01:54:27.628479 [info ] [Thread-1 (]: 22 of 29 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m01:54:27.628792 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m01:54:27.628991 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m01:54:27.629167 [info ] [Thread-1 (]: 23 of 29 START test not_null_stg_users_user_id ................................. [RUN]
[0m01:54:27.629405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m01:54:27.629584 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m01:54:27.632138 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m01:54:27.632634 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m01:54:27.633725 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m01:54:27.634148 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m01:54:27.634375 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m01:54:27.634541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.655871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m01:54:27.656161 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m01:54:27.656353 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.657501 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.658389 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m01:54:27.659077 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m01:54:27.659544 [info ] [Thread-1 (]: 23 of 29 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m01:54:27.660209 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m01:54:27.660582 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m01:54:27.660901 [info ] [Thread-1 (]: 24 of 29 START test not_null_stg_users_user_name ............................... [RUN]
[0m01:54:27.661255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m01:54:27.661484 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m01:54:27.664013 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m01:54:27.664762 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m01:54:27.665893 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m01:54:27.666292 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m01:54:27.666473 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m01:54:27.666633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.683498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.683804 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m01:54:27.684008 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.685067 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.685958 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m01:54:27.686583 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m01:54:27.686933 [info ] [Thread-1 (]: 24 of 29 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m01:54:27.687233 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m01:54:27.687440 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m01:54:27.687653 [info ] [Thread-1 (]: 25 of 29 START test relationships_stg_activity_user_id__user_id__ref_stg_users_  [RUN]
[0m01:54:27.687864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02)
[0m01:54:27.688048 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m01:54:27.691006 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m01:54:27.691590 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m01:54:27.693387 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m01:54:27.694131 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m01:54:27.694379 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: BEGIN
[0m01:54:27.694581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.711758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.712127 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m01:54:27.712353 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.714387 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:54:27.715277 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: ROLLBACK
[0m01:54:27.715917 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: Close
[0m01:54:27.716256 [info ] [Thread-1 (]: 25 of 29 PASS relationships_stg_activity_user_id__user_id__ref_stg_users_ ...... [[32mPASS[0m in 0.03s]
[0m01:54:27.716552 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m01:54:27.716747 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m01:54:27.717020 [info ] [Thread-1 (]: 26 of 29 START test unique_stg_users_user_id ................................... [RUN]
[0m01:54:27.717304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m01:54:27.717510 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m01:54:27.719659 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m01:54:27.720211 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m01:54:27.721302 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m01:54:27.721724 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m01:54:27.721897 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m01:54:27.722047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.740756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:27.741057 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m01:54:27.741253 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:27.743876 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:54:27.744804 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m01:54:27.745495 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m01:54:27.745832 [info ] [Thread-1 (]: 26 of 29 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m01:54:27.746203 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m01:54:27.746432 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m01:54:27.746701 [info ] [Thread-1 (]: 27 of 29 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m01:54:27.746966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m01:54:27.747159 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m01:54:27.749652 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m01:54:27.750157 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m01:54:27.752028 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m01:54:27.752749 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m01:54:27.752962 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m01:54:27.753130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.771717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:27.772021 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m01:54:27.772244 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(value->>'id' AS INT) AS lost_reason_id -- Unique identifier for the lost reason
        , value->>'name' AS lost_reason_name -- Name of the lost reason
    FROM raw
        , jsonb_array_elements(raw.field_value_options) AS value  -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


  );
  
  
[0m01:54:27.775464 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m01:54:27.777651 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m01:54:27.777900 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons" rename to "stg_lost_reasons__dbt_backup"
[0m01:54:27.778787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:27.780259 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m01:54:27.780459 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp" rename to "stg_lost_reasons"
[0m01:54:27.781228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:27.782022 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m01:54:27.782206 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m01:54:27.782366 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m01:54:27.783519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:54:27.784564 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup"
[0m01:54:27.784901 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m01:54:27.785078 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup" cascade
[0m01:54:27.786480 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:54:27.787199 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m01:54:27.787512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28488926-9660-40f7-9de2-63fe45a314c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab3770>]}
[0m01:54:27.787860 [info ] [Thread-1 (]: 27 of 29 OK created sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[32mSELECT 5[0m in 0.04s]
[0m01:54:27.788173 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m01:54:27.788577 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m01:54:27.788811 [info ] [Thread-1 (]: 28 of 29 START test not_null_stg_lost_reasons_lost_reason_id ................... [RUN]
[0m01:54:27.789065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_lost_reasons, now test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768)
[0m01:54:27.789250 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m01:54:27.791785 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m01:54:27.792721 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m01:54:27.794041 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m01:54:27.794643 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m01:54:27.794843 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: BEGIN
[0m01:54:27.795013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.816265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m01:54:27.816567 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m01:54:27.816781 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lost_reason_id
from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:27.817795 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.818714 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: ROLLBACK
[0m01:54:27.819354 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: Close
[0m01:54:27.819748 [info ] [Thread-1 (]: 28 of 29 PASS not_null_stg_lost_reasons_lost_reason_id ......................... [[32mPASS[0m in 0.03s]
[0m01:54:27.820121 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m01:54:27.820345 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m01:54:27.820567 [info ] [Thread-1 (]: 29 of 29 START test unique_stg_lost_reasons_lost_reason_id ..................... [RUN]
[0m01:54:27.820797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768, now test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d)
[0m01:54:27.820984 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m01:54:27.823562 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m01:54:27.824088 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m01:54:27.825489 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m01:54:27.826058 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m01:54:27.826235 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: BEGIN
[0m01:54:27.826392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:27.843946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:54:27.844228 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m01:54:27.844423 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    lost_reason_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is not null
group by lost_reason_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:27.845657 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:54:27.846558 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: ROLLBACK
[0m01:54:27.847216 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: Close
[0m01:54:27.847633 [info ] [Thread-1 (]: 29 of 29 PASS unique_stg_lost_reasons_lost_reason_id ........................... [[32mPASS[0m in 0.03s]
[0m01:54:27.848072 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m01:54:27.848856 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:27.849062 [debug] [MainThread]: On master: BEGIN
[0m01:54:27.849210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:27.867345 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m01:54:27.867617 [debug] [MainThread]: On master: COMMIT
[0m01:54:27.867773 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:27.867909 [debug] [MainThread]: On master: COMMIT
[0m01:54:27.868438 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:54:27.868583 [debug] [MainThread]: On master: Close
[0m01:54:27.868808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:27.868940 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' was properly closed.
[0m01:54:27.869153 [info ] [MainThread]: 
[0m01:54:27.869331 [info ] [MainThread]: Finished running 7 incremental models, 22 data tests in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m01:54:27.871302 [debug] [MainThread]: Command end result
[0m01:54:27.889963 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:54:27.891141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:54:27.895090 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m01:54:27.895309 [info ] [MainThread]: 
[0m01:54:27.895492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:54:27.895637 [info ] [MainThread]: 
[0m01:54:27.895787 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=29
[0m01:54:27.897574 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7170154, "process_in_blocks": "0", "process_kernel_time": 0.328268, "process_mem_max_rss": "129466368", "process_out_blocks": "0", "process_user_time": 1.632502}
[0m01:54:27.897835 [debug] [MainThread]: Command `dbt build` succeeded at 01:54:27.897788 after 1.72 seconds
[0m01:54:27.898026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034b9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d51910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d51f70>]}
[0m01:54:27.898207 [debug] [MainThread]: Flushing usage events
[0m01:54:29.585938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:33.800679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e34050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c33b10>]}


============================== 01:54:33.803807 | 9c6892e5-9732-4e59-9916-aea618d44304 ==============================
[0m01:54:33.803807 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:54:33.804136 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'invocation_command': 'dbt build -s tag:intermediate -f', 'cache_selected_only': 'False', 'empty': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m01:54:33.902248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c6892e5-9732-4e59-9916-aea618d44304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11021fe10>]}
[0m01:54:33.930290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c6892e5-9732-4e59-9916-aea618d44304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ab3bd0>]}
[0m01:54:33.931151 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:54:33.979707 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:54:34.055850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:54:34.056100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:54:34.083156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c6892e5-9732-4e59-9916-aea618d44304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113033350>]}
[0m01:54:34.131519 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:54:34.132728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:54:34.154469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c6892e5-9732-4e59-9916-aea618d44304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132dad50>]}
[0m01:54:34.154754 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m01:54:34.156000 [info ] [MainThread]: 
[0m01:54:34.156190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:34.156324 [info ] [MainThread]: 
[0m01:54:34.156567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:54:34.158353 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:54:34.222499 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:54:34.223061 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:54:34.223283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:34.259093 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.036 seconds
[0m01:54:34.259955 [debug] [ThreadPool]: On list_postgres: Close
[0m01:54:34.260969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m01:54:34.263903 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:54:34.264076 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:54:34.264203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:34.281459 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m01:54:34.281730 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:54:34.281902 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:54:34.284441 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m01:54:34.285263 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:54:34.285849 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:54:34.289185 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:34.289391 [debug] [MainThread]: On master: BEGIN
[0m01:54:34.289532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:34.306215 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m01:54:34.306471 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:34.306683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:54:34.308778 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:54:34.309563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c6892e5-9732-4e59-9916-aea618d44304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ab930>]}
[0m01:54:34.309863 [debug] [MainThread]: On master: ROLLBACK
[0m01:54:34.310472 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:34.310630 [debug] [MainThread]: On master: BEGIN
[0m01:54:34.311626 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:54:34.311831 [debug] [MainThread]: On master: COMMIT
[0m01:54:34.311994 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:34.312140 [debug] [MainThread]: On master: COMMIT
[0m01:54:34.312719 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:54:34.312937 [debug] [MainThread]: On master: Close
[0m01:54:34.314773 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity
[0m01:54:34.349730 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_analytics.int_activity ..... [RUN]
[0m01:54:34.350120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.int_activity)
[0m01:54:34.350314 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity
[0m01:54:34.357677 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity"
[0m01:54:34.358302 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activity
[0m01:54:34.385067 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activity"
[0m01:54:34.385636 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:34.385807 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: BEGIN
[0m01:54:34.385959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:34.410826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m01:54:34.411076 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:34.411264 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp"
  
  
    as
  
  (
    

-- Intermediate model that enriches activities with descriptive user and activity type information. 
-- Keeps 1 row per activity_id (deduped in stg_activity).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_activity"
),

user_enriched AS (
    SELECT
        b.activity_id
        , b.deal_id
        , b.user_id
        , u.user_name
        , u.user_email
        , b.activity_type_short
        , b.is_activity_done_status
        , b.activity_due_timestamp
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_users" u
      ON b.user_id = u.user_id
),

activity_type_enriched AS (
    SELECT
        ue.*
        , at.activity_type_name
        , at.is_activity_type_active
    FROM user_enriched ue
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_activity_types" at
      ON ue.activity_type_short = at.activity_type_short
)

SELECT *
FROM activity_type_enriched


  );
  
  
[0m01:54:34.422739 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.011 seconds
[0m01:54:34.428413 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:34.428650 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity" rename to "int_activity__dbt_backup"
[0m01:54:34.429604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:34.431119 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:34.431323 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp" rename to "int_activity"
[0m01:54:34.432149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:54:34.441454 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m01:54:34.441698 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:34.441875 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m01:54:34.444343 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:54:34.448317 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup"
[0m01:54:34.450930 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m01:54:34.451147 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup" cascade
[0m01:54:34.453098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:54:34.454456 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: Close
[0m01:54:34.455666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c6892e5-9732-4e59-9916-aea618d44304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137e3ba0>]}
[0m01:54:34.456046 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model public_pipedrive_analytics.int_activity  [[32mSELECT 4568[0m in 0.10s]
[0m01:54:34.456421 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity
[0m01:54:34.456638 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes
[0m01:54:34.456921 [info ] [Thread-1 (]: 2 of 7 START sql incremental model public_pipedrive_analytics.int_deal_changes . [RUN]
[0m01:54:34.457202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity, now model.enpal_assessment_project.int_deal_changes)
[0m01:54:34.457387 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes
[0m01:54:34.459707 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes"
[0m01:54:34.460192 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes
[0m01:54:34.462296 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes"
[0m01:54:34.462757 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:34.462928 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: BEGIN
[0m01:54:34.463077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:34.482224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:54:34.482542 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:34.482786 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Intermediate model that enriches deal changes with descriptive fields such as stage name or lost reason name. 
-- Keeps 1 row per deal change (normalized, auditable history).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_deal_changes"
),

-- Bring in stage names when the change refers to stage_id
stage_enriched AS (
    SELECT
        b.deal_id_sk
        , b.deal_id
        , b.deal_change_timestamp
        , b.deal_updated_field_key
        , b.deal_new_value
        , s.stage_name
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_stages" s
      ON b.deal_updated_field_key = 'stage_id'
     AND b.deal_new_value = CAST(s.stage_id AS TEXT)
),

-- Bring in lost reason names when the change refers to lost_reason
lost_reason_enriched AS (
    SELECT
        se.*
        , lr.lost_reason_name
    FROM stage_enriched se
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_lost_reasons" lr
      ON se.deal_updated_field_key = 'lost_reason'
     AND se.deal_new_value = CAST(lr.lost_reason_id AS TEXT)
),

final AS (
    SELECT
        deal_id_sk
        , deal_id
        , deal_change_timestamp
        , deal_updated_field_key
        , deal_new_value
        , stage_name
        , lost_reason_name
        , dwh_creation_timestamp
        , dwh_modified_timestamp
    FROM lost_reason_enriched
)

SELECT *
FROM final


  );
  
  
[0m01:54:35.552626 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 1.065 seconds
[0m01:54:35.571613 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:35.572509 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes" rename to "int_deal_changes__dbt_backup"
[0m01:54:35.582809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m01:54:35.585953 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:35.586447 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_tmp" rename to "int_deal_changes"
[0m01:54:35.588728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:54:35.590013 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m01:54:35.590255 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:35.591193 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m01:54:35.604279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m01:54:35.608265 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_backup"
[0m01:54:35.609396 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m01:54:35.609660 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_backup" cascade
[0m01:54:35.621562 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m01:54:35.622979 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: Close
[0m01:54:35.624116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c6892e5-9732-4e59-9916-aea618d44304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11337fa10>]}
[0m01:54:35.624889 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model public_pipedrive_analytics.int_deal_changes  [[32mSELECT 15406[0m in 1.17s]
[0m01:54:35.626031 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes
[0m01:54:35.628155 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:54:35.630257 [info ] [Thread-1 (]: 3 of 7 START test not_null_int_activity_activity_id ............................ [RUN]
[0m01:54:35.630957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes, now test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f)
[0m01:54:35.631198 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:54:35.650393 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:54:35.653410 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:54:35.677483 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:54:35.678173 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:54:35.678432 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: BEGIN
[0m01:54:35.678652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:35.739813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m01:54:35.740163 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m01:54:35.740365 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:35.745811 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:54:35.753324 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: ROLLBACK
[0m01:54:35.755066 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: Close
[0m01:54:35.755609 [info ] [Thread-1 (]: 3 of 7 PASS not_null_int_activity_activity_id .................................. [[32mPASS[0m in 0.12s]
[0m01:54:35.755994 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m01:54:35.756197 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:54:35.756428 [info ] [Thread-1 (]: 4 of 7 START test unique_int_activity_activity_id .............................. [RUN]
[0m01:54:35.756652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f, now test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e)
[0m01:54:35.756835 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:54:35.763442 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:54:35.765216 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:54:35.769302 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:54:35.770804 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:54:35.771034 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: BEGIN
[0m01:54:35.771202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:35.837246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m01:54:35.837591 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m01:54:35.837856 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:35.843052 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:54:35.844075 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: ROLLBACK
[0m01:54:35.844836 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: Close
[0m01:54:35.845190 [info ] [Thread-1 (]: 4 of 7 PASS unique_int_activity_activity_id .................................... [[32mPASS[0m in 0.09s]
[0m01:54:35.845543 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m01:54:35.845737 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:54:35.846035 [info ] [Thread-1 (]: 5 of 7 START test not_null_int_deal_changes_deal_id ............................ [RUN]
[0m01:54:35.846320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1)
[0m01:54:35.846482 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:54:35.848667 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:54:35.849221 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:54:35.850297 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:54:35.850711 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:54:35.850886 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: BEGIN
[0m01:54:35.851182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:35.878055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m01:54:35.878344 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m01:54:35.878519 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:35.880747 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:54:35.881578 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: ROLLBACK
[0m01:54:35.882169 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: Close
[0m01:54:35.882486 [info ] [Thread-1 (]: 5 of 7 PASS not_null_int_deal_changes_deal_id .................................. [[32mPASS[0m in 0.04s]
[0m01:54:35.882753 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m01:54:35.882935 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:54:35.883155 [info ] [Thread-1 (]: 6 of 7 START test not_null_int_deal_changes_deal_id_sk ......................... [RUN]
[0m01:54:35.883423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813)
[0m01:54:35.883613 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:54:35.885990 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:54:35.886714 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:54:35.887753 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:54:35.888147 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:54:35.888300 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: BEGIN
[0m01:54:35.888446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:35.908292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:54:35.908627 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m01:54:35.908885 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m01:54:35.910880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:54:35.911851 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: ROLLBACK
[0m01:54:35.912673 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: Close
[0m01:54:35.913036 [info ] [Thread-1 (]: 6 of 7 PASS not_null_int_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.03s]
[0m01:54:35.913411 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m01:54:35.913622 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:54:35.913801 [info ] [Thread-1 (]: 7 of 7 START test unique_int_deal_changes_deal_id_sk ........................... [RUN]
[0m01:54:35.914025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813, now test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a)
[0m01:54:35.914375 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:54:35.917628 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:54:35.918455 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:54:35.919824 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:54:35.920318 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:54:35.920489 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: BEGIN
[0m01:54:35.920642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:35.946849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m01:54:35.947178 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m01:54:35.947373 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:54:35.954530 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m01:54:35.955643 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: ROLLBACK
[0m01:54:35.957107 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: Close
[0m01:54:35.957466 [info ] [Thread-1 (]: 7 of 7 PASS unique_int_deal_changes_deal_id_sk ................................. [[32mPASS[0m in 0.04s]
[0m01:54:35.957735 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m01:54:35.959117 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:35.959422 [debug] [MainThread]: On master: BEGIN
[0m01:54:35.959656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:35.994597 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m01:54:35.994873 [debug] [MainThread]: On master: COMMIT
[0m01:54:35.995025 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:35.995153 [debug] [MainThread]: On master: COMMIT
[0m01:54:35.995678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:54:35.995899 [debug] [MainThread]: On master: Close
[0m01:54:35.996247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:35.996406 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a' was properly closed.
[0m01:54:35.996635 [info ] [MainThread]: 
[0m01:54:35.996809 [info ] [MainThread]: Finished running 2 incremental models, 5 data tests in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m01:54:35.997541 [debug] [MainThread]: Command end result
[0m01:54:36.084992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m01:54:36.087236 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:54:36.091237 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m01:54:36.091449 [info ] [MainThread]: 
[0m01:54:36.091640 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:54:36.091806 [info ] [MainThread]: 
[0m01:54:36.091982 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m01:54:36.093904 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.3324366, "process_in_blocks": "0", "process_kernel_time": 0.277668, "process_mem_max_rss": "129400832", "process_out_blocks": "0", "process_user_time": 1.286807}
[0m01:54:36.094245 [debug] [MainThread]: Command `dbt build` succeeded at 01:54:36.094191 after 2.33 seconds
[0m01:54:36.094498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11333f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a004b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae7390>]}
[0m01:54:36.094691 [debug] [MainThread]: Flushing usage events
[0m01:54:37.534949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:04.962844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067efb10>]}


============================== 02:29:04.966359 | 9d5e7931-3dcc-4434-ad9b-cd39a22b7396 ==============================
[0m02:29:04.966359 [info ] [MainThread]: Running with dbt=1.10.11
[0m02:29:04.966691 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'invocation_command': 'dbt build -s tag:staging -f', 'write_json': 'True', 'empty': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m02:29:05.075016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aefe10>]}
[0m02:29:05.103273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666fbd0>]}
[0m02:29:05.103890 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:29:05.152421 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m02:29:05.258595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:29:05.259288 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/reporting/rep_sales_funnel_monthly.sql
[0m02:29:05.388992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107534050>]}
[0m02:29:05.471008 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:29:05.472467 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:29:05.494263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ad400>]}
[0m02:29:05.494538 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m02:29:05.495917 [info ] [MainThread]: 
[0m02:29:05.496093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:29:05.496229 [info ] [MainThread]: 
[0m02:29:05.496454 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:29:05.498427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:29:05.551494 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:29:05.551778 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:29:05.551927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:05.737932 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.186 seconds
[0m02:29:05.738845 [debug] [ThreadPool]: On list_postgres: Close
[0m02:29:05.739954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m02:29:05.743176 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:29:05.743428 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:29:05.743575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:29:05.759602 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m02:29:05.759875 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:29:05.760030 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:29:05.768905 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m02:29:05.770014 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:29:05.770893 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:29:05.775191 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:05.775469 [debug] [MainThread]: On master: BEGIN
[0m02:29:05.775648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:29:05.797091 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m02:29:05.797396 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:05.797635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:29:05.803503 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m02:29:05.804828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d35b0>]}
[0m02:29:05.805142 [debug] [MainThread]: On master: ROLLBACK
[0m02:29:05.805836 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:05.806017 [debug] [MainThread]: On master: BEGIN
[0m02:29:05.807130 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:29:05.807385 [debug] [MainThread]: On master: COMMIT
[0m02:29:05.807591 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:05.807768 [debug] [MainThread]: On master: COMMIT
[0m02:29:05.808404 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:29:05.808589 [debug] [MainThread]: On master: Close
[0m02:29:05.810580 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m02:29:05.810951 [info ] [Thread-1 (]: 1 of 29 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m02:29:05.811242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m02:29:05.811453 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m02:29:05.818390 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m02:29:05.819571 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m02:29:05.849622 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m02:29:05.850208 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:29:05.850381 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m02:29:05.850531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:05.871046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:29:05.871362 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:29:05.871596 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM (
        SELECT *,
               ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) AS rn
        FROM raw
    ) t
    WHERE rn = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:29:05.896628 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.025 seconds
[0m02:29:05.902222 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:29:05.902448 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m02:29:05.904396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:29:05.905782 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:29:05.905965 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m02:29:05.906546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:29:05.915729 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:29:05.915963 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:29:05.916141 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:29:05.920212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m02:29:05.925716 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m02:29:05.928295 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:29:05.928511 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m02:29:05.934485 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m02:29:05.935927 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m02:29:05.937216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ceed00>]}
[0m02:29:05.937594 [info ] [Thread-1 (]: 1 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity  [[32mSELECT 4568[0m in 0.13s]
[0m02:29:05.937923 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m02:29:05.938148 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m02:29:05.938446 [info ] [Thread-1 (]: 2 of 29 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m02:29:05.938756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m02:29:05.938943 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m02:29:05.941039 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m02:29:05.941688 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m02:29:05.943985 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m02:29:05.944515 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:29:05.944722 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m02:29:05.944897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:05.962927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:29:05.963240 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:29:05.963459 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:29:05.966447 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m02:29:05.968593 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:29:05.968832 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m02:29:05.969685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:05.971063 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:29:05.971249 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m02:29:05.971879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:29:05.972646 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:29:05.972818 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:29:05.972972 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:29:05.973996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:29:05.975526 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m02:29:05.975932 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:29:05.976131 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m02:29:05.977585 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:29:05.978334 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m02:29:05.978662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790ca10>]}
[0m02:29:05.979013 [info ] [Thread-1 (]: 2 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mSELECT 4[0m in 0.04s]
[0m02:29:05.979306 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m02:29:05.979506 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m02:29:05.979789 [info ] [Thread-1 (]: 3 of 29 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m02:29:05.980143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m02:29:05.980370 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m02:29:05.982650 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:29:05.983167 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m02:29:05.985471 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:29:05.986011 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:29:05.986213 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m02:29:05.986383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.007419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:29:06.007737 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:29:06.007973 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m02:29:06.048453 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.040 seconds
[0m02:29:06.050292 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:29:06.050488 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m02:29:06.051370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:06.052655 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:29:06.052821 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m02:29:06.053478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:29:06.054333 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:29:06.054537 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:29:06.054710 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:29:06.058504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m02:29:06.059997 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m02:29:06.060357 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:29:06.060535 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m02:29:06.066077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m02:29:06.066854 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m02:29:06.067184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bf540>]}
[0m02:29:06.067519 [info ] [Thread-1 (]: 3 of 29 OK created sql incremental model public_pipedrive_analytics.stg_deal_changes  [[32mSELECT 15406[0m in 0.09s]
[0m02:29:06.067806 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m02:29:06.068005 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m02:29:06.068282 [info ] [Thread-1 (]: 4 of 29 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m02:29:06.068553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m02:29:06.068726 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m02:29:06.070900 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m02:29:06.071374 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m02:29:06.073414 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m02:29:06.073845 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:29:06.074110 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m02:29:06.074322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.095096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:29:06.095440 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:29:06.095676 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:29:06.098980 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m02:29:06.100929 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:29:06.101154 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m02:29:06.102344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:06.103808 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:29:06.104005 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m02:29:06.104725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:06.105531 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:29:06.105717 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:29:06.105883 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:29:06.106668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:29:06.108081 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup"
[0m02:29:06.108433 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:29:06.108613 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m02:29:06.110397 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:29:06.111115 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m02:29:06.111459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d48870>]}
[0m02:29:06.111910 [info ] [Thread-1 (]: 4 of 29 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mSELECT 4[0m in 0.04s]
[0m02:29:06.112231 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m02:29:06.112441 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m02:29:06.112765 [info ] [Thread-1 (]: 5 of 29 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m02:29:06.113108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m02:29:06.113303 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m02:29:06.115479 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m02:29:06.116195 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m02:29:06.118408 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m02:29:06.118811 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:29:06.118986 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m02:29:06.119143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.137832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:29:06.138133 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:29:06.138345 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:29:06.140021 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:29:06.141692 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:29:06.141890 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m02:29:06.142738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:06.144143 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:29:06.144318 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m02:29:06.144975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:29:06.146038 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:29:06.146217 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:29:06.146374 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:29:06.147632 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:29:06.148866 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m02:29:06.149297 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:29:06.149496 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m02:29:06.151043 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:29:06.151784 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m02:29:06.152094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd5950>]}
[0m02:29:06.152421 [info ] [Thread-1 (]: 5 of 29 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mSELECT 9[0m in 0.04s]
[0m02:29:06.152702 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m02:29:06.152900 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m02:29:06.153157 [info ] [Thread-1 (]: 6 of 29 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m02:29:06.153477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m02:29:06.153704 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m02:29:06.155832 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m02:29:06.156459 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m02:29:06.158658 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m02:29:06.159185 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:29:06.159395 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m02:29:06.159597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.177923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:29:06.178228 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:29:06.178430 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


  );
  
  
[0m02:29:06.186385 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.008 seconds
[0m02:29:06.188301 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:29:06.188518 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m02:29:06.189355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:06.190819 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:29:06.191011 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m02:29:06.191842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:06.193041 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:29:06.193237 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:29:06.193404 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:29:06.194845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:29:06.195958 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m02:29:06.196305 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:29:06.196484 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m02:29:06.198826 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:29:06.199567 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m02:29:06.199886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3a820>]}
[0m02:29:06.200221 [info ] [Thread-1 (]: 6 of 29 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mSELECT 1787[0m in 0.05s]
[0m02:29:06.200520 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m02:29:06.200724 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:29:06.200950 [info ] [Thread-1 (]: 7 of 29 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m02:29:06.201281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m02:29:06.201515 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:29:06.208469 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:29:06.209632 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:29:06.220544 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:29:06.221493 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:29:06.221696 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m02:29:06.221858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.239943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:29:06.240234 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:29:06.240427 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.242353 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:06.244206 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m02:29:06.244778 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m02:29:06.245124 [info ] [Thread-1 (]: 7 of 29 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.04s]
[0m02:29:06.245416 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:29:06.245615 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:29:06.245820 [info ] [Thread-1 (]: 8 of 29 START test not_null_stg_activity_activity_type_short ................... [RUN]
[0m02:29:06.246022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844)
[0m02:29:06.246254 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:29:06.248457 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:29:06.248956 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:29:06.251612 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:29:06.252203 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:29:06.252385 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: BEGIN
[0m02:29:06.252541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.269185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:29:06.269494 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:29:06.269697 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_short
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_type_short is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.271299 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:29:06.272202 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: ROLLBACK
[0m02:29:06.272843 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: Close
[0m02:29:06.273226 [info ] [Thread-1 (]: 8 of 29 PASS not_null_stg_activity_activity_type_short ......................... [[32mPASS[0m in 0.03s]
[0m02:29:06.273530 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:29:06.273727 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:29:06.273932 [info ] [Thread-1 (]: 9 of 29 START test not_null_stg_activity_user_id ............................... [RUN]
[0m02:29:06.274132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844, now test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272)
[0m02:29:06.274304 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:29:06.276477 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:29:06.277023 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:29:06.278115 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:29:06.278492 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:29:06.278665 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: BEGIN
[0m02:29:06.278816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.295365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m02:29:06.295693 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:29:06.295901 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.298023 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:06.299789 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: ROLLBACK
[0m02:29:06.301544 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: Close
[0m02:29:06.302251 [info ] [Thread-1 (]: 9 of 29 PASS not_null_stg_activity_user_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:29:06.303112 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:29:06.303425 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:29:06.303635 [info ] [Thread-1 (]: 10 of 29 START test unique_stg_activity_activity_id ............................ [RUN]
[0m02:29:06.303898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m02:29:06.304298 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:29:06.308496 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:29:06.309153 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:29:06.310303 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:29:06.310667 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:29:06.310831 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m02:29:06.310977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.328311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:29:06.328628 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:29:06.328831 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:29:06.331586 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:29:06.332584 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m02:29:06.333531 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m02:29:06.333953 [info ] [Thread-1 (]: 10 of 29 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.03s]
[0m02:29:06.334279 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:29:06.334488 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:29:06.334699 [info ] [Thread-1 (]: 11 of 29 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m02:29:06.334909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m02:29:06.335086 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:29:06.337577 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:29:06.338145 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:29:06.339248 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:29:06.339764 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:29:06.339939 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m02:29:06.340137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.357467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:29:06.357770 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:29:06.357972 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.358964 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:29:06.359854 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m02:29:06.360564 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m02:29:06.360960 [info ] [Thread-1 (]: 11 of 29 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m02:29:06.361295 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:29:06.361513 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:29:06.361752 [info ] [Thread-1 (]: 12 of 29 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m02:29:06.362027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m02:29:06.362270 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:29:06.367192 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:29:06.367881 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:29:06.369768 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:29:06.370906 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:29:06.371122 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m02:29:06.371292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.389506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:29:06.389813 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:29:06.390025 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.391981 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:06.392863 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m02:29:06.393558 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m02:29:06.393908 [info ] [Thread-1 (]: 12 of 29 PASS relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[32mPASS[0m in 0.03s]
[0m02:29:06.394210 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:29:06.394412 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:29:06.394591 [info ] [Thread-1 (]: 13 of 29 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m02:29:06.394864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m02:29:06.395099 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:29:06.397238 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:29:06.397734 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:29:06.398854 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:29:06.399513 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:29:06.399693 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m02:29:06.399839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.418331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:29:06.418623 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:29:06.418819 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:29:06.421030 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:06.421977 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m02:29:06.422691 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m02:29:06.423173 [info ] [Thread-1 (]: 13 of 29 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m02:29:06.423520 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:29:06.423724 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:29:06.423927 [info ] [Thread-1 (]: 14 of 29 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m02:29:06.424139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m02:29:06.424303 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:29:06.427036 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:29:06.430869 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:29:06.432445 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:29:06.432966 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:29:06.433166 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m02:29:06.433329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.462580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m02:29:06.462902 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:29:06.463102 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.465850 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:06.466890 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m02:29:06.467739 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m02:29:06.468188 [info ] [Thread-1 (]: 14 of 29 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.04s]
[0m02:29:06.468540 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:29:06.468772 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:29:06.469006 [info ] [Thread-1 (]: 15 of 29 START test not_null_stg_deal_changes_deal_id_sk ....................... [RUN]
[0m02:29:06.469359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e)
[0m02:29:06.469589 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:29:06.472456 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:29:06.473034 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:29:06.474263 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:29:06.474906 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:29:06.475100 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: BEGIN
[0m02:29:06.475271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.498408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:29:06.498740 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:29:06.498961 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.500930 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:06.501897 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: ROLLBACK
[0m02:29:06.502609 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: Close
[0m02:29:06.502989 [info ] [Thread-1 (]: 15 of 29 PASS not_null_stg_deal_changes_deal_id_sk ............................. [[32mPASS[0m in 0.03s]
[0m02:29:06.503300 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:29:06.503507 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:29:06.503734 [info ] [Thread-1 (]: 16 of 29 START test not_null_stg_deal_changes_deal_updated_field_key ........... [RUN]
[0m02:29:06.503999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624)
[0m02:29:06.504198 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:29:06.506480 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:29:06.507036 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:29:06.508538 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:29:06.508945 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:29:06.509125 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: BEGIN
[0m02:29:06.509284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.532705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:29:06.533411 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:29:06.534038 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_updated_field_key
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_updated_field_key is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.539575 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:29:06.540628 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: ROLLBACK
[0m02:29:06.541779 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: Close
[0m02:29:06.542345 [info ] [Thread-1 (]: 16 of 29 PASS not_null_stg_deal_changes_deal_updated_field_key ................. [[32mPASS[0m in 0.04s]
[0m02:29:06.542744 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:29:06.542978 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:29:06.543192 [info ] [Thread-1 (]: 17 of 29 START test unique_stg_deal_changes_deal_id_sk ......................... [RUN]
[0m02:29:06.543505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624, now test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600)
[0m02:29:06.543728 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:29:06.546327 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:29:06.549514 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:29:06.550937 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:29:06.551896 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:29:06.552094 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: BEGIN
[0m02:29:06.552267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.571210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:29:06.571624 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:29:06.571838 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:29:06.577621 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m02:29:06.578526 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: ROLLBACK
[0m02:29:06.579254 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: Close
[0m02:29:06.579578 [info ] [Thread-1 (]: 17 of 29 PASS unique_stg_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.04s]
[0m02:29:06.579844 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:29:06.580022 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:29:06.580181 [info ] [Thread-1 (]: 18 of 29 START test not_null_stg_fields_field_key .............................. [RUN]
[0m02:29:06.580369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m02:29:06.580520 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:29:06.583041 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:29:06.583865 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:29:06.585093 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:29:06.585478 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:29:06.585636 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m02:29:06.585773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.604784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:29:06.605103 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:29:06.605337 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.606474 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:29:06.607361 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m02:29:06.607997 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m02:29:06.608354 [info ] [Thread-1 (]: 18 of 29 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m02:29:06.608670 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:29:06.608889 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:29:06.609125 [info ] [Thread-1 (]: 19 of 29 START test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [RUN]
[0m02:29:06.609358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa)
[0m02:29:06.609548 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:29:06.612999 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:29:06.613557 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:29:06.614651 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:29:06.615049 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:29:06.615232 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: BEGIN
[0m02:29:06.615434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.634489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:29:06.634769 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:29:06.634969 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_updated_field_key as from_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where deal_updated_field_key is not null
),

parent as (
    select field_key as to_field
    from "postgres"."public_pipedrive_analytics"."stg_fields"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.638747 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:29:06.639689 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: ROLLBACK
[0m02:29:06.640540 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: Close
[0m02:29:06.640976 [info ] [Thread-1 (]: 19 of 29 PASS relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[32mPASS[0m in 0.03s]
[0m02:29:06.641753 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:29:06.642456 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:29:06.642730 [info ] [Thread-1 (]: 20 of 29 START test unique_stg_fields_field_key ................................ [RUN]
[0m02:29:06.643325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m02:29:06.643546 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:29:06.645889 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:29:06.646419 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:29:06.648372 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:29:06.649009 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:29:06.649205 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m02:29:06.649359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.665363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m02:29:06.665670 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:29:06.665863 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:29:06.667813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:06.668747 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m02:29:06.669697 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m02:29:06.670063 [info ] [Thread-1 (]: 20 of 29 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m02:29:06.670370 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:29:06.670564 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:29:06.670772 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m02:29:06.671046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m02:29:06.671212 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:29:06.673321 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:29:06.673797 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:29:06.674853 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:29:06.675238 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:29:06.675405 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m02:29:06.675553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.699606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m02:29:06.699916 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:29:06.700100 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.701618 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:29:06.702884 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m02:29:06.703584 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m02:29:06.703924 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:29:06.704201 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:29:06.704438 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:29:06.704679 [info ] [Thread-1 (]: 22 of 29 START test unique_stg_stages_stage_id ................................. [RUN]
[0m02:29:06.704909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m02:29:06.705073 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:29:06.707130 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:29:06.707619 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:29:06.708777 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:29:06.709178 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:29:06.709341 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m02:29:06.709488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.729296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:29:06.729569 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:29:06.729745 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:29:06.730812 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:29:06.731729 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m02:29:06.732543 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m02:29:06.732921 [info ] [Thread-1 (]: 22 of 29 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m02:29:06.733283 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:29:06.733483 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:29:06.733659 [info ] [Thread-1 (]: 23 of 29 START test not_null_stg_users_user_id ................................. [RUN]
[0m02:29:06.733906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m02:29:06.734090 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:29:06.736396 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:29:06.736893 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:29:06.737875 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:29:06.738227 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:29:06.738391 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m02:29:06.738536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.753943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m02:29:06.754244 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:29:06.754428 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.755577 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:29:06.756428 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m02:29:06.757093 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m02:29:06.757456 [info ] [Thread-1 (]: 23 of 29 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.02s]
[0m02:29:06.757744 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:29:06.757932 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:29:06.758101 [info ] [Thread-1 (]: 24 of 29 START test not_null_stg_users_user_name ............................... [RUN]
[0m02:29:06.758347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m02:29:06.758546 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:29:06.760634 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:29:06.761250 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:29:06.763815 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:29:06.764261 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:29:06.764582 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m02:29:06.764738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.783729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:29:06.784035 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:29:06.784246 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.785633 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:29:06.786531 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m02:29:06.787172 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m02:29:06.787517 [info ] [Thread-1 (]: 24 of 29 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m02:29:06.787807 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:29:06.788003 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:29:06.788179 [info ] [Thread-1 (]: 25 of 29 START test relationships_stg_activity_user_id__user_id__ref_stg_users_  [RUN]
[0m02:29:06.788388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02)
[0m02:29:06.788564 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:29:06.791436 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:29:06.791986 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:29:06.793417 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:29:06.793814 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:29:06.794001 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: BEGIN
[0m02:29:06.794165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.814939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:29:06.815319 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:29:06.815556 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.817679 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:06.818618 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: ROLLBACK
[0m02:29:06.819362 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: Close
[0m02:29:06.819726 [info ] [Thread-1 (]: 25 of 29 PASS relationships_stg_activity_user_id__user_id__ref_stg_users_ ...... [[32mPASS[0m in 0.03s]
[0m02:29:06.820069 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:29:06.820299 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:29:06.820534 [info ] [Thread-1 (]: 26 of 29 START test unique_stg_users_user_id ................................... [RUN]
[0m02:29:06.820913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m02:29:06.821119 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:29:06.823323 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:29:06.824018 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:29:06.825150 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:29:06.825543 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:29:06.825790 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m02:29:06.825985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.842967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:29:06.843271 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:29:06.843468 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:29:06.845084 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:29:06.845958 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m02:29:06.846664 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m02:29:06.846998 [info ] [Thread-1 (]: 26 of 29 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m02:29:06.847304 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:29:06.847608 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m02:29:06.847969 [info ] [Thread-1 (]: 27 of 29 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m02:29:06.848379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m02:29:06.848723 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m02:29:06.851338 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:29:06.851840 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m02:29:06.853794 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:29:06.854404 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:29:06.854596 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m02:29:06.854763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.880386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m02:29:06.880765 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:29:06.881041 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(value->>'id' AS INT) AS lost_reason_id -- Unique identifier for the lost reason
        , value->>'name' AS lost_reason_name -- Name of the lost reason
    FROM raw
        , jsonb_array_elements(raw.field_value_options) AS value  -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


  );
  
  
[0m02:29:06.886298 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m02:29:06.888758 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:29:06.889082 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons" rename to "stg_lost_reasons__dbt_backup"
[0m02:29:06.890508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:06.892540 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:29:06.892821 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp" rename to "stg_lost_reasons"
[0m02:29:06.894180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:06.895686 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m02:29:06.896280 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:29:06.896557 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m02:29:06.898419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:29:06.899821 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup"
[0m02:29:06.900237 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:29:06.900437 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup" cascade
[0m02:29:06.902591 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:29:06.903536 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m02:29:06.903921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d5e7931-3dcc-4434-ad9b-cd39a22b7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb95b0>]}
[0m02:29:06.904301 [info ] [Thread-1 (]: 27 of 29 OK created sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[32mSELECT 5[0m in 0.06s]
[0m02:29:06.904633 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m02:29:06.905074 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:29:06.905416 [info ] [Thread-1 (]: 28 of 29 START test not_null_stg_lost_reasons_lost_reason_id ................... [RUN]
[0m02:29:06.905835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_lost_reasons, now test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768)
[0m02:29:06.906036 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:29:06.908693 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:29:06.909293 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:29:06.910727 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:29:06.911356 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:29:06.911555 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: BEGIN
[0m02:29:06.911725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.928811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:29:06.929106 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:29:06.929304 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lost_reason_id
from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:06.930260 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:29:06.931137 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: ROLLBACK
[0m02:29:06.932016 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: Close
[0m02:29:06.932472 [info ] [Thread-1 (]: 28 of 29 PASS not_null_stg_lost_reasons_lost_reason_id ......................... [[32mPASS[0m in 0.03s]
[0m02:29:06.932839 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:29:06.933062 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:29:06.933285 [info ] [Thread-1 (]: 29 of 29 START test unique_stg_lost_reasons_lost_reason_id ..................... [RUN]
[0m02:29:06.933589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768, now test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d)
[0m02:29:06.933889 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:29:06.935995 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:29:06.936507 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:29:06.937933 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:29:06.938298 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:29:06.938461 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: BEGIN
[0m02:29:06.938612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:06.956412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:29:06.956694 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:29:06.956883 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    lost_reason_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is not null
group by lost_reason_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:29:06.959813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:29:06.960885 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: ROLLBACK
[0m02:29:06.961788 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: Close
[0m02:29:06.962159 [info ] [Thread-1 (]: 29 of 29 PASS unique_stg_lost_reasons_lost_reason_id ........................... [[32mPASS[0m in 0.03s]
[0m02:29:06.962588 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:29:06.963482 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:06.963657 [debug] [MainThread]: On master: BEGIN
[0m02:29:06.963798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:29:06.983731 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m02:29:06.984060 [debug] [MainThread]: On master: COMMIT
[0m02:29:06.984236 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:06.984382 [debug] [MainThread]: On master: COMMIT
[0m02:29:06.985121 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:29:06.985335 [debug] [MainThread]: On master: Close
[0m02:29:06.985601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:29:06.985749 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' was properly closed.
[0m02:29:06.985958 [info ] [MainThread]: 
[0m02:29:06.986128 [info ] [MainThread]: Finished running 7 incremental models, 22 data tests in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m02:29:06.988081 [debug] [MainThread]: Command end result
[0m02:29:07.005641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:29:07.006786 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:29:07.010430 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m02:29:07.010601 [info ] [MainThread]: 
[0m02:29:07.010782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:29:07.010928 [info ] [MainThread]: 
[0m02:29:07.011076 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=29
[0m02:29:07.012746 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.0943286, "process_in_blocks": "0", "process_kernel_time": 0.331513, "process_mem_max_rss": "133332992", "process_out_blocks": "0", "process_user_time": 1.678313}
[0m02:29:07.012968 [debug] [MainThread]: Command `dbt build` succeeded at 02:29:07.012927 after 2.09 seconds
[0m02:29:07.013143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a528d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8f8f0>]}
[0m02:29:07.013309 [debug] [MainThread]: Flushing usage events
[0m02:29:09.007794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:11.750929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110637b10>]}


============================== 02:29:11.754116 | 60a50af2-c435-45f6-b399-39aa1468c4d3 ==============================
[0m02:29:11.754116 [info ] [MainThread]: Running with dbt=1.10.11
[0m02:29:11.754455 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt build -s tag:intermediate -f', 'partial_parse': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m02:29:11.855742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60a50af2-c435-45f6-b399-39aa1468c4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a33e10>]}
[0m02:29:11.884944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60a50af2-c435-45f6-b399-39aa1468c4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b3bd0>]}
[0m02:29:11.885831 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:29:11.933716 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m02:29:12.010446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:29:12.010678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:29:12.034159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60a50af2-c435-45f6-b399-39aa1468c4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119cf350>]}
[0m02:29:12.080668 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:29:12.081909 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:29:12.106277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60a50af2-c435-45f6-b399-39aa1468c4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c76d50>]}
[0m02:29:12.106567 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m02:29:12.107763 [info ] [MainThread]: 
[0m02:29:12.107944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:29:12.108076 [info ] [MainThread]: 
[0m02:29:12.108315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:29:12.110107 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:29:12.166100 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:29:12.166351 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:29:12.166509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:12.198966 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.032 seconds
[0m02:29:12.199819 [debug] [ThreadPool]: On list_postgres: Close
[0m02:29:12.200731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m02:29:12.203584 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:29:12.203747 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:29:12.203876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:29:12.224639 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m02:29:12.224840 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:29:12.225004 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:29:12.228357 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m02:29:12.229206 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:29:12.229863 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:29:12.233380 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:12.233583 [debug] [MainThread]: On master: BEGIN
[0m02:29:12.233725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:29:12.252429 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m02:29:12.252710 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:12.252939 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:29:12.255387 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m02:29:12.256203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a50af2-c435-45f6-b399-39aa1468c4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d47930>]}
[0m02:29:12.256507 [debug] [MainThread]: On master: ROLLBACK
[0m02:29:12.257251 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:12.257428 [debug] [MainThread]: On master: BEGIN
[0m02:29:12.259112 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:29:12.259361 [debug] [MainThread]: On master: COMMIT
[0m02:29:12.259546 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:12.259707 [debug] [MainThread]: On master: COMMIT
[0m02:29:12.260461 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:29:12.260688 [debug] [MainThread]: On master: Close
[0m02:29:12.263193 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity
[0m02:29:12.300500 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_analytics.int_activity ..... [RUN]
[0m02:29:12.300887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.int_activity)
[0m02:29:12.301082 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity
[0m02:29:12.308164 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity"
[0m02:29:12.308963 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activity
[0m02:29:12.339342 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activity"
[0m02:29:12.340139 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:29:12.340347 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: BEGIN
[0m02:29:12.340529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:12.364582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m02:29:12.364968 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:29:12.365241 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp"
  
  
    as
  
  (
    

-- Intermediate model that enriches activities with descriptive user and activity type information. 
-- Keeps 1 row per activity_id (deduped in stg_activity).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_activity"
),

user_enriched AS (
    SELECT
        b.activity_id
        , b.deal_id
        , b.user_id
        , u.user_name
        , u.user_email
        , b.activity_type_short
        , b.is_activity_done_status
        , b.activity_due_timestamp
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_users" u
      ON b.user_id = u.user_id
),

activity_type_enriched AS (
    SELECT
        ue.*
        , at.activity_type_name
        , at.is_activity_type_active
    FROM user_enriched ue
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_activity_types" at
      ON ue.activity_type_short = at.activity_type_short
)

SELECT *
FROM activity_type_enriched


  );
  
  
[0m02:29:12.385610 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.020 seconds
[0m02:29:12.394156 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:29:12.394450 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity" rename to "int_activity__dbt_backup"
[0m02:29:12.395733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:12.397367 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:29:12.397642 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp" rename to "int_activity"
[0m02:29:12.398851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:12.410012 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m02:29:12.410354 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:29:12.410536 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m02:29:12.414470 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m02:29:12.418567 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup"
[0m02:29:12.421432 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:29:12.421718 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup" cascade
[0m02:29:12.426319 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:29:12.428046 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: Close
[0m02:29:12.429880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a50af2-c435-45f6-b399-39aa1468c4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129d3ba0>]}
[0m02:29:12.431157 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model public_pipedrive_analytics.int_activity  [[32mSELECT 4568[0m in 0.13s]
[0m02:29:12.432115 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity
[0m02:29:12.433050 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes
[0m02:29:12.433480 [info ] [Thread-1 (]: 2 of 7 START sql incremental model public_pipedrive_analytics.int_deal_changes . [RUN]
[0m02:29:12.434282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity, now model.enpal_assessment_project.int_deal_changes)
[0m02:29:12.434531 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes
[0m02:29:12.437086 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes"
[0m02:29:12.437739 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes
[0m02:29:12.442901 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes"
[0m02:29:12.444836 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:29:12.445270 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: BEGIN
[0m02:29:12.445465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:12.469690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m02:29:12.470019 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:29:12.470257 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Intermediate model that enriches deal changes with descriptive fields such as stage name or lost reason name. 
-- Keeps 1 row per deal change (normalized, auditable history).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_deal_changes"
),

-- Bring in stage names when the change refers to stage_id
stage_enriched AS (
    SELECT
        b.deal_id_sk
        , b.deal_id
        , b.deal_change_timestamp
        , b.deal_updated_field_key
        , b.deal_new_value
        , s.stage_name
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_stages" s
      ON b.deal_updated_field_key = 'stage_id'
     AND b.deal_new_value = CAST(s.stage_id AS TEXT)
),

-- Bring in lost reason names when the change refers to lost_reason
lost_reason_enriched AS (
    SELECT
        se.*
        , lr.lost_reason_name
    FROM stage_enriched se
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_lost_reasons" lr
      ON se.deal_updated_field_key = 'lost_reason'
     AND se.deal_new_value = CAST(lr.lost_reason_id AS TEXT)
),

final AS (
    SELECT
        deal_id_sk
        , deal_id
        , deal_change_timestamp
        , deal_updated_field_key
        , deal_new_value
        , stage_name
        , lost_reason_name
        , dwh_creation_timestamp
        , dwh_modified_timestamp
    FROM lost_reason_enriched
)

SELECT *
FROM final


  );
  
  
[0m02:29:12.526487 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.056 seconds
[0m02:29:12.529046 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:29:12.529329 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes" rename to "int_deal_changes__dbt_backup"
[0m02:29:12.530639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:12.532387 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:29:12.532645 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_tmp" rename to "int_deal_changes"
[0m02:29:12.534041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:29:12.534906 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m02:29:12.535097 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:29:12.535725 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m02:29:12.542653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m02:29:12.543906 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_backup"
[0m02:29:12.544259 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:29:12.544429 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_backup" cascade
[0m02:29:12.547648 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:29:12.548643 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: Close
[0m02:29:12.549108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a50af2-c435-45f6-b399-39aa1468c4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d1fa10>]}
[0m02:29:12.549533 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model public_pipedrive_analytics.int_deal_changes  [[32mSELECT 15406[0m in 0.11s]
[0m02:29:12.549985 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes
[0m02:29:12.550224 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m02:29:12.550484 [info ] [Thread-1 (]: 3 of 7 START test not_null_int_activity_activity_id ............................ [RUN]
[0m02:29:12.550882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes, now test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f)
[0m02:29:12.551090 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m02:29:12.558671 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m02:29:12.559405 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m02:29:12.572893 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m02:29:12.573672 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m02:29:12.573893 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: BEGIN
[0m02:29:12.574062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:12.599508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m02:29:12.599772 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m02:29:12.599951 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:12.602458 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:12.604429 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: ROLLBACK
[0m02:29:12.605391 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: Close
[0m02:29:12.605877 [info ] [Thread-1 (]: 3 of 7 PASS not_null_int_activity_activity_id .................................. [[32mPASS[0m in 0.05s]
[0m02:29:12.606420 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m02:29:12.606884 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m02:29:12.607194 [info ] [Thread-1 (]: 4 of 7 START test unique_int_activity_activity_id .............................. [RUN]
[0m02:29:12.607718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f, now test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e)
[0m02:29:12.608009 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m02:29:12.611627 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m02:29:12.612760 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m02:29:12.615166 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m02:29:12.615834 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m02:29:12.616023 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: BEGIN
[0m02:29:12.616184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:12.640516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m02:29:12.640844 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m02:29:12.641052 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:29:12.644894 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:29:12.645928 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: ROLLBACK
[0m02:29:12.646952 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: Close
[0m02:29:12.647452 [info ] [Thread-1 (]: 4 of 7 PASS unique_int_activity_activity_id .................................... [[32mPASS[0m in 0.04s]
[0m02:29:12.647973 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m02:29:12.648428 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m02:29:12.648771 [info ] [Thread-1 (]: 5 of 7 START test not_null_int_deal_changes_deal_id ............................ [RUN]
[0m02:29:12.649166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1)
[0m02:29:12.649355 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m02:29:12.652608 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m02:29:12.653944 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m02:29:12.655553 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m02:29:12.656200 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m02:29:12.656397 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: BEGIN
[0m02:29:12.656552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:12.680571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m02:29:12.680874 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m02:29:12.681184 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:12.683970 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:29:12.684873 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: ROLLBACK
[0m02:29:12.685526 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: Close
[0m02:29:12.685862 [info ] [Thread-1 (]: 5 of 7 PASS not_null_int_deal_changes_deal_id .................................. [[32mPASS[0m in 0.04s]
[0m02:29:12.686280 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m02:29:12.686519 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m02:29:12.686752 [info ] [Thread-1 (]: 6 of 7 START test not_null_int_deal_changes_deal_id_sk ......................... [RUN]
[0m02:29:12.687093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813)
[0m02:29:12.687307 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m02:29:12.689865 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m02:29:12.690405 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m02:29:12.691567 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m02:29:12.692242 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m02:29:12.692437 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: BEGIN
[0m02:29:12.692598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:12.712958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:29:12.713263 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m02:29:12.713450 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m02:29:12.715722 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:29:12.716608 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: ROLLBACK
[0m02:29:12.717369 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: Close
[0m02:29:12.717706 [info ] [Thread-1 (]: 6 of 7 PASS not_null_int_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.03s]
[0m02:29:12.717978 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m02:29:12.718157 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m02:29:12.718381 [info ] [Thread-1 (]: 7 of 7 START test unique_int_deal_changes_deal_id_sk ........................... [RUN]
[0m02:29:12.718638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813, now test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a)
[0m02:29:12.718803 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m02:29:12.721160 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m02:29:12.721701 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m02:29:12.722757 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m02:29:12.723138 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m02:29:12.723370 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: BEGIN
[0m02:29:12.723519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:12.743642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:29:12.743944 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m02:29:12.744144 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:29:12.751743 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m02:29:12.752702 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: ROLLBACK
[0m02:29:12.753523 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: Close
[0m02:29:12.753869 [info ] [Thread-1 (]: 7 of 7 PASS unique_int_deal_changes_deal_id_sk ................................. [[32mPASS[0m in 0.04s]
[0m02:29:12.754220 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m02:29:12.754976 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:12.755140 [debug] [MainThread]: On master: BEGIN
[0m02:29:12.755269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:29:12.776606 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m02:29:12.776914 [debug] [MainThread]: On master: COMMIT
[0m02:29:12.777070 [debug] [MainThread]: Using postgres connection "master"
[0m02:29:12.777197 [debug] [MainThread]: On master: COMMIT
[0m02:29:12.777889 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:29:12.778076 [debug] [MainThread]: On master: Close
[0m02:29:12.778327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:29:12.778466 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a' was properly closed.
[0m02:29:12.778649 [info ] [MainThread]: 
[0m02:29:12.778811 [info ] [MainThread]: Finished running 2 incremental models, 5 data tests in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m02:29:12.779575 [debug] [MainThread]: Command end result
[0m02:29:12.797776 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:29:12.799097 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:29:12.803308 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m02:29:12.803794 [info ] [MainThread]: 
[0m02:29:12.804093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:29:12.804297 [info ] [MainThread]: 
[0m02:29:12.804497 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m02:29:12.806706 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0953649, "process_in_blocks": "0", "process_kernel_time": 0.247705, "process_mem_max_rss": "130596864", "process_out_blocks": "0", "process_user_time": 1.268031}
[0m02:29:12.807121 [debug] [MainThread]: Command `dbt build` succeeded at 02:29:12.806953 after 1.10 seconds
[0m02:29:12.807357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113644b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103eb390>]}
[0m02:29:12.807557 [debug] [MainThread]: Flushing usage events
[0m02:29:14.135947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:30:14.493034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068179d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106817b10>]}


============================== 02:30:14.496760 | 20833fea-78a1-45c4-864b-d1c03a1f38fb ==============================
[0m02:30:14.496760 [info ] [MainThread]: Running with dbt=1.10.11
[0m02:30:14.497111 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'empty': 'False', 'write_json': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'invocation_command': 'dbt build -s tag:staging -f', 'target_path': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True'}
[0m02:30:14.623453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b17e10>]}
[0m02:30:14.653872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106697bd0>]}
[0m02:30:14.654538 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:30:14.717346 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m02:30:14.801471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:30:14.801950 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m02:30:15.041991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107561050>]}
[0m02:30:15.087967 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:30:15.090225 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:30:15.112180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794f4d0>]}
[0m02:30:15.112462 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m02:30:15.113861 [info ] [MainThread]: 
[0m02:30:15.114040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:30:15.114183 [info ] [MainThread]: 
[0m02:30:15.114419 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:30:15.116429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:30:15.169455 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:30:15.169692 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:30:15.169835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:15.228252 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.058 seconds
[0m02:30:15.229175 [debug] [ThreadPool]: On list_postgres: Close
[0m02:30:15.230270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m02:30:15.233533 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:30:15.233742 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:30:15.233887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:15.254773 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m02:30:15.255119 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:30:15.255325 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:30:15.263845 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m02:30:15.264809 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:30:15.265642 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:30:15.269471 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:15.269716 [debug] [MainThread]: On master: BEGIN
[0m02:30:15.269853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:15.288454 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m02:30:15.288718 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:15.288919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:30:15.292418 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m02:30:15.293710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f9710>]}
[0m02:30:15.294040 [debug] [MainThread]: On master: ROLLBACK
[0m02:30:15.294815 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:15.294977 [debug] [MainThread]: On master: BEGIN
[0m02:30:15.296188 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:30:15.296339 [debug] [MainThread]: On master: COMMIT
[0m02:30:15.296480 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:15.296614 [debug] [MainThread]: On master: COMMIT
[0m02:30:15.297163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:30:15.297308 [debug] [MainThread]: On master: Close
[0m02:30:15.299138 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m02:30:15.299468 [info ] [Thread-1 (]: 1 of 29 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m02:30:15.299725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m02:30:15.299923 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m02:30:15.306104 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m02:30:15.306899 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m02:30:15.335386 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m02:30:15.336152 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:30:15.336332 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m02:30:15.336479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.358161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:30:15.358416 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:30:15.358619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM (
        SELECT *,
               ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) AS rn
        FROM raw
    ) t
    WHERE rn = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:30:15.377670 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.019 seconds
[0m02:30:15.384087 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:30:15.384409 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m02:30:15.385802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.387921 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:30:15.388223 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m02:30:15.389310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.399068 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:30:15.399391 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:30:15.399566 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:30:15.402325 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:30:15.406000 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m02:30:15.408533 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:30:15.408748 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m02:30:15.411901 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:30:15.413348 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m02:30:15.414741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e186d0>]}
[0m02:30:15.415179 [info ] [Thread-1 (]: 1 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity  [[32mSELECT 4568[0m in 0.11s]
[0m02:30:15.415499 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m02:30:15.415719 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m02:30:15.416027 [info ] [Thread-1 (]: 2 of 29 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m02:30:15.416358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m02:30:15.416556 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m02:30:15.418628 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m02:30:15.419142 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m02:30:15.421328 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m02:30:15.421818 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:30:15.421997 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m02:30:15.422156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.441235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:30:15.441560 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:30:15.441773 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:30:15.444089 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m02:30:15.445876 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:30:15.446082 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m02:30:15.446984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.448426 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:30:15.448621 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m02:30:15.449471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.450254 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:30:15.450436 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:30:15.450597 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:30:15.451737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:30:15.453137 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m02:30:15.453474 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:30:15.453647 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m02:30:15.455122 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:30:15.455864 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m02:30:15.456203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e5610>]}
[0m02:30:15.456564 [info ] [Thread-1 (]: 2 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mSELECT 4[0m in 0.04s]
[0m02:30:15.456869 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m02:30:15.457083 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m02:30:15.457401 [info ] [Thread-1 (]: 3 of 29 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m02:30:15.457761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m02:30:15.458052 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m02:30:15.460232 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:30:15.460714 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m02:30:15.462902 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:30:15.463336 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:30:15.463508 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m02:30:15.463675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.487835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m02:30:15.488171 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:30:15.488404 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m02:30:15.514752 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.026 seconds
[0m02:30:15.516857 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:30:15.517098 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m02:30:15.518294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.519878 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:30:15.520098 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m02:30:15.520791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:30:15.521657 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:30:15.521864 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:30:15.522045 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:30:15.546475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m02:30:15.549513 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m02:30:15.550003 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:30:15.550237 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m02:30:15.554133 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:30:15.555116 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m02:30:15.555483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f1860>]}
[0m02:30:15.555855 [info ] [Thread-1 (]: 3 of 29 OK created sql incremental model public_pipedrive_analytics.stg_deal_changes  [[32mSELECT 15406[0m in 0.10s]
[0m02:30:15.556159 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m02:30:15.556527 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m02:30:15.556839 [info ] [Thread-1 (]: 4 of 29 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m02:30:15.557207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m02:30:15.557478 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m02:30:15.559907 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m02:30:15.560447 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m02:30:15.563642 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m02:30:15.564398 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:30:15.564618 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m02:30:15.564785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.588353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:30:15.588719 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:30:15.588952 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:30:15.591809 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m02:30:15.593448 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:30:15.593629 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m02:30:15.594394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.595657 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:30:15.595819 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m02:30:15.596500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:30:15.597708 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:30:15.597925 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:30:15.598105 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:30:15.599570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:30:15.600648 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup"
[0m02:30:15.601007 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:30:15.601190 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m02:30:15.603237 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:30:15.604023 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m02:30:15.604358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfecb0>]}
[0m02:30:15.604723 [info ] [Thread-1 (]: 4 of 29 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mSELECT 4[0m in 0.05s]
[0m02:30:15.605018 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m02:30:15.605222 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m02:30:15.605496 [info ] [Thread-1 (]: 5 of 29 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m02:30:15.605887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m02:30:15.606133 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m02:30:15.608317 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m02:30:15.609029 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m02:30:15.612966 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m02:30:15.613603 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:30:15.613783 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m02:30:15.613943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.630736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:30:15.631045 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:30:15.631260 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:30:15.632901 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m02:30:15.634599 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:30:15.634800 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m02:30:15.635605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.637035 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:30:15.637220 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m02:30:15.637982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.638769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:30:15.638946 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:30:15.639468 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:30:15.640444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:30:15.641494 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m02:30:15.641824 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:30:15.641993 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m02:30:15.644219 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:30:15.645026 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m02:30:15.645340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c963d0>]}
[0m02:30:15.645671 [info ] [Thread-1 (]: 5 of 29 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mSELECT 9[0m in 0.04s]
[0m02:30:15.645944 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m02:30:15.646135 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m02:30:15.646389 [info ] [Thread-1 (]: 6 of 29 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m02:30:15.646597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m02:30:15.646852 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m02:30:15.649023 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m02:30:15.649505 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m02:30:15.651728 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m02:30:15.652206 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:30:15.652376 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m02:30:15.652527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.668037 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m02:30:15.668326 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:30:15.668515 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


  );
  
  
[0m02:30:15.672760 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.004 seconds
[0m02:30:15.674461 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:30:15.674654 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m02:30:15.675694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.677706 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:30:15.677952 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m02:30:15.678859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:30:15.679671 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:30:15.680225 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:30:15.680398 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:30:15.683605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:30:15.684834 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m02:30:15.685172 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:30:15.685336 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m02:30:15.687354 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:30:15.688087 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m02:30:15.688386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebcfa0>]}
[0m02:30:15.688719 [info ] [Thread-1 (]: 6 of 29 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mSELECT 1787[0m in 0.04s]
[0m02:30:15.688997 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m02:30:15.689192 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:30:15.689407 [info ] [Thread-1 (]: 7 of 29 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m02:30:15.689687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m02:30:15.689976 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:30:15.696482 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:30:15.697335 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:30:15.706677 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:30:15.707445 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:30:15.707601 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m02:30:15.707735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.724466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:30:15.724754 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:30:15.724947 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:15.726361 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:30:15.728257 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m02:30:15.728945 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m02:30:15.729284 [info ] [Thread-1 (]: 7 of 29 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.04s]
[0m02:30:15.729562 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:30:15.729757 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:30:15.729932 [info ] [Thread-1 (]: 8 of 29 START test not_null_stg_activity_activity_type_short ................... [RUN]
[0m02:30:15.730135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844)
[0m02:30:15.730301 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:30:15.732425 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:30:15.732981 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:30:15.734407 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:30:15.734939 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:30:15.735121 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: BEGIN
[0m02:30:15.735279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.752390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:30:15.752690 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:30:15.752894 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_short
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_type_short is null



  
  
      
    ) dbt_internal_test
[0m02:30:15.755350 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:30:15.756233 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: ROLLBACK
[0m02:30:15.756774 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: Close
[0m02:30:15.757115 [info ] [Thread-1 (]: 8 of 29 PASS not_null_stg_activity_activity_type_short ......................... [[32mPASS[0m in 0.03s]
[0m02:30:15.757400 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:30:15.757597 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:30:15.757766 [info ] [Thread-1 (]: 9 of 29 START test not_null_stg_activity_user_id ............................... [RUN]
[0m02:30:15.758022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844, now test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272)
[0m02:30:15.758320 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:30:15.760462 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:30:15.761007 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:30:15.762073 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:30:15.762444 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:30:15.762613 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: BEGIN
[0m02:30:15.762764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.782552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:30:15.782852 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:30:15.783047 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:15.784276 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:30:15.785136 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: ROLLBACK
[0m02:30:15.785781 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: Close
[0m02:30:15.786353 [info ] [Thread-1 (]: 9 of 29 PASS not_null_stg_activity_user_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:30:15.786732 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:30:15.786967 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:30:15.787213 [info ] [Thread-1 (]: 10 of 29 START test unique_stg_activity_activity_id ............................ [RUN]
[0m02:30:15.787517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m02:30:15.787732 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:30:15.791843 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:30:15.792476 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:30:15.793708 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:30:15.794180 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:30:15.794367 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m02:30:15.794642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.814612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:30:15.814934 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:30:15.815135 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:30:15.817671 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:30:15.818660 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m02:30:15.819568 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m02:30:15.819942 [info ] [Thread-1 (]: 10 of 29 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.03s]
[0m02:30:15.820243 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:30:15.820441 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:30:15.820663 [info ] [Thread-1 (]: 11 of 29 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m02:30:15.820918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m02:30:15.821097 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:30:15.823642 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:30:15.824267 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:30:15.825799 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:30:15.826402 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:30:15.826591 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m02:30:15.826754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.846000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:30:15.846302 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:30:15.846495 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:15.847474 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:30:15.848374 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m02:30:15.849012 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m02:30:15.849350 [info ] [Thread-1 (]: 11 of 29 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m02:30:15.849635 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:30:15.849829 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:30:15.850007 [info ] [Thread-1 (]: 12 of 29 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m02:30:15.850265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m02:30:15.850512 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:30:15.855067 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:30:15.855641 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:30:15.857167 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:30:15.857606 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:30:15.857790 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m02:30:15.857957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.884786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m02:30:15.885113 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:30:15.885341 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:30:15.887659 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:30:15.888672 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m02:30:15.889455 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m02:30:15.889843 [info ] [Thread-1 (]: 12 of 29 PASS relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[32mPASS[0m in 0.04s]
[0m02:30:15.890165 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:30:15.890378 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:30:15.890615 [info ] [Thread-1 (]: 13 of 29 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m02:30:15.890884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m02:30:15.891072 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:30:15.893491 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:30:15.894079 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:30:15.895202 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:30:15.895766 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:30:15.895980 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m02:30:15.896172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.913932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:30:15.914226 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:30:15.914426 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:30:15.915521 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:30:15.916360 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m02:30:15.917001 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m02:30:15.917335 [info ] [Thread-1 (]: 13 of 29 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m02:30:15.917748 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:30:15.917991 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:30:15.918211 [info ] [Thread-1 (]: 14 of 29 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m02:30:15.918440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m02:30:15.918618 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:30:15.921213 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:30:15.921839 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:30:15.922911 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:30:15.923270 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:30:15.923440 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m02:30:15.923593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.940916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:30:15.941208 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:30:15.941404 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:15.943701 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:30:15.944613 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m02:30:15.945222 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m02:30:15.945552 [info ] [Thread-1 (]: 14 of 29 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m02:30:15.945829 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:30:15.946017 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:30:15.946189 [info ] [Thread-1 (]: 15 of 29 START test not_null_stg_deal_changes_deal_id_sk ....................... [RUN]
[0m02:30:15.946481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e)
[0m02:30:15.946699 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:30:15.949282 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:30:15.949829 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:30:15.950948 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:30:15.951325 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:30:15.951499 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: BEGIN
[0m02:30:15.951654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:15.972568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:30:15.972907 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:30:15.973191 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m02:30:15.975271 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:30:15.976523 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: ROLLBACK
[0m02:30:15.977618 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: Close
[0m02:30:15.978043 [info ] [Thread-1 (]: 15 of 29 PASS not_null_stg_deal_changes_deal_id_sk ............................. [[32mPASS[0m in 0.03s]
[0m02:30:15.978369 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:30:15.978584 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:30:15.978839 [info ] [Thread-1 (]: 16 of 29 START test not_null_stg_deal_changes_deal_updated_field_key ........... [RUN]
[0m02:30:15.979143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624)
[0m02:30:15.979358 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:30:15.981706 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:30:15.982296 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:30:15.983958 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:30:15.984466 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:30:15.984656 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: BEGIN
[0m02:30:15.984821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.005893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:30:16.006197 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:30:16.006400 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_updated_field_key
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_updated_field_key is null



  
  
      
    ) dbt_internal_test
[0m02:30:16.008401 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:30:16.009521 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: ROLLBACK
[0m02:30:16.012649 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: Close
[0m02:30:16.013077 [info ] [Thread-1 (]: 16 of 29 PASS not_null_stg_deal_changes_deal_updated_field_key ................. [[32mPASS[0m in 0.03s]
[0m02:30:16.013411 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:30:16.013621 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:30:16.013867 [info ] [Thread-1 (]: 17 of 29 START test unique_stg_deal_changes_deal_id_sk ......................... [RUN]
[0m02:30:16.014169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624, now test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600)
[0m02:30:16.014383 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:30:16.016639 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:30:16.017318 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:30:16.018512 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:30:16.019037 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:30:16.019221 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: BEGIN
[0m02:30:16.019480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.038316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:30:16.038605 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:30:16.038803 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:30:16.044939 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m02:30:16.045967 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: ROLLBACK
[0m02:30:16.046775 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: Close
[0m02:30:16.047138 [info ] [Thread-1 (]: 17 of 29 PASS unique_stg_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.03s]
[0m02:30:16.047451 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:30:16.047655 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:30:16.047896 [info ] [Thread-1 (]: 18 of 29 START test not_null_stg_fields_field_key .............................. [RUN]
[0m02:30:16.048156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m02:30:16.048333 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:30:16.052126 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:30:16.052821 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:30:16.054042 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:30:16.054506 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:30:16.054699 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m02:30:16.054866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.071962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:30:16.072273 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:30:16.072473 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m02:30:16.073683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:30:16.074610 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m02:30:16.075448 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m02:30:16.075869 [info ] [Thread-1 (]: 18 of 29 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m02:30:16.076384 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:30:16.076665 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:30:16.076941 [info ] [Thread-1 (]: 19 of 29 START test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [RUN]
[0m02:30:16.077248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa)
[0m02:30:16.077449 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:30:16.080832 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:30:16.081487 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:30:16.082549 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:30:16.082964 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:30:16.083136 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: BEGIN
[0m02:30:16.083286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.100943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:30:16.101236 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:30:16.101444 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_updated_field_key as from_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where deal_updated_field_key is not null
),

parent as (
    select field_key as to_field
    from "postgres"."public_pipedrive_analytics"."stg_fields"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:30:16.104583 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:30:16.105479 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: ROLLBACK
[0m02:30:16.106133 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: Close
[0m02:30:16.106496 [info ] [Thread-1 (]: 19 of 29 PASS relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[32mPASS[0m in 0.03s]
[0m02:30:16.106792 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:30:16.106996 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:30:16.107217 [info ] [Thread-1 (]: 20 of 29 START test unique_stg_fields_field_key ................................ [RUN]
[0m02:30:16.107441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m02:30:16.107625 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:30:16.111366 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:30:16.111892 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:30:16.113469 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:30:16.113894 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:30:16.114117 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m02:30:16.114294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.137731 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:30:16.138023 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:30:16.138238 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:30:16.139583 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:30:16.140547 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m02:30:16.141454 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m02:30:16.141842 [info ] [Thread-1 (]: 20 of 29 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m02:30:16.142489 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:30:16.142788 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:30:16.143062 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m02:30:16.143375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m02:30:16.143579 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:30:16.145972 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:30:16.146497 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:30:16.147645 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:30:16.148151 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:30:16.148340 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m02:30:16.148503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.168877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:30:16.169138 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:30:16.169305 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:16.170376 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:30:16.171203 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m02:30:16.172000 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m02:30:16.172323 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:30:16.172602 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:30:16.172785 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:30:16.172983 [info ] [Thread-1 (]: 22 of 29 START test unique_stg_stages_stage_id ................................. [RUN]
[0m02:30:16.173181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m02:30:16.173344 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:30:16.175755 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:30:16.176308 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:30:16.177468 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:30:16.177881 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:30:16.178055 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m02:30:16.178212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.201779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:30:16.202105 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:30:16.202411 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:30:16.204873 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:30:16.205910 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m02:30:16.206664 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m02:30:16.207270 [info ] [Thread-1 (]: 22 of 29 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m02:30:16.207637 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:30:16.207864 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:30:16.208084 [info ] [Thread-1 (]: 23 of 29 START test not_null_stg_users_user_id ................................. [RUN]
[0m02:30:16.208702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m02:30:16.208909 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:30:16.211890 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:30:16.212480 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:30:16.213681 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:30:16.214197 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:30:16.214419 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m02:30:16.214591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.242810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m02:30:16.243133 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:30:16.243364 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:16.244909 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:30:16.245810 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m02:30:16.246602 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m02:30:16.247009 [info ] [Thread-1 (]: 23 of 29 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m02:30:16.247517 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:30:16.247762 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:30:16.247994 [info ] [Thread-1 (]: 24 of 29 START test not_null_stg_users_user_name ............................... [RUN]
[0m02:30:16.248241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m02:30:16.248426 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:30:16.250748 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:30:16.251429 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:30:16.253009 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:30:16.253463 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:30:16.253690 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m02:30:16.253869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.280772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m02:30:16.281083 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:30:16.281302 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m02:30:16.282749 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:30:16.283773 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m02:30:16.284735 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m02:30:16.285244 [info ] [Thread-1 (]: 24 of 29 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.04s]
[0m02:30:16.285592 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:30:16.285808 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:30:16.286039 [info ] [Thread-1 (]: 25 of 29 START test relationships_stg_activity_user_id__user_id__ref_stg_users_  [RUN]
[0m02:30:16.286318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02)
[0m02:30:16.286606 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:30:16.289880 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:30:16.290455 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:30:16.291684 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:30:16.292183 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:30:16.292386 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: BEGIN
[0m02:30:16.292560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.314076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:30:16.314374 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:30:16.314591 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:30:16.317071 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:30:16.318049 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: ROLLBACK
[0m02:30:16.318846 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: Close
[0m02:30:16.319233 [info ] [Thread-1 (]: 25 of 29 PASS relationships_stg_activity_user_id__user_id__ref_stg_users_ ...... [[32mPASS[0m in 0.03s]
[0m02:30:16.319546 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:30:16.319765 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:30:16.320029 [info ] [Thread-1 (]: 26 of 29 START test unique_stg_users_user_id ................................... [RUN]
[0m02:30:16.320337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m02:30:16.320559 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:30:16.323430 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:30:16.323961 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:30:16.325261 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:30:16.325691 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:30:16.325871 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m02:30:16.326030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.347617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:30:16.347913 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:30:16.348109 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:30:16.349924 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:30:16.350819 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m02:30:16.351643 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m02:30:16.351991 [info ] [Thread-1 (]: 26 of 29 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m02:30:16.352379 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:30:16.352645 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m02:30:16.352959 [info ] [Thread-1 (]: 27 of 29 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m02:30:16.353253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m02:30:16.353548 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m02:30:16.356154 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:30:16.356828 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m02:30:16.358908 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:30:16.359648 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:30:16.359844 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m02:30:16.360016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:16.391441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m02:30:16.391760 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:30:16.392000 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(value->>'id' AS INT) AS lost_reason_id -- Unique identifier for the lost reason
         v.value->>'label' AS lost_reason_name  -- Name of the lost reason
    FROM raw
    JOIN LATERAL jsonb_array_elements(raw.field_value_options) AS v(value) ON TRUE -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


  );
  
  
[0m02:30:16.393075 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "v"
LINE 28:          v.value->>'label' AS lost_reason_name  -- Name of t...
                  ^

[0m02:30:16.393398 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: ROLLBACK
[0m02:30:16.394268 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m02:30:16.401439 [debug] [Thread-1 (]: Database Error in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)
  syntax error at or near "v"
  LINE 28:          v.value->>'label' AS lost_reason_name  -- Name of t...
                    ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_lost_reasons.sql
[0m02:30:16.401782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20833fea-78a1-45c4-864b-d1c03a1f38fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7fdd0>]}
[0m02:30:16.402139 [error] [Thread-1 (]: 27 of 29 ERROR creating sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[31mERROR[0m in 0.05s]
[0m02:30:16.402453 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m02:30:16.402737 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_lost_reasons' to be skipped because of status 'error'.  Reason: Database Error in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)
  syntax error at or near "v"
  LINE 28:          v.value->>'label' AS lost_reason_name  -- Name of t...
                    ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_lost_reasons.sql.
[0m02:30:16.403348 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:30:16.403641 [info ] [Thread-1 (]: 28 of 29 SKIP test not_null_stg_lost_reasons_lost_reason_id .................... [[33mSKIP[0m]
[0m02:30:16.403922 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:30:16.404119 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:30:16.404284 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768' to be skipped because of status 'skipped'. 
[0m02:30:16.404493 [info ] [Thread-1 (]: 29 of 29 SKIP test unique_stg_lost_reasons_lost_reason_id ...................... [[33mSKIP[0m]
[0m02:30:16.404749 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:30:16.404913 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' to be skipped because of status 'skipped'. 
[0m02:30:16.405566 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:16.405720 [debug] [MainThread]: On master: BEGIN
[0m02:30:16.405856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:30:16.425812 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m02:30:16.426097 [debug] [MainThread]: On master: COMMIT
[0m02:30:16.426256 [debug] [MainThread]: Using postgres connection "master"
[0m02:30:16.426393 [debug] [MainThread]: On master: COMMIT
[0m02:30:16.426934 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:30:16.427072 [debug] [MainThread]: On master: Close
[0m02:30:16.427286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:16.427440 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_lost_reasons' was properly closed.
[0m02:30:16.427686 [info ] [MainThread]: 
[0m02:30:16.427867 [info ] [MainThread]: Finished running 7 incremental models, 22 data tests in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m02:30:16.429673 [debug] [MainThread]: Command end result
[0m02:30:16.446190 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:30:16.447371 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:30:16.450903 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m02:30:16.451070 [info ] [MainThread]: 
[0m02:30:16.451236 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:30:16.451378 [info ] [MainThread]: 
[0m02:30:16.451554 [error] [MainThread]: [31mFailure in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)[0m
[0m02:30:16.451721 [error] [MainThread]:   Database Error in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)
  syntax error at or near "v"
  LINE 28:          v.value->>'label' AS lost_reason_name  -- Name of t...
                    ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_lost_reasons.sql
[0m02:30:16.451841 [info ] [MainThread]: 
[0m02:30:16.451988 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_lost_reasons.sql
[0m02:30:16.452117 [info ] [MainThread]: 
[0m02:30:16.452256 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=29
[0m02:30:16.455088 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.0414631, "process_in_blocks": "0", "process_kernel_time": 0.323441, "process_mem_max_rss": "135184384", "process_out_blocks": "0", "process_user_time": 1.711434}
[0m02:30:16.455311 [debug] [MainThread]: Command `dbt build` failed at 02:30:16.455271 after 2.04 seconds
[0m02:30:16.455506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066aa870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e840b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e84050>]}
[0m02:30:16.455678 [debug] [MainThread]: Flushing usage events
[0m02:30:19.134688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:31:19.053690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f33b10>]}


============================== 02:31:19.057868 | 54b07649-8069-4eff-bf0e-bfa39ca77a23 ==============================
[0m02:31:19.057868 [info ] [MainThread]: Running with dbt=1.10.11
[0m02:31:19.058252 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt build -s tag:staging -f', 'quiet': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:31:19.171259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106233e10>]}
[0m02:31:19.199691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b3bd0>]}
[0m02:31:19.200363 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:31:19.251935 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m02:31:19.333018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:31:19.333452 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m02:31:19.572162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adcd350>]}
[0m02:31:19.620793 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:31:19.622260 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:31:19.643907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af43890>]}
[0m02:31:19.644192 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m02:31:19.645580 [info ] [MainThread]: 
[0m02:31:19.645747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:31:19.645882 [info ] [MainThread]: 
[0m02:31:19.646112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:31:19.648115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:31:19.700327 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:31:19.700583 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:31:19.700732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:19.820089 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.119 seconds
[0m02:31:19.821270 [debug] [ThreadPool]: On list_postgres: Close
[0m02:31:19.822619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m02:31:19.826774 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:31:19.827058 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:31:19.827238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:31:19.846830 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m02:31:19.847162 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:31:19.847370 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:31:19.851304 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m02:31:19.852427 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:31:19.853244 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:31:19.857099 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:19.857332 [debug] [MainThread]: On master: BEGIN
[0m02:31:19.857488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:31:19.875473 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m02:31:19.875739 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:19.875953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:31:19.879492 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m02:31:19.880639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afac050>]}
[0m02:31:19.880946 [debug] [MainThread]: On master: ROLLBACK
[0m02:31:19.881719 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:19.881890 [debug] [MainThread]: On master: BEGIN
[0m02:31:19.883056 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:31:19.883221 [debug] [MainThread]: On master: COMMIT
[0m02:31:19.883372 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:19.883519 [debug] [MainThread]: On master: COMMIT
[0m02:31:19.884177 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:31:19.884337 [debug] [MainThread]: On master: Close
[0m02:31:19.886197 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m02:31:19.886596 [info ] [Thread-1 (]: 1 of 29 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m02:31:19.886889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m02:31:19.887093 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m02:31:19.893306 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m02:31:19.894091 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m02:31:19.922247 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m02:31:19.922797 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:31:19.922969 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m02:31:19.923117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:19.939787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:31:19.940079 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:31:19.940310 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM (
        SELECT *,
               ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) AS rn
        FROM raw
    ) t
    WHERE rn = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:31:19.949082 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.008 seconds
[0m02:31:19.955428 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:31:19.955704 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m02:31:19.956756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:19.958270 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:31:19.958461 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m02:31:19.959192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:19.968420 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:31:19.968719 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:31:19.968900 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:31:19.977120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m02:31:19.981014 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m02:31:19.983650 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:31:19.983858 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m02:31:19.985813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:31:19.987313 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m02:31:19.988677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7846d0>]}
[0m02:31:19.989079 [info ] [Thread-1 (]: 1 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity  [[32mSELECT 4568[0m in 0.10s]
[0m02:31:19.989445 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m02:31:19.989686 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m02:31:19.990008 [info ] [Thread-1 (]: 2 of 29 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m02:31:19.990336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m02:31:19.990533 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m02:31:19.992613 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m02:31:19.993272 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m02:31:19.995560 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m02:31:19.996095 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:31:19.996283 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m02:31:19.996444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.013625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:31:20.013902 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:31:20.014098 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:31:20.016798 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m02:31:20.018562 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:31:20.018745 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m02:31:20.019979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:20.021441 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:31:20.021636 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m02:31:20.022466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:20.023284 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:31:20.023473 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:31:20.023641 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:31:20.024961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:31:20.026607 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m02:31:20.026990 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:31:20.027180 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m02:31:20.030203 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:31:20.031086 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m02:31:20.031435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b301610>]}
[0m02:31:20.031925 [info ] [Thread-1 (]: 2 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mSELECT 4[0m in 0.04s]
[0m02:31:20.032310 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m02:31:20.032602 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m02:31:20.033079 [info ] [Thread-1 (]: 3 of 29 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m02:31:20.033416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m02:31:20.033634 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m02:31:20.035791 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:31:20.036259 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m02:31:20.038437 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:31:20.039064 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:31:20.039242 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m02:31:20.039397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.058064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:31:20.058404 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:31:20.058636 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m02:31:20.079816 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.021 seconds
[0m02:31:20.081865 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:31:20.082099 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m02:31:20.083075 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:20.084620 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:31:20.084828 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m02:31:20.085577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:20.086369 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:31:20.086547 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:31:20.086711 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:31:20.119793 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m02:31:20.121723 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m02:31:20.122167 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:31:20.122393 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m02:31:20.125620 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:31:20.126643 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m02:31:20.127035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6d2e0>]}
[0m02:31:20.127467 [info ] [Thread-1 (]: 3 of 29 OK created sql incremental model public_pipedrive_analytics.stg_deal_changes  [[32mSELECT 15406[0m in 0.09s]
[0m02:31:20.127818 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m02:31:20.128060 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m02:31:20.128387 [info ] [Thread-1 (]: 4 of 29 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m02:31:20.128732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m02:31:20.128946 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m02:31:20.131649 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m02:31:20.132302 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m02:31:20.135085 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m02:31:20.135620 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:31:20.135825 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m02:31:20.136007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.155518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:31:20.155835 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:31:20.156068 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:31:20.158959 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m02:31:20.160822 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:31:20.161038 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m02:31:20.161769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:20.163277 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:31:20.163473 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m02:31:20.164126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:31:20.165231 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:31:20.165416 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:31:20.165577 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:31:20.166404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:31:20.167482 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup"
[0m02:31:20.167820 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:31:20.168000 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m02:31:20.169495 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:31:20.170313 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m02:31:20.170649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39e7b0>]}
[0m02:31:20.170997 [info ] [Thread-1 (]: 4 of 29 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mSELECT 4[0m in 0.04s]
[0m02:31:20.171297 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m02:31:20.171498 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m02:31:20.171787 [info ] [Thread-1 (]: 5 of 29 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m02:31:20.172155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m02:31:20.172403 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m02:31:20.174658 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m02:31:20.175476 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m02:31:20.179371 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m02:31:20.180039 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:31:20.180222 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m02:31:20.180381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.342997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m02:31:20.343337 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:31:20.343553 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:31:20.346786 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m02:31:20.348703 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:31:20.348942 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m02:31:20.350129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:20.352487 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:31:20.352763 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m02:31:20.354761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:31:20.355911 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:31:20.356162 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:31:20.356770 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:31:20.358724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:31:20.360293 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m02:31:20.360715 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:31:20.360897 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m02:31:20.362725 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:31:20.363448 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m02:31:20.363743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b602650>]}
[0m02:31:20.364052 [info ] [Thread-1 (]: 5 of 29 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mSELECT 9[0m in 0.19s]
[0m02:31:20.364307 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m02:31:20.364485 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m02:31:20.364761 [info ] [Thread-1 (]: 6 of 29 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m02:31:20.365041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m02:31:20.365200 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m02:31:20.367166 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m02:31:20.367621 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m02:31:20.369596 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m02:31:20.369962 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:31:20.370119 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m02:31:20.370256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.392480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:31:20.392788 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:31:20.392990 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


  );
  
  
[0m02:31:20.397858 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.005 seconds
[0m02:31:20.399719 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:31:20.399934 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m02:31:20.400759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:31:20.402235 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:31:20.402425 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m02:31:20.403088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:31:20.403956 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:31:20.404521 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:31:20.404706 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:31:20.407429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:31:20.408593 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m02:31:20.408946 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:31:20.409125 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m02:31:20.411091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:31:20.411861 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m02:31:20.412197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b931080>]}
[0m02:31:20.412553 [info ] [Thread-1 (]: 6 of 29 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mSELECT 1787[0m in 0.05s]
[0m02:31:20.412857 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m02:31:20.413072 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:31:20.413306 [info ] [Thread-1 (]: 7 of 29 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m02:31:20.413613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m02:31:20.413795 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:31:20.420391 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:31:20.421306 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:31:20.431391 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:31:20.431996 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:31:20.432167 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m02:31:20.432319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.451153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:31:20.451452 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:31:20.451648 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.453447 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:31:20.455455 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m02:31:20.456145 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m02:31:20.456513 [info ] [Thread-1 (]: 7 of 29 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.04s]
[0m02:31:20.456820 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:31:20.457024 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:31:20.457255 [info ] [Thread-1 (]: 8 of 29 START test not_null_stg_activity_activity_type_short ................... [RUN]
[0m02:31:20.457510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844)
[0m02:31:20.457757 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:31:20.460108 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:31:20.460813 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:31:20.462424 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:31:20.463411 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:31:20.463647 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: BEGIN
[0m02:31:20.463836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.484880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:31:20.485208 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:31:20.485411 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_short
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_type_short is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.486835 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:20.487782 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: ROLLBACK
[0m02:31:20.488395 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: Close
[0m02:31:20.488780 [info ] [Thread-1 (]: 8 of 29 PASS not_null_stg_activity_activity_type_short ......................... [[32mPASS[0m in 0.03s]
[0m02:31:20.489079 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:31:20.489275 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:31:20.489477 [info ] [Thread-1 (]: 9 of 29 START test not_null_stg_activity_user_id ............................... [RUN]
[0m02:31:20.489677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844, now test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272)
[0m02:31:20.489846 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:31:20.492269 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:31:20.492784 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:31:20.493972 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:31:20.494429 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:31:20.494608 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: BEGIN
[0m02:31:20.494769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.514299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:31:20.514578 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:31:20.514772 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.516186 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:20.517026 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: ROLLBACK
[0m02:31:20.518049 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: Close
[0m02:31:20.518388 [info ] [Thread-1 (]: 9 of 29 PASS not_null_stg_activity_user_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:31:20.518747 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:31:20.518992 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:31:20.519227 [info ] [Thread-1 (]: 10 of 29 START test unique_stg_activity_activity_id ............................ [RUN]
[0m02:31:20.519468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m02:31:20.519795 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:31:20.523572 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:31:20.524145 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:31:20.525340 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:31:20.525851 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:31:20.526027 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m02:31:20.526186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.543512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:31:20.543828 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:31:20.544016 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:20.546297 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:31:20.547096 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m02:31:20.547674 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m02:31:20.548042 [info ] [Thread-1 (]: 10 of 29 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.03s]
[0m02:31:20.548324 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:31:20.548517 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:31:20.548733 [info ] [Thread-1 (]: 11 of 29 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m02:31:20.548985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m02:31:20.549164 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:31:20.551857 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:31:20.552511 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:31:20.553621 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:31:20.554006 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:31:20.554178 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m02:31:20.554332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.573073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:31:20.573366 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:31:20.573561 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.574868 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:20.575813 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m02:31:20.576838 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m02:31:20.577204 [info ] [Thread-1 (]: 11 of 29 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m02:31:20.577503 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:31:20.577703 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:31:20.577889 [info ] [Thread-1 (]: 12 of 29 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m02:31:20.578152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m02:31:20.578389 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:31:20.582921 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:31:20.583530 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:31:20.585038 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:31:20.585465 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:31:20.585640 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m02:31:20.585793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.602613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:31:20.602919 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:31:20.603132 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.605171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:31:20.606071 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m02:31:20.606737 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m02:31:20.607137 [info ] [Thread-1 (]: 12 of 29 PASS relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[32mPASS[0m in 0.03s]
[0m02:31:20.607447 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:31:20.607736 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:31:20.607968 [info ] [Thread-1 (]: 13 of 29 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m02:31:20.608264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m02:31:20.608651 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:31:20.610976 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:31:20.611549 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:31:20.612633 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:31:20.613008 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:31:20.613176 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m02:31:20.613332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.630897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:31:20.631181 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:31:20.631366 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:20.632549 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:20.633390 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m02:31:20.634110 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m02:31:20.634442 [info ] [Thread-1 (]: 13 of 29 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m02:31:20.634727 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:31:20.634921 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:31:20.635094 [info ] [Thread-1 (]: 14 of 29 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m02:31:20.635360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m02:31:20.635579 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:31:20.638191 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:31:20.638867 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:31:20.639998 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:31:20.640464 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:31:20.640650 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m02:31:20.640800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.659238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:31:20.659547 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:31:20.659733 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.662794 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:31:20.663760 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m02:31:20.664564 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m02:31:20.664950 [info ] [Thread-1 (]: 14 of 29 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m02:31:20.665372 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:31:20.665607 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:31:20.665794 [info ] [Thread-1 (]: 15 of 29 START test not_null_stg_deal_changes_deal_id_sk ....................... [RUN]
[0m02:31:20.666047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e)
[0m02:31:20.666312 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:31:20.669265 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:31:20.669995 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:31:20.671093 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:31:20.671448 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:31:20.671607 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: BEGIN
[0m02:31:20.671750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.689506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:31:20.689813 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:31:20.690010 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.691957 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:31:20.692889 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: ROLLBACK
[0m02:31:20.693669 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: Close
[0m02:31:20.693996 [info ] [Thread-1 (]: 15 of 29 PASS not_null_stg_deal_changes_deal_id_sk ............................. [[32mPASS[0m in 0.03s]
[0m02:31:20.694315 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:31:20.694513 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:31:20.694687 [info ] [Thread-1 (]: 16 of 29 START test not_null_stg_deal_changes_deal_updated_field_key ........... [RUN]
[0m02:31:20.694929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624)
[0m02:31:20.695119 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:31:20.697265 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:31:20.697743 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:31:20.699126 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:31:20.699750 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:31:20.699929 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: BEGIN
[0m02:31:20.700788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.724050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:31:20.724387 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:31:20.724590 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_updated_field_key
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_updated_field_key is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.726631 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:31:20.727518 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: ROLLBACK
[0m02:31:20.728258 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: Close
[0m02:31:20.728643 [info ] [Thread-1 (]: 16 of 29 PASS not_null_stg_deal_changes_deal_updated_field_key ................. [[32mPASS[0m in 0.03s]
[0m02:31:20.728985 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:31:20.729196 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:31:20.729431 [info ] [Thread-1 (]: 17 of 29 START test unique_stg_deal_changes_deal_id_sk ......................... [RUN]
[0m02:31:20.729745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624, now test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600)
[0m02:31:20.730028 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:31:20.732377 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:31:20.733604 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:31:20.734751 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:31:20.735163 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:31:20.735350 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: BEGIN
[0m02:31:20.735512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.758820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:31:20.759112 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:31:20.759301 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:20.766656 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m02:31:20.767675 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: ROLLBACK
[0m02:31:20.768512 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: Close
[0m02:31:20.768873 [info ] [Thread-1 (]: 17 of 29 PASS unique_stg_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.04s]
[0m02:31:20.769182 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:31:20.769388 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:31:20.769631 [info ] [Thread-1 (]: 18 of 29 START test not_null_stg_fields_field_key .............................. [RUN]
[0m02:31:20.769919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m02:31:20.770126 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:31:20.773952 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:31:20.774745 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:31:20.775860 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:31:20.776241 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:31:20.776503 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m02:31:20.776679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.795280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:31:20.795572 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:31:20.795759 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.796825 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:20.797709 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m02:31:20.798411 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m02:31:20.798764 [info ] [Thread-1 (]: 18 of 29 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m02:31:20.799063 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:31:20.799270 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:31:20.799520 [info ] [Thread-1 (]: 19 of 29 START test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [RUN]
[0m02:31:20.799799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa)
[0m02:31:20.800015 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:31:20.803390 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:31:20.804916 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:31:20.806200 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:31:20.806644 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:31:20.806833 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: BEGIN
[0m02:31:20.806996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.833751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m02:31:20.834050 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:31:20.834270 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_updated_field_key as from_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where deal_updated_field_key is not null
),

parent as (
    select field_key as to_field
    from "postgres"."public_pipedrive_analytics"."stg_fields"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.837678 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:31:20.838631 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: ROLLBACK
[0m02:31:20.839400 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: Close
[0m02:31:20.839769 [info ] [Thread-1 (]: 19 of 29 PASS relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[32mPASS[0m in 0.04s]
[0m02:31:20.840083 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:31:20.840285 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:31:20.840527 [info ] [Thread-1 (]: 20 of 29 START test unique_stg_fields_field_key ................................ [RUN]
[0m02:31:20.840839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m02:31:20.841054 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:31:20.843319 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:31:20.843822 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:31:20.845375 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:31:20.845775 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:31:20.845965 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m02:31:20.846135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.867591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:31:20.867894 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:31:20.868100 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:20.869446 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:20.870339 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m02:31:20.871073 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m02:31:20.871417 [info ] [Thread-1 (]: 20 of 29 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m02:31:20.871712 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:31:20.871912 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:31:20.872176 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m02:31:20.872399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m02:31:20.872576 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:31:20.874887 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:31:20.875388 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:31:20.876535 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:31:20.876906 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:31:20.877078 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m02:31:20.877224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.899985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:31:20.900283 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:31:20.900481 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.901526 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:20.902444 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m02:31:20.903171 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m02:31:20.903516 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:31:20.903813 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:31:20.904012 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:31:20.904255 [info ] [Thread-1 (]: 22 of 29 START test unique_stg_stages_stage_id ................................. [RUN]
[0m02:31:20.904545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m02:31:20.904753 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:31:20.907497 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:31:20.908065 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:31:20.909204 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:31:20.909595 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:31:20.909845 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m02:31:20.910021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.931341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:31:20.931658 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:31:20.931862 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:20.933247 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:20.934199 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m02:31:20.935082 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m02:31:20.935465 [info ] [Thread-1 (]: 22 of 29 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m02:31:20.935812 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:31:20.936019 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:31:20.936255 [info ] [Thread-1 (]: 23 of 29 START test not_null_stg_users_user_id ................................. [RUN]
[0m02:31:20.936540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m02:31:20.936745 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:31:20.939476 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:31:20.940285 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:31:20.941460 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:31:20.941947 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:31:20.942260 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m02:31:20.942432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:20.968659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m02:31:20.968947 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:31:20.969135 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:31:20.970362 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:20.971286 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m02:31:20.972015 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m02:31:20.972366 [info ] [Thread-1 (]: 23 of 29 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m02:31:20.972676 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:31:20.972880 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:31:20.973126 [info ] [Thread-1 (]: 24 of 29 START test not_null_stg_users_user_name ............................... [RUN]
[0m02:31:20.973423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m02:31:20.973699 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:31:20.975977 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:31:20.976619 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:31:20.978110 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:31:20.978569 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:31:20.978748 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m02:31:20.978905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:21.002068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:31:21.002381 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:31:21.002591 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m02:31:21.003760 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:31:21.004672 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m02:31:21.005418 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m02:31:21.005771 [info ] [Thread-1 (]: 24 of 29 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m02:31:21.006081 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:31:21.006289 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:31:21.006538 [info ] [Thread-1 (]: 25 of 29 START test relationships_stg_activity_user_id__user_id__ref_stg_users_  [RUN]
[0m02:31:21.006823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02)
[0m02:31:21.007034 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:31:21.010194 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:31:21.010892 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:31:21.012088 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:31:21.012602 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:31:21.012782 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: BEGIN
[0m02:31:21.012945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:21.037456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m02:31:21.037784 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:31:21.038037 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:31:21.040318 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:31:21.041697 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: ROLLBACK
[0m02:31:21.042957 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: Close
[0m02:31:21.043412 [info ] [Thread-1 (]: 25 of 29 PASS relationships_stg_activity_user_id__user_id__ref_stg_users_ ...... [[32mPASS[0m in 0.04s]
[0m02:31:21.043746 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:31:21.043964 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:31:21.044210 [info ] [Thread-1 (]: 26 of 29 START test unique_stg_users_user_id ................................... [RUN]
[0m02:31:21.044563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m02:31:21.044780 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:31:21.047437 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:31:21.047959 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:31:21.049091 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:31:21.049581 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:31:21.049763 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m02:31:21.049920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:21.068861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:31:21.069187 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:31:21.069389 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:21.071212 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:31:21.072174 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m02:31:21.073028 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m02:31:21.073396 [info ] [Thread-1 (]: 26 of 29 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m02:31:21.073710 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:31:21.073939 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m02:31:21.074294 [info ] [Thread-1 (]: 27 of 29 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m02:31:21.074613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m02:31:21.074853 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m02:31:21.077952 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:31:21.079342 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m02:31:21.081478 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:31:21.082388 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:31:21.082602 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m02:31:21.082777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:21.104244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:31:21.104572 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:31:21.104816 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(v.value->>'id' AS INT) AS lost_reason_id,   -- Unique identifier for the lost reason
        v.value->>'label' AS lost_reason_name           -- Name of the lost reason
    FROM raw
    JOIN LATERAL jsonb_array_elements(f.field_value_options) AS v(value) ON TRUE -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


  );
  
  
[0m02:31:21.106220 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "f"
LINE 30:     JOIN LATERAL jsonb_array_elements(f.field_value_options)...
                                               ^

[0m02:31:21.106482 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: ROLLBACK
[0m02:31:21.107321 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m02:31:21.114248 [debug] [Thread-1 (]: Database Error in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)
  missing FROM-clause entry for table "f"
  LINE 30:     JOIN LATERAL jsonb_array_elements(f.field_value_options)...
                                                 ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_lost_reasons.sql
[0m02:31:21.114601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b07649-8069-4eff-bf0e-bfa39ca77a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b231790>]}
[0m02:31:21.114992 [error] [Thread-1 (]: 27 of 29 ERROR creating sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[31mERROR[0m in 0.04s]
[0m02:31:21.115321 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m02:31:21.115612 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_lost_reasons' to be skipped because of status 'error'.  Reason: Database Error in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)
  missing FROM-clause entry for table "f"
  LINE 30:     JOIN LATERAL jsonb_array_elements(f.field_value_options)...
                                                 ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_lost_reasons.sql.
[0m02:31:21.116220 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:31:21.116493 [info ] [Thread-1 (]: 28 of 29 SKIP test not_null_stg_lost_reasons_lost_reason_id .................... [[33mSKIP[0m]
[0m02:31:21.116737 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:31:21.116929 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:31:21.117088 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768' to be skipped because of status 'skipped'. 
[0m02:31:21.117294 [info ] [Thread-1 (]: 29 of 29 SKIP test unique_stg_lost_reasons_lost_reason_id ...................... [[33mSKIP[0m]
[0m02:31:21.117550 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:31:21.117717 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' to be skipped because of status 'skipped'. 
[0m02:31:21.118308 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:21.118461 [debug] [MainThread]: On master: BEGIN
[0m02:31:21.118590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:31:21.140561 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m02:31:21.140844 [debug] [MainThread]: On master: COMMIT
[0m02:31:21.141009 [debug] [MainThread]: Using postgres connection "master"
[0m02:31:21.141156 [debug] [MainThread]: On master: COMMIT
[0m02:31:21.141732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:31:21.141937 [debug] [MainThread]: On master: Close
[0m02:31:21.142188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:21.142340 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_lost_reasons' was properly closed.
[0m02:31:21.142552 [info ] [MainThread]: 
[0m02:31:21.142737 [info ] [MainThread]: Finished running 7 incremental models, 22 data tests in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m02:31:21.144732 [debug] [MainThread]: Command end result
[0m02:31:21.163288 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:31:21.164423 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:31:21.168134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m02:31:21.168344 [info ] [MainThread]: 
[0m02:31:21.168528 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:31:21.168666 [info ] [MainThread]: 
[0m02:31:21.168836 [error] [MainThread]: [31mFailure in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)[0m
[0m02:31:21.169007 [error] [MainThread]:   Database Error in model stg_lost_reasons (models/staging/stg_lost_reasons.sql)
  missing FROM-clause entry for table "f"
  LINE 30:     JOIN LATERAL jsonb_array_elements(f.field_value_options)...
                                                 ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_lost_reasons.sql
[0m02:31:21.169130 [info ] [MainThread]: 
[0m02:31:21.169276 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_lost_reasons.sql
[0m02:31:21.169403 [info ] [MainThread]: 
[0m02:31:21.169542 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=29
[0m02:31:21.171317 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.1760077, "process_in_blocks": "0", "process_kernel_time": 0.322827, "process_mem_max_rss": "131809280", "process_out_blocks": "0", "process_user_time": 1.721505}
[0m02:31:21.171576 [debug] [MainThread]: Command `dbt build` failed at 02:31:21.171529 after 2.18 seconds
[0m02:31:21.171765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b915010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b915af0>]}
[0m02:31:21.171942 [debug] [MainThread]: Flushing usage events
[0m02:31:23.187453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:31:59.594192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105884050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d3b10>]}


============================== 02:31:59.598121 | 07087b2c-e9d9-4063-bd8d-450f9936ba00 ==============================
[0m02:31:59.598121 [info ] [MainThread]: Running with dbt=1.10.11
[0m02:31:59.598487 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'invocation_command': 'dbt build -s tag:staging -f', 'log_format': 'default'}
[0m02:31:59.710642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cfe10>]}
[0m02:31:59.739144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654fbd0>]}
[0m02:31:59.739761 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:31:59.789794 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m02:31:59.870962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:31:59.871388 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_lost_reasons.sql
[0m02:32:00.112481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f9350>]}
[0m02:32:00.157685 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:32:00.159173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:32:00.182743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758f890>]}
[0m02:32:00.183038 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m02:32:00.184754 [info ] [MainThread]: 
[0m02:32:00.185034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:32:00.185179 [info ] [MainThread]: 
[0m02:32:00.185426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:32:00.187427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:32:00.240732 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:32:00.240996 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:32:00.241146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:32:00.292968 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.052 seconds
[0m02:32:00.293923 [debug] [ThreadPool]: On list_postgres: Close
[0m02:32:00.295031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m02:32:00.298330 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:32:00.298553 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:32:00.298709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:32:00.316862 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m02:32:00.317130 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:32:00.317314 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:32:00.321481 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m02:32:00.322386 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:32:00.323056 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:32:00.327247 [debug] [MainThread]: Using postgres connection "master"
[0m02:32:00.327508 [debug] [MainThread]: On master: BEGIN
[0m02:32:00.327662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:32:00.344921 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m02:32:00.345212 [debug] [MainThread]: Using postgres connection "master"
[0m02:32:00.345432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:32:00.348363 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m02:32:00.349506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f4050>]}
[0m02:32:00.349809 [debug] [MainThread]: On master: ROLLBACK
[0m02:32:00.350503 [debug] [MainThread]: Using postgres connection "master"
[0m02:32:00.350700 [debug] [MainThread]: On master: BEGIN
[0m02:32:00.351701 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:32:00.351866 [debug] [MainThread]: On master: COMMIT
[0m02:32:00.352013 [debug] [MainThread]: Using postgres connection "master"
[0m02:32:00.352147 [debug] [MainThread]: On master: COMMIT
[0m02:32:00.352758 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:32:00.352914 [debug] [MainThread]: On master: Close
[0m02:32:00.354918 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m02:32:00.355259 [info ] [Thread-1 (]: 1 of 29 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m02:32:00.355527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m02:32:00.355721 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m02:32:00.361913 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m02:32:00.362475 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m02:32:00.390844 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m02:32:00.391408 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:32:00.391584 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m02:32:00.391737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.411809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:32:00.412059 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:32:00.412282 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM (
        SELECT *,
               ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) AS rn
        FROM raw
    ) t
    WHERE rn = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:32:00.424908 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.012 seconds
[0m02:32:00.431042 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:32:00.431277 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m02:32:00.432437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.433964 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:32:00.434167 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m02:32:00.435024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.444100 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:32:00.444348 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:32:00.444519 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:32:00.451058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m02:32:00.454891 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m02:32:00.457538 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:32:00.457753 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m02:32:00.459959 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:32:00.461438 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m02:32:00.462768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd06d0>]}
[0m02:32:00.463155 [info ] [Thread-1 (]: 1 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity  [[32mSELECT 4568[0m in 0.11s]
[0m02:32:00.463467 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m02:32:00.463675 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m02:32:00.463955 [info ] [Thread-1 (]: 2 of 29 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m02:32:00.464261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m02:32:00.464462 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m02:32:00.466568 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m02:32:00.467079 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m02:32:00.469516 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m02:32:00.470088 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:32:00.470370 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m02:32:00.470576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.492349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:32:00.492669 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:32:00.492889 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:32:00.494956 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m02:32:00.496828 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:32:00.497047 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m02:32:00.497839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.499294 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:32:00.499483 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m02:32:00.500189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.501113 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:32:00.501319 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:32:00.501496 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:32:00.502837 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:32:00.504279 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m02:32:00.504636 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:32:00.504823 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m02:32:00.506148 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:32:00.507058 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m02:32:00.507505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789d610>]}
[0m02:32:00.507900 [info ] [Thread-1 (]: 2 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mSELECT 4[0m in 0.04s]
[0m02:32:00.508216 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m02:32:00.508423 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m02:32:00.508735 [info ] [Thread-1 (]: 3 of 29 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m02:32:00.509082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m02:32:00.509293 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m02:32:00.511645 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:32:00.512168 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m02:32:00.514469 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:32:00.514928 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:32:00.515107 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m02:32:00.515267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.532347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:32:00.532639 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:32:00.532863 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m02:32:00.553968 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.021 seconds
[0m02:32:00.556035 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:32:00.556331 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m02:32:00.557500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.559225 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:32:00.559445 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m02:32:00.560186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.560989 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:32:00.561183 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:32:00.561348 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:32:00.575725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m02:32:00.577626 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m02:32:00.578045 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:32:00.578257 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m02:32:00.580939 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:32:00.581789 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m02:32:00.582145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ad2e0>]}
[0m02:32:00.582535 [info ] [Thread-1 (]: 3 of 29 OK created sql incremental model public_pipedrive_analytics.stg_deal_changes  [[32mSELECT 15406[0m in 0.07s]
[0m02:32:00.582861 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m02:32:00.583079 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m02:32:00.583376 [info ] [Thread-1 (]: 4 of 29 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m02:32:00.583683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m02:32:00.583881 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m02:32:00.586273 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m02:32:00.586839 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m02:32:00.589344 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m02:32:00.589853 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:32:00.590038 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m02:32:00.590207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.608075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:32:00.608390 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:32:00.608619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:32:00.611315 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m02:32:00.613191 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:32:00.613412 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m02:32:00.614163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.615698 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:32:00.615895 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m02:32:00.616638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.617886 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:32:00.618104 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:32:00.618283 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:32:00.619394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:32:00.620633 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup"
[0m02:32:00.620994 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:32:00.621173 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m02:32:00.622913 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:32:00.623675 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m02:32:00.624019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e67b0>]}
[0m02:32:00.624379 [info ] [Thread-1 (]: 4 of 29 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mSELECT 4[0m in 0.04s]
[0m02:32:00.624680 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m02:32:00.624887 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m02:32:00.625162 [info ] [Thread-1 (]: 5 of 29 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m02:32:00.625564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m02:32:00.625786 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m02:32:00.628018 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m02:32:00.628528 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m02:32:00.632308 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m02:32:00.632783 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:32:00.632966 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m02:32:00.633131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.650821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:32:00.651115 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:32:00.651333 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:32:00.654180 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m02:32:00.655982 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:32:00.656179 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m02:32:00.657049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.658533 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:32:00.658744 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m02:32:00.659456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.660233 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:32:00.660416 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:32:00.660913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:32:00.661894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:32:00.662934 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m02:32:00.663270 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:32:00.663441 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m02:32:00.664684 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:32:00.665354 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m02:32:00.665676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4a3d0>]}
[0m02:32:00.666049 [info ] [Thread-1 (]: 5 of 29 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mSELECT 9[0m in 0.04s]
[0m02:32:00.666370 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m02:32:00.666571 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m02:32:00.666845 [info ] [Thread-1 (]: 6 of 29 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m02:32:00.667159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m02:32:00.667335 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m02:32:00.669372 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m02:32:00.669876 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m02:32:00.672057 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m02:32:00.672498 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:32:00.672713 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m02:32:00.672885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.691267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:32:00.691565 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:32:00.691775 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


  );
  
  
[0m02:32:00.696652 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.005 seconds
[0m02:32:00.698684 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:32:00.698911 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m02:32:00.699753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.701267 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:32:00.701468 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m02:32:00.702154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:00.702948 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:32:00.703497 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:32:00.703676 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:32:00.707418 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m02:32:00.708607 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m02:32:00.708981 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:32:00.709167 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m02:32:00.710979 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:32:00.711759 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m02:32:00.712090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d84130>]}
[0m02:32:00.712533 [info ] [Thread-1 (]: 6 of 29 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mSELECT 1787[0m in 0.04s]
[0m02:32:00.713041 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m02:32:00.713291 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:32:00.713576 [info ] [Thread-1 (]: 7 of 29 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m02:32:00.713914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m02:32:00.714105 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:32:00.721047 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:32:00.721664 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:32:00.732042 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:32:00.732595 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:32:00.732767 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m02:32:00.732919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.749036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m02:32:00.749285 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:32:00.749462 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m02:32:00.750834 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:00.752749 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m02:32:00.753382 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m02:32:00.753743 [info ] [Thread-1 (]: 7 of 29 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.04s]
[0m02:32:00.754043 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:32:00.754240 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:32:00.754424 [info ] [Thread-1 (]: 8 of 29 START test not_null_stg_activity_activity_type_short ................... [RUN]
[0m02:32:00.754633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844)
[0m02:32:00.754807 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:32:00.756914 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:32:00.757656 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:32:00.759047 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:32:00.759436 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:32:00.759604 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: BEGIN
[0m02:32:00.759812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.777658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:32:00.778045 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:32:00.778257 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_short
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_type_short is null



  
  
      
    ) dbt_internal_test
[0m02:32:00.780086 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:32:00.781001 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: ROLLBACK
[0m02:32:00.781740 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: Close
[0m02:32:00.782089 [info ] [Thread-1 (]: 8 of 29 PASS not_null_stg_activity_activity_type_short ......................... [[32mPASS[0m in 0.03s]
[0m02:32:00.782372 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:32:00.782563 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:32:00.782733 [info ] [Thread-1 (]: 9 of 29 START test not_null_stg_activity_user_id ............................... [RUN]
[0m02:32:00.782990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844, now test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272)
[0m02:32:00.783216 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:32:00.785425 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:32:00.785897 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:32:00.786943 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:32:00.787280 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:32:00.787440 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: BEGIN
[0m02:32:00.787665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.804584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:32:00.804869 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:32:00.805058 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:32:00.806271 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:00.807214 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: ROLLBACK
[0m02:32:00.808122 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: Close
[0m02:32:00.808575 [info ] [Thread-1 (]: 9 of 29 PASS not_null_stg_activity_user_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:32:00.808882 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:32:00.809080 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:32:00.809262 [info ] [Thread-1 (]: 10 of 29 START test unique_stg_activity_activity_id ............................ [RUN]
[0m02:32:00.809511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m02:32:00.809683 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:32:00.813808 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:32:00.814305 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:32:00.815397 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:32:00.815841 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:32:00.816004 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m02:32:00.816144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.833557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:32:00.833833 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:32:00.834011 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:32:00.836248 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:32:00.837107 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m02:32:00.837769 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m02:32:00.838165 [info ] [Thread-1 (]: 10 of 29 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.03s]
[0m02:32:00.838460 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:32:00.838654 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:32:00.838836 [info ] [Thread-1 (]: 11 of 29 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m02:32:00.839101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m02:32:00.839335 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:32:00.841984 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:32:00.842525 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:32:00.843681 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:32:00.844071 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:32:00.844302 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m02:32:00.844505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.862029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:32:00.862321 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:32:00.862506 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m02:32:00.863479 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:00.864270 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m02:32:00.864907 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m02:32:00.865236 [info ] [Thread-1 (]: 11 of 29 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m02:32:00.865498 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:32:00.865679 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:32:00.865840 [info ] [Thread-1 (]: 12 of 29 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m02:32:00.866085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m02:32:00.866370 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:32:00.870658 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:32:00.871238 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:32:00.872669 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:32:00.873057 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:32:00.873233 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m02:32:00.873383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.891286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:32:00.891607 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:32:00.891857 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:32:00.894264 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:32:00.895127 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m02:32:00.895778 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m02:32:00.896121 [info ] [Thread-1 (]: 12 of 29 PASS relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[32mPASS[0m in 0.03s]
[0m02:32:00.896416 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:32:00.896610 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:32:00.896787 [info ] [Thread-1 (]: 13 of 29 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m02:32:00.897023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m02:32:00.897202 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:32:00.899307 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:32:00.899786 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:32:00.900911 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:32:00.901293 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:32:00.901474 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m02:32:00.901636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.920666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:32:00.920953 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:32:00.921156 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:32:00.922231 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:00.923109 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m02:32:00.923780 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m02:32:00.924186 [info ] [Thread-1 (]: 13 of 29 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m02:32:00.924539 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:32:00.924779 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:32:00.925036 [info ] [Thread-1 (]: 14 of 29 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m02:32:00.925338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m02:32:00.925544 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:32:00.928201 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:32:00.928755 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:32:00.929830 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:32:00.930196 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:32:00.930503 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m02:32:00.930681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.947645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:32:00.947944 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:32:00.948126 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m02:32:00.950127 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:32:00.951047 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m02:32:00.951747 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m02:32:00.952092 [info ] [Thread-1 (]: 14 of 29 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m02:32:00.952389 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:32:00.952585 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:32:00.952765 [info ] [Thread-1 (]: 15 of 29 START test not_null_stg_deal_changes_deal_id_sk ....................... [RUN]
[0m02:32:00.953019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e)
[0m02:32:00.953239 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:32:00.955736 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:32:00.956259 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:32:00.957379 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:32:00.957901 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:32:00.958144 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: BEGIN
[0m02:32:00.958404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:00.977639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:32:00.977918 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:32:00.978103 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m02:32:00.979871 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:32:00.980750 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: ROLLBACK
[0m02:32:00.981449 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: Close
[0m02:32:00.981787 [info ] [Thread-1 (]: 15 of 29 PASS not_null_stg_deal_changes_deal_id_sk ............................. [[32mPASS[0m in 0.03s]
[0m02:32:00.982080 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:32:00.982273 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:32:00.982450 [info ] [Thread-1 (]: 16 of 29 START test not_null_stg_deal_changes_deal_updated_field_key ........... [RUN]
[0m02:32:00.982685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624)
[0m02:32:00.982860 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:32:00.985081 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:32:00.985639 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:32:00.987104 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:32:00.987544 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:32:00.987771 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: BEGIN
[0m02:32:00.987953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.010767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:32:01.011086 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:32:01.011294 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_updated_field_key
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_updated_field_key is null



  
  
      
    ) dbt_internal_test
[0m02:32:01.013250 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:32:01.014187 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: ROLLBACK
[0m02:32:01.014862 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: Close
[0m02:32:01.015215 [info ] [Thread-1 (]: 16 of 29 PASS not_null_stg_deal_changes_deal_updated_field_key ................. [[32mPASS[0m in 0.03s]
[0m02:32:01.015525 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:32:01.015725 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:32:01.015949 [info ] [Thread-1 (]: 17 of 29 START test unique_stg_deal_changes_deal_id_sk ......................... [RUN]
[0m02:32:01.016202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624, now test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600)
[0m02:32:01.016410 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:32:01.018684 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:32:01.019211 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:32:01.020336 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:32:01.020705 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:32:01.020871 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: BEGIN
[0m02:32:01.021109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.043367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:32:01.043668 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:32:01.043875 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:32:01.050575 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m02:32:01.051539 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: ROLLBACK
[0m02:32:01.052250 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: Close
[0m02:32:01.052605 [info ] [Thread-1 (]: 17 of 29 PASS unique_stg_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.04s]
[0m02:32:01.052914 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:32:01.053114 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:32:01.053296 [info ] [Thread-1 (]: 18 of 29 START test not_null_stg_fields_field_key .............................. [RUN]
[0m02:32:01.053563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m02:32:01.053799 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:32:01.057646 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:32:01.058229 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:32:01.059376 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:32:01.059898 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:32:01.060114 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m02:32:01.060294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.079375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:32:01.079667 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:32:01.079863 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m02:32:01.080848 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:01.081728 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m02:32:01.082402 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m02:32:01.082745 [info ] [Thread-1 (]: 18 of 29 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m02:32:01.083035 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:32:01.083225 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:32:01.083403 [info ] [Thread-1 (]: 19 of 29 START test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [RUN]
[0m02:32:01.083658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa)
[0m02:32:01.083932 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:32:01.087381 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:32:01.087941 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:32:01.089146 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:32:01.089667 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:32:01.089868 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: BEGIN
[0m02:32:01.090037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.107221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:32:01.107530 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:32:01.107774 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_updated_field_key as from_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where deal_updated_field_key is not null
),

parent as (
    select field_key as to_field
    from "postgres"."public_pipedrive_analytics"."stg_fields"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:32:01.111495 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:32:01.112505 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: ROLLBACK
[0m02:32:01.113343 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: Close
[0m02:32:01.113814 [info ] [Thread-1 (]: 19 of 29 PASS relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[32mPASS[0m in 0.03s]
[0m02:32:01.114138 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:32:01.114342 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:32:01.114537 [info ] [Thread-1 (]: 20 of 29 START test unique_stg_fields_field_key ................................ [RUN]
[0m02:32:01.114795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m02:32:01.115000 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:32:01.117155 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:32:01.117638 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:32:01.119117 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:32:01.119533 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:32:01.119749 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m02:32:01.119920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.141684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:32:01.142010 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:32:01.142219 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:32:01.143571 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:01.144505 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m02:32:01.145149 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m02:32:01.145511 [info ] [Thread-1 (]: 20 of 29 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m02:32:01.145823 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:32:01.146029 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:32:01.146253 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m02:32:01.146561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m02:32:01.146751 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:32:01.149038 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:32:01.149532 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:32:01.150687 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:32:01.151051 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:32:01.151222 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m02:32:01.151377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.174015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m02:32:01.174330 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:32:01.174531 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m02:32:01.175682 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:01.176621 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m02:32:01.177295 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m02:32:01.177686 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:32:01.178016 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:32:01.178226 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:32:01.178448 [info ] [Thread-1 (]: 22 of 29 START test unique_stg_stages_stage_id ................................. [RUN]
[0m02:32:01.178696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m02:32:01.178884 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:32:01.181513 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:32:01.182008 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:32:01.183140 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:32:01.183536 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:32:01.183723 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m02:32:01.183891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.200228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m02:32:01.200529 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:32:01.200730 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:32:01.202073 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:01.203049 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m02:32:01.203780 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m02:32:01.204140 [info ] [Thread-1 (]: 22 of 29 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m02:32:01.204453 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:32:01.204656 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:32:01.204880 [info ] [Thread-1 (]: 23 of 29 START test not_null_stg_users_user_id ................................. [RUN]
[0m02:32:01.205133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m02:32:01.205333 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:32:01.207855 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:32:01.208445 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:32:01.209617 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:32:01.210058 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:32:01.210237 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m02:32:01.210395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.230919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:32:01.231220 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:32:01.231425 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:32:01.232647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:01.233542 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m02:32:01.235090 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m02:32:01.235434 [info ] [Thread-1 (]: 23 of 29 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m02:32:01.235728 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:32:01.235925 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:32:01.236166 [info ] [Thread-1 (]: 24 of 29 START test not_null_stg_users_user_name ............................... [RUN]
[0m02:32:01.236443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m02:32:01.236652 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:32:01.238913 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:32:01.239437 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:32:01.241121 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:32:01.241688 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:32:01.241873 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m02:32:01.242031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.260934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:32:01.261250 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:32:01.261459 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m02:32:01.262588 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:01.263518 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m02:32:01.264186 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m02:32:01.264535 [info ] [Thread-1 (]: 24 of 29 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m02:32:01.264850 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:32:01.265058 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:32:01.265304 [info ] [Thread-1 (]: 25 of 29 START test relationships_stg_activity_user_id__user_id__ref_stg_users_  [RUN]
[0m02:32:01.265597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02)
[0m02:32:01.265814 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:32:01.268877 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:32:01.269382 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:32:01.270495 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:32:01.270924 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:32:01.271094 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: BEGIN
[0m02:32:01.271248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.290039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:32:01.290462 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:32:01.290728 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:32:01.292976 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:32:01.293926 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: ROLLBACK
[0m02:32:01.295361 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: Close
[0m02:32:01.295703 [info ] [Thread-1 (]: 25 of 29 PASS relationships_stg_activity_user_id__user_id__ref_stg_users_ ...... [[32mPASS[0m in 0.03s]
[0m02:32:01.296002 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:32:01.296199 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:32:01.296421 [info ] [Thread-1 (]: 26 of 29 START test unique_stg_users_user_id ................................... [RUN]
[0m02:32:01.296692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m02:32:01.296893 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:32:01.299520 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:32:01.300022 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:32:01.301129 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:32:01.301529 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:32:01.301712 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m02:32:01.301874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.320532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:32:01.320830 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:32:01.321035 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:32:01.323388 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:32:01.324910 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m02:32:01.325869 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m02:32:01.326247 [info ] [Thread-1 (]: 26 of 29 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m02:32:01.326554 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:32:01.326766 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m02:32:01.327026 [info ] [Thread-1 (]: 27 of 29 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m02:32:01.327308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m02:32:01.327511 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m02:32:01.329911 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:32:01.330440 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m02:32:01.332313 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:32:01.332823 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:32:01.333016 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m02:32:01.333181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.351260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:32:01.351584 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:32:01.351806 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(v.value->>'id' AS INT) AS lost_reason_id,   -- Unique identifier for the lost reason
        v.value->>'label' AS lost_reason_name           -- Name of the lost reason
    FROM raw
    JOIN LATERAL jsonb_array_elements(field_value_options) AS v(value) ON TRUE -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


  );
  
  
[0m02:32:01.355565 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m02:32:01.357562 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:32:01.357835 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons" rename to "stg_lost_reasons__dbt_backup"
[0m02:32:01.359158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:01.361072 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:32:01.361280 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp" rename to "stg_lost_reasons"
[0m02:32:01.361973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:32:01.362793 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m02:32:01.362985 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:32:01.363153 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m02:32:01.364166 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:32:01.365326 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup"
[0m02:32:01.365685 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:32:01.365871 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup" cascade
[0m02:32:01.367514 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:32:01.368289 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m02:32:01.368626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07087b2c-e9d9-4063-bd8d-450f9936ba00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf83b0>]}
[0m02:32:01.368995 [info ] [Thread-1 (]: 27 of 29 OK created sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[32mSELECT 5[0m in 0.04s]
[0m02:32:01.369305 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m02:32:01.369697 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:32:01.369944 [info ] [Thread-1 (]: 28 of 29 START test not_null_stg_lost_reasons_lost_reason_id ................... [RUN]
[0m02:32:01.370215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_lost_reasons, now test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768)
[0m02:32:01.370400 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:32:01.372960 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:32:01.373556 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:32:01.374713 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:32:01.375106 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:32:01.375323 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: BEGIN
[0m02:32:01.375487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.393797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:32:01.394115 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:32:01.394329 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lost_reason_id
from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is null



  
  
      
    ) dbt_internal_test
[0m02:32:01.395383 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:01.396272 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: ROLLBACK
[0m02:32:01.396972 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: Close
[0m02:32:01.397373 [info ] [Thread-1 (]: 28 of 29 PASS not_null_stg_lost_reasons_lost_reason_id ......................... [[32mPASS[0m in 0.03s]
[0m02:32:01.397699 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:32:01.397912 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:32:01.398140 [info ] [Thread-1 (]: 29 of 29 START test unique_stg_lost_reasons_lost_reason_id ..................... [RUN]
[0m02:32:01.398395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768, now test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d)
[0m02:32:01.398594 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:32:01.400806 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:32:01.401315 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:32:01.402722 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:32:01.403110 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:32:01.403286 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: BEGIN
[0m02:32:01.403437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:32:01.422484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:32:01.422779 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:32:01.422986 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    lost_reason_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is not null
group by lost_reason_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:32:01.424354 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:32:01.425362 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: ROLLBACK
[0m02:32:01.426095 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: Close
[0m02:32:01.426437 [info ] [Thread-1 (]: 29 of 29 PASS unique_stg_lost_reasons_lost_reason_id ........................... [[32mPASS[0m in 0.03s]
[0m02:32:01.426732 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:32:01.427451 [debug] [MainThread]: Using postgres connection "master"
[0m02:32:01.427627 [debug] [MainThread]: On master: BEGIN
[0m02:32:01.427773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:32:01.448588 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m02:32:01.448879 [debug] [MainThread]: On master: COMMIT
[0m02:32:01.449043 [debug] [MainThread]: Using postgres connection "master"
[0m02:32:01.449187 [debug] [MainThread]: On master: COMMIT
[0m02:32:01.449793 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:32:01.449942 [debug] [MainThread]: On master: Close
[0m02:32:01.450179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:32:01.450318 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' was properly closed.
[0m02:32:01.450546 [info ] [MainThread]: 
[0m02:32:01.450717 [info ] [MainThread]: Finished running 7 incremental models, 22 data tests in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m02:32:01.452703 [debug] [MainThread]: Command end result
[0m02:32:01.473182 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:32:01.475790 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:32:01.480043 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m02:32:01.480272 [info ] [MainThread]: 
[0m02:32:01.480509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:32:01.480693 [info ] [MainThread]: 
[0m02:32:01.480847 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=29
[0m02:32:01.482663 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.9329627, "process_in_blocks": "0", "process_kernel_time": 0.323911, "process_mem_max_rss": "134774784", "process_out_blocks": "0", "process_user_time": 1.76365}
[0m02:32:01.482955 [debug] [MainThread]: Command `dbt build` succeeded at 02:32:01.482908 after 1.93 seconds
[0m02:32:01.483151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d58050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d59a30>]}
[0m02:32:01.483336 [debug] [MainThread]: Flushing usage events
[0m02:32:03.152637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:57:50.024466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089139d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108913b10>]}


============================== 02:57:50.027851 | 9bddd66f-2161-4eed-a3df-bb679288a0b0 ==============================
[0m02:57:50.027851 [info ] [MainThread]: Running with dbt=1.10.11
[0m02:57:50.028184 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s tag:staging -f', 'introspect': 'True', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'False', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment'}
[0m02:57:50.137351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0fe10>]}
[0m02:57:50.166676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878fbd0>]}
[0m02:57:50.167380 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:57:50.217370 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m02:57:50.299588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:57:50.300012 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/int_deal_changes.sql
[0m02:57:50.539623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109655450>]}
[0m02:57:50.584322 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:57:50.585972 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:57:50.609428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097cf890>]}
[0m02:57:50.609719 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m02:57:50.611161 [info ] [MainThread]: 
[0m02:57:50.611336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:50.611467 [info ] [MainThread]: 
[0m02:57:50.611693 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:57:50.613718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:57:50.660409 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:57:50.660686 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:57:50.660838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:50.829688 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.169 seconds
[0m02:57:50.831020 [debug] [ThreadPool]: On list_postgres: Close
[0m02:57:50.832556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m02:57:50.836883 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:57:50.837146 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:57:50.837326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:50.858202 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m02:57:50.858563 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:57:50.858785 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:57:50.866884 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m02:57:50.867984 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:57:50.868726 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:57:50.872954 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:50.873200 [debug] [MainThread]: On master: BEGIN
[0m02:57:50.873375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:50.894208 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m02:57:50.894522 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:50.894794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:57:50.910128 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m02:57:50.911739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f35b0>]}
[0m02:57:50.912103 [debug] [MainThread]: On master: ROLLBACK
[0m02:57:50.912968 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:50.913168 [debug] [MainThread]: On master: BEGIN
[0m02:57:50.914712 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:57:50.914928 [debug] [MainThread]: On master: COMMIT
[0m02:57:50.915112 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:50.915288 [debug] [MainThread]: On master: COMMIT
[0m02:57:50.915966 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:57:50.916161 [debug] [MainThread]: On master: Close
[0m02:57:50.918297 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m02:57:50.918762 [info ] [Thread-1 (]: 1 of 29 START sql incremental model public_pipedrive_analytics.stg_activity .... [RUN]
[0m02:57:50.919091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m02:57:50.919328 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m02:57:50.927178 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m02:57:50.928344 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m02:57:50.960762 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m02:57:50.961388 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:57:50.961569 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m02:57:50.961727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:50.977717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m02:57:50.978020 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:57:50.978261 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity"
),

deduped AS (
    -- Deduplication logic:
    -- In raw data, sometimes the same activity_id may appear more than once 
    -- Since activity_id should uniquely represent an activity, we keep only the latest record.

    -- NOTE: In some edge cases, the same activity_id can have different user_id values. 
    -- This could usually happens when ownership or responsibility for an activity changes over time.
    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.
    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.
    SELECT *
    FROM (
        SELECT *,
               ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) AS rn
        FROM raw
    ) t
    WHERE rn = 1
),
cleaned AS (
    SELECT
        activity_id
        , type AS activity_type_short
        , assigned_to_user AS user_id
        , deal_id
        , done AS is_activity_done_status
        , due_to AS activity_due_timestamp
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
    WHERE TRUE
        AND activity_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:57:51.004445 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.026 seconds
[0m02:57:51.011301 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:57:51.011623 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m02:57:51.013097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.014959 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:57:51.015178 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m02:57:51.016065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.025395 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:57:51.025701 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:57:51.025868 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m02:57:51.033687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m02:57:51.037584 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m02:57:51.040245 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m02:57:51.040466 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m02:57:51.051196 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m02:57:51.052763 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m02:57:51.054069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f406d0>]}
[0m02:57:51.054466 [info ] [Thread-1 (]: 1 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity  [[32mSELECT 4568[0m in 0.13s]
[0m02:57:51.054824 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m02:57:51.055049 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m02:57:51.055350 [info ] [Thread-1 (]: 2 of 29 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m02:57:51.055670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m02:57:51.055850 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m02:57:51.058445 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m02:57:51.060215 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m02:57:51.068866 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m02:57:51.069477 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:57:51.069663 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m02:57:51.069823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.088552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:57:51.088815 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:57:51.088991 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:57:51.090817 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m02:57:51.092403 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:57:51.092586 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m02:57:51.093280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.094598 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:57:51.094797 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m02:57:51.095578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.096503 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:57:51.096725 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:57:51.096914 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:57:51.098321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:57:51.099786 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m02:57:51.100142 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:57:51.100326 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m02:57:51.101628 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:57:51.102401 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m02:57:51.102736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad9610>]}
[0m02:57:51.103086 [info ] [Thread-1 (]: 2 of 29 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mSELECT 4[0m in 0.05s]
[0m02:57:51.103433 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m02:57:51.103664 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m02:57:51.103975 [info ] [Thread-1 (]: 3 of 29 START sql incremental model public_pipedrive_analytics.stg_deal_changes  [RUN]
[0m02:57:51.104342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m02:57:51.104588 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m02:57:51.106856 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:57:51.107308 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m02:57:51.110008 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m02:57:51.110537 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:57:51.110805 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m02:57:51.110999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.132181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:57:51.132487 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:57:51.132700 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Each deal can have multiple changes over time.
-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.
-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."deal_changes"
),
deduped AS (
    SELECT
        deal_id
        , change_time
        , changed_field_key
        , new_value
        , ROW_NUMBER() OVER (
            PARTITION BY deal_id
            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.
          ) AS rn
    FROM raw
),
cleaned AS (
    SELECT
        -- Create unique surrogate key as string
        CONCAT(deal_id, '_', rn) AS deal_id_sk
        , deal_id
        , change_time AS deal_change_timestamp
        , changed_field_key AS deal_updated_field_key
        , new_value AS deal_new_value
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM deduped
)

SELECT *
FROM cleaned


  );
  
  
[0m02:57:51.168970 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.036 seconds
[0m02:57:51.170854 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:57:51.171075 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m02:57:51.173294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:57:51.174853 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:57:51.175055 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m02:57:51.176214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.176980 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:57:51.177144 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:57:51.177283 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m02:57:51.190076 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m02:57:51.191632 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m02:57:51.191981 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m02:57:51.192161 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m02:57:51.197556 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m02:57:51.198315 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m02:57:51.198634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e29440>]}
[0m02:57:51.198964 [info ] [Thread-1 (]: 3 of 29 OK created sql incremental model public_pipedrive_analytics.stg_deal_changes  [[32mSELECT 15406[0m in 0.09s]
[0m02:57:51.199249 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m02:57:51.199452 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m02:57:51.199763 [info ] [Thread-1 (]: 4 of 29 START sql incremental model public_pipedrive_analytics.stg_fields ...... [RUN]
[0m02:57:51.200080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m02:57:51.200251 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m02:57:51.202332 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m02:57:51.202834 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m02:57:51.205117 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m02:57:51.205668 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:57:51.205850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m02:57:51.206017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.227115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:57:51.227426 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:57:51.227664 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    


-- Contains metadata about deal fields, including picklist values in JSON.
-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.

WITH raw AS (
    SELECT *
    FROM "postgres"."public"."fields"
),
cleaned AS (
    SELECT
        field_key
        , name AS field_name
        , field_value_options   -- JSON structure holding picklist values

        -- Represents picklist options for fields like stage_id or lost_reason.
        -- Examples:
        -- 1. stage_id → maps to stages table (stage_id, stage_name)
        -- 2. lost_reason → maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)
        -- Fields like add_time or user_id have NULL because they are not picklists.

        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND field_key IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:57:51.230932 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m02:57:51.232759 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:57:51.232976 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m02:57:51.233680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.235124 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:57:51.235318 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m02:57:51.236047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.239170 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:57:51.239396 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:57:51.239584 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m02:57:51.241006 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:57:51.242259 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup"
[0m02:57:51.242633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m02:57:51.242825 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m02:57:51.244684 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:57:51.245429 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m02:57:51.245792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f82210>]}
[0m02:57:51.246155 [info ] [Thread-1 (]: 4 of 29 OK created sql incremental model public_pipedrive_analytics.stg_fields . [[32mSELECT 4[0m in 0.05s]
[0m02:57:51.246454 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m02:57:51.246667 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m02:57:51.246998 [info ] [Thread-1 (]: 5 of 29 START sql incremental model public_pipedrive_analytics.stg_stages ...... [RUN]
[0m02:57:51.247340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m02:57:51.247753 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m02:57:51.250105 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m02:57:51.250766 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m02:57:51.253119 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m02:57:51.253517 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:57:51.253689 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m02:57:51.253849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.272294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:57:51.272682 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:57:51.272914 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)
-- Data comes from the raw 'stages' table in Postgres.
-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, 
-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.


WITH raw AS (
    SELECT *
    FROM "postgres"."public"."stages"
),
cleaned AS (
    SELECT
        stage_id
        , stage_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND stage_id IS NOT NULL
)

SELECT *
FROM cleaned


  );
  
  
[0m02:57:51.275653 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m02:57:51.277517 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:57:51.277746 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m02:57:51.278705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.280746 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:57:51.281015 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m02:57:51.282125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.283074 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:57:51.283283 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:57:51.283867 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:57:51.285243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:57:51.286391 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m02:57:51.286743 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:57:51.286932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m02:57:51.289132 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:57:51.289944 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m02:57:51.290271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dbd350>]}
[0m02:57:51.290613 [info ] [Thread-1 (]: 5 of 29 OK created sql incremental model public_pipedrive_analytics.stg_stages . [[32mSELECT 9[0m in 0.04s]
[0m02:57:51.290901 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m02:57:51.291097 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m02:57:51.291357 [info ] [Thread-1 (]: 6 of 29 START sql incremental model public_pipedrive_analytics.stg_users ....... [RUN]
[0m02:57:51.291698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m02:57:51.291928 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m02:57:51.294158 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m02:57:51.294650 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m02:57:51.296843 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m02:57:51.297250 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:57:51.297426 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m02:57:51.297585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.317795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:57:51.318107 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:57:51.318316 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."users"
),
cleaned AS (
    SELECT
        id as user_id
        , name AS user_name
        , email AS user_email
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp
        , modified AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id is not null -- filter out any incomplete records
)

SELECT *
FROM cleaned


  );
  
  
[0m02:57:51.327275 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.009 seconds
[0m02:57:51.329311 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:57:51.329547 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m02:57:51.330881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.332527 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:57:51.332734 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m02:57:51.333840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:51.334840 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:57:51.335490 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:57:51.335689 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m02:57:51.339103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:57:51.340386 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m02:57:51.340747 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m02:57:51.340921 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m02:57:51.343976 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:57:51.344890 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m02:57:51.345365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f04600>]}
[0m02:57:51.345715 [info ] [Thread-1 (]: 6 of 29 OK created sql incremental model public_pipedrive_analytics.stg_users .. [[32mSELECT 1787[0m in 0.05s]
[0m02:57:51.345997 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m02:57:51.346190 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:57:51.346387 [info ] [Thread-1 (]: 7 of 29 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m02:57:51.346671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m02:57:51.346850 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:57:51.353039 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:57:51.354032 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:57:51.363705 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:57:51.364325 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:57:51.364513 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m02:57:51.364666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.384420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:57:51.384715 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:57:51.384900 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.386816 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:57:51.388737 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m02:57:51.389690 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m02:57:51.390116 [info ] [Thread-1 (]: 7 of 29 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.04s]
[0m02:57:51.390408 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:57:51.390625 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:57:51.390828 [info ] [Thread-1 (]: 8 of 29 START test not_null_stg_activity_activity_type_short ................... [RUN]
[0m02:57:51.391041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844)
[0m02:57:51.391201 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:57:51.393501 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:57:51.394060 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:57:51.395553 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:57:51.396230 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:57:51.396410 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: BEGIN
[0m02:57:51.396567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.422567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m02:57:51.422865 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"
[0m02:57:51.423069 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_short
from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_type_short is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.424632 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.425595 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: ROLLBACK
[0m02:57:51.426398 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844: Close
[0m02:57:51.427500 [info ] [Thread-1 (]: 8 of 29 PASS not_null_stg_activity_activity_type_short ......................... [[32mPASS[0m in 0.04s]
[0m02:57:51.428549 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844
[0m02:57:51.428805 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:57:51.429172 [info ] [Thread-1 (]: 9 of 29 START test not_null_stg_activity_user_id ............................... [RUN]
[0m02:57:51.429471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844, now test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272)
[0m02:57:51.429665 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:57:51.431832 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:57:51.432315 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:57:51.433417 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:57:51.433879 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:57:51.434053 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: BEGIN
[0m02:57:51.434208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.465970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m02:57:51.466822 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"
[0m02:57:51.467160 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_activity"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.470256 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:57:51.471216 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: ROLLBACK
[0m02:57:51.472011 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272: Close
[0m02:57:51.472357 [info ] [Thread-1 (]: 9 of 29 PASS not_null_stg_activity_user_id ..................................... [[32mPASS[0m in 0.04s]
[0m02:57:51.472646 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272
[0m02:57:51.472830 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:57:51.473040 [info ] [Thread-1 (]: 10 of 29 START test unique_stg_activity_activity_id ............................ [RUN]
[0m02:57:51.473269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m02:57:51.473448 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:57:51.477380 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:57:51.477960 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:57:51.479425 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:57:51.480263 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:57:51.480531 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m02:57:51.480704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.501219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:57:51.501638 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:57:51.501871 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:57:51.505242 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:57:51.506187 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m02:57:51.507068 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m02:57:51.507528 [info ] [Thread-1 (]: 10 of 29 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.03s]
[0m02:57:51.507854 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:57:51.508083 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:57:51.508307 [info ] [Thread-1 (]: 11 of 29 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m02:57:51.508568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m02:57:51.508753 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:57:51.511319 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:57:51.511891 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:57:51.513100 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:57:51.513549 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:57:51.513722 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m02:57:51.513877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.532847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:57:51.533243 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:57:51.533470 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.535403 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.536304 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m02:57:51.537121 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m02:57:51.537560 [info ] [Thread-1 (]: 11 of 29 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m02:57:51.537866 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:57:51.538073 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:57:51.538259 [info ] [Thread-1 (]: 12 of 29 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m02:57:51.538506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m02:57:51.538722 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:57:51.543441 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:57:51.544004 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:57:51.545576 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:57:51.546088 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:57:51.546310 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m02:57:51.546487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.565051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:57:51.565342 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m02:57:51.565542 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.567732 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:57:51.568574 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m02:57:51.569240 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m02:57:51.569681 [info ] [Thread-1 (]: 12 of 29 PASS relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[32mPASS[0m in 0.03s]
[0m02:57:51.569975 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m02:57:51.570158 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:57:51.570321 [info ] [Thread-1 (]: 13 of 29 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m02:57:51.570521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m02:57:51.570681 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:57:51.572604 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:57:51.573123 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:57:51.574240 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:57:51.574643 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:57:51.574821 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m02:57:51.574980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.591304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m02:57:51.591664 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:57:51.591874 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:57:51.593140 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.594054 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m02:57:51.594702 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m02:57:51.595043 [info ] [Thread-1 (]: 13 of 29 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.02s]
[0m02:57:51.595338 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:57:51.595541 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:57:51.595715 [info ] [Thread-1 (]: 14 of 29 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m02:57:51.595925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m02:57:51.596096 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:57:51.598906 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:57:51.599682 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:57:51.600826 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:57:51.601270 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:57:51.601453 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m02:57:51.601603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.618528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:57:51.618813 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:57:51.618993 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.620971 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:57:51.621822 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m02:57:51.622547 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m02:57:51.622918 [info ] [Thread-1 (]: 14 of 29 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m02:57:51.623247 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:57:51.623457 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:57:51.623645 [info ] [Thread-1 (]: 15 of 29 START test not_null_stg_deal_changes_deal_id_sk ....................... [RUN]
[0m02:57:51.623896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e)
[0m02:57:51.624092 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:57:51.626677 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:57:51.627185 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:57:51.628270 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:57:51.629190 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:57:51.629412 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: BEGIN
[0m02:57:51.629586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.655823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m02:57:51.656124 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"
[0m02:57:51.656327 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.658738 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:57:51.659745 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: ROLLBACK
[0m02:57:51.660556 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e: Close
[0m02:57:51.660943 [info ] [Thread-1 (]: 15 of 29 PASS not_null_stg_deal_changes_deal_id_sk ............................. [[32mPASS[0m in 0.04s]
[0m02:57:51.661274 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e
[0m02:57:51.661495 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:57:51.661697 [info ] [Thread-1 (]: 16 of 29 START test not_null_stg_deal_changes_deal_updated_field_key ........... [RUN]
[0m02:57:51.661979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624)
[0m02:57:51.662173 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:57:51.664771 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:57:51.665386 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:57:51.668652 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:57:51.669276 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:57:51.669475 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: BEGIN
[0m02:57:51.669655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.691754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:57:51.692071 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"
[0m02:57:51.692284 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_updated_field_key
from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_updated_field_key is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.694256 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:57:51.695170 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: ROLLBACK
[0m02:57:51.695809 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624: Close
[0m02:57:51.696230 [info ] [Thread-1 (]: 16 of 29 PASS not_null_stg_deal_changes_deal_updated_field_key ................. [[32mPASS[0m in 0.03s]
[0m02:57:51.696607 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624
[0m02:57:51.696812 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:57:51.697061 [info ] [Thread-1 (]: 17 of 29 START test unique_stg_deal_changes_deal_id_sk ......................... [RUN]
[0m02:57:51.697365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624, now test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600)
[0m02:57:51.697683 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:57:51.699986 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:57:51.700617 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:57:51.701731 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:57:51.702103 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:57:51.702271 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: BEGIN
[0m02:57:51.702430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.729931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m02:57:51.730227 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"
[0m02:57:51.730425 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:57:51.739606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m02:57:51.740613 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: ROLLBACK
[0m02:57:51.741535 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600: Close
[0m02:57:51.742127 [info ] [Thread-1 (]: 17 of 29 PASS unique_stg_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.04s]
[0m02:57:51.742471 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600
[0m02:57:51.742684 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:57:51.742914 [info ] [Thread-1 (]: 18 of 29 START test not_null_stg_fields_field_key .............................. [RUN]
[0m02:57:51.743157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m02:57:51.743517 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:57:51.746498 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:57:51.747327 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:57:51.749100 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:57:51.749755 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:57:51.749972 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m02:57:51.750154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.769006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:57:51.769301 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:57:51.769496 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.770369 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.771245 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m02:57:51.772180 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m02:57:51.772636 [info ] [Thread-1 (]: 18 of 29 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m02:57:51.773012 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:57:51.773253 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:57:51.773564 [info ] [Thread-1 (]: 19 of 29 START test relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [RUN]
[0m02:57:51.773882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa)
[0m02:57:51.774150 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:57:51.777720 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:57:51.778422 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:57:51.779699 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:57:51.780212 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:57:51.780478 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: BEGIN
[0m02:57:51.780671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.804497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m02:57:51.804820 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"
[0m02:57:51.805041 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select deal_updated_field_key as from_field
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where deal_updated_field_key is not null
),

parent as (
    select field_key as to_field
    from "postgres"."public_pipedrive_analytics"."stg_fields"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.808496 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:57:51.809455 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: ROLLBACK
[0m02:57:51.810239 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa: Close
[0m02:57:51.810626 [info ] [Thread-1 (]: 19 of 29 PASS relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_  [[32mPASS[0m in 0.04s]
[0m02:57:51.810962 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa
[0m02:57:51.811176 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:57:51.811394 [info ] [Thread-1 (]: 20 of 29 START test unique_stg_fields_field_key ................................ [RUN]
[0m02:57:51.811723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa, now test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4)
[0m02:57:51.811961 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:57:51.814535 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:57:51.815092 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:57:51.816770 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:57:51.817205 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:57:51.817396 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: BEGIN
[0m02:57:51.817570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.838021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:57:51.838326 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"
[0m02:57:51.838537 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_key as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_fields"
where field_key is not null
group by field_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:57:51.839869 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.840791 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: ROLLBACK
[0m02:57:51.841605 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4: Close
[0m02:57:51.842018 [info ] [Thread-1 (]: 20 of 29 PASS unique_stg_fields_field_key ...................................... [[32mPASS[0m in 0.03s]
[0m02:57:51.842343 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4
[0m02:57:51.842555 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:57:51.842788 [info ] [Thread-1 (]: 21 of 29 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m02:57:51.843093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m02:57:51.843338 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:57:51.845610 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:57:51.846086 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:57:51.847204 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:57:51.847575 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:57:51.847775 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m02:57:51.847945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.866774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:57:51.867046 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:57:51.867218 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.868328 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.869186 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m02:57:51.870416 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m02:57:51.870808 [info ] [Thread-1 (]: 21 of 29 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:57:51.871125 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:57:51.871336 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:57:51.871584 [info ] [Thread-1 (]: 22 of 29 START test unique_stg_stages_stage_id ................................. [RUN]
[0m02:57:51.871886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m02:57:51.872101 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:57:51.874792 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:57:51.875301 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:57:51.876401 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:57:51.876768 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:57:51.876961 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m02:57:51.877202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.895973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:57:51.896398 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:57:51.896672 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:57:51.898257 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.899232 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m02:57:51.900079 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m02:57:51.900464 [info ] [Thread-1 (]: 22 of 29 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m02:57:51.900777 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:57:51.900976 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:57:51.901158 [info ] [Thread-1 (]: 23 of 29 START test not_null_stg_users_user_id ................................. [RUN]
[0m02:57:51.901428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m02:57:51.901662 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:57:51.904307 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:57:51.904993 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:57:51.906133 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:57:51.906692 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:57:51.906908 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m02:57:51.907078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.926403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:57:51.926731 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:57:51.926928 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.928349 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.929227 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m02:57:51.929977 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m02:57:51.930558 [info ] [Thread-1 (]: 23 of 29 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m02:57:51.931001 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:57:51.931223 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:57:51.931486 [info ] [Thread-1 (]: 24 of 29 START test not_null_stg_users_user_name ............................... [RUN]
[0m02:57:51.931791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m02:57:51.931977 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:57:51.934310 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:57:51.935183 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:57:51.936732 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:57:51.937114 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:57:51.937300 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m02:57:51.937464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.955284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:57:51.955603 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:57:51.955803 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.956919 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.957843 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m02:57:51.958501 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m02:57:51.958900 [info ] [Thread-1 (]: 24 of 29 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m02:57:51.959225 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:57:51.959444 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:57:51.959690 [info ] [Thread-1 (]: 25 of 29 START test relationships_stg_activity_user_id__user_id__ref_stg_users_  [RUN]
[0m02:57:51.959936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02)
[0m02:57:51.960128 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:57:51.963090 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:57:51.963853 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:57:51.965336 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:57:51.965918 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:57:51.966162 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: BEGIN
[0m02:57:51.966373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.984527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:57:51.984803 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"
[0m02:57:51.984996 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m02:57:51.986684 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:51.987575 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: ROLLBACK
[0m02:57:51.988111 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02: Close
[0m02:57:51.988460 [info ] [Thread-1 (]: 25 of 29 PASS relationships_stg_activity_user_id__user_id__ref_stg_users_ ...... [[32mPASS[0m in 0.03s]
[0m02:57:51.988750 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02
[0m02:57:51.988943 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:57:51.989140 [info ] [Thread-1 (]: 26 of 29 START test unique_stg_users_user_id ................................... [RUN]
[0m02:57:51.989341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m02:57:51.989514 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:57:51.992062 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:57:51.992566 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:57:51.993632 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:57:51.993995 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:57:51.994163 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m02:57:51.994318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:52.009693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m02:57:52.009994 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:57:52.010192 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:57:52.011823 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:52.012726 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m02:57:52.013392 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m02:57:52.013881 [info ] [Thread-1 (]: 26 of 29 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m02:57:52.014306 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:57:52.014576 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_lost_reasons
[0m02:57:52.014858 [info ] [Thread-1 (]: 27 of 29 START sql incremental model public_pipedrive_analytics.stg_lost_reasons  [RUN]
[0m02:57:52.015163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.stg_lost_reasons)
[0m02:57:52.015393 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_lost_reasons
[0m02:57:52.017839 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:57:52.018535 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_lost_reasons
[0m02:57:52.020433 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_lost_reasons"
[0m02:57:52.021103 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:57:52.021287 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: BEGIN
[0m02:57:52.021443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:52.041810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:57:52.042124 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:57:52.042355 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp"
  
  
    as
  
  (
    

-- This table extracts all possible reasons a deal can be lost.
-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.
-- Each JSON object represents a lost reason with 'id' and 'name'.

WITH raw AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_fields"
    WHERE field_key = 'lost_reason'
),
unnested AS (
    -- Unnest the JSON array to get one row per lost reason
    SELECT
        CAST(v.value->>'id' AS INT) AS lost_reason_id,   -- Unique identifier for the lost reason
        v.value->>'label' AS lost_reason_name           -- Name of the lost reason
    FROM raw
    JOIN LATERAL jsonb_array_elements(field_value_options) AS v(value) ON TRUE -- Postgres function to expand JSON array into rows
),
cleaned AS (
    -- Add DWH tracking columns for auditing
    SELECT
        lost_reason_id
        , lost_reason_name
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   
    FROM unnested
)

SELECT *
FROM cleaned


  );
  
  
[0m02:57:52.045221 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m02:57:52.047116 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:57:52.047390 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons" rename to "stg_lost_reasons__dbt_backup"
[0m02:57:52.048338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:52.050309 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:57:52.050523 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_tmp" rename to "stg_lost_reasons"
[0m02:57:52.051775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:57:52.052558 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m02:57:52.052742 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:57:52.052913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: COMMIT
[0m02:57:52.054154 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:57:52.055282 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup"
[0m02:57:52.055624 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_lost_reasons"
[0m02:57:52.055805 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_lost_reasons"} */
drop table if exists "postgres"."public_pipedrive_analytics"."stg_lost_reasons__dbt_backup" cascade
[0m02:57:52.057624 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:57:52.058394 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_lost_reasons: Close
[0m02:57:52.058723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bddd66f-2161-4eed-a3df-bb679288a0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e47710>]}
[0m02:57:52.059073 [info ] [Thread-1 (]: 27 of 29 OK created sql incremental model public_pipedrive_analytics.stg_lost_reasons  [[32mSELECT 5[0m in 0.04s]
[0m02:57:52.059376 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_lost_reasons
[0m02:57:52.059771 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:57:52.060052 [info ] [Thread-1 (]: 28 of 29 START test not_null_stg_lost_reasons_lost_reason_id ................... [RUN]
[0m02:57:52.060358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_lost_reasons, now test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768)
[0m02:57:52.060556 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:57:52.063114 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:57:52.063789 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:57:52.065017 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:57:52.065611 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:57:52.065786 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: BEGIN
[0m02:57:52.065950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:52.083643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:57:52.083931 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"
[0m02:57:52.084128 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lost_reason_id
from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is null



  
  
      
    ) dbt_internal_test
[0m02:57:52.085083 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:52.085966 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: ROLLBACK
[0m02:57:52.086536 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768: Close
[0m02:57:52.086902 [info ] [Thread-1 (]: 28 of 29 PASS not_null_stg_lost_reasons_lost_reason_id ......................... [[32mPASS[0m in 0.03s]
[0m02:57:52.087206 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768
[0m02:57:52.087409 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:57:52.087621 [info ] [Thread-1 (]: 29 of 29 START test unique_stg_lost_reasons_lost_reason_id ..................... [RUN]
[0m02:57:52.087832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768, now test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d)
[0m02:57:52.088010 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:57:52.090225 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:57:52.090754 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:57:52.092208 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:57:52.092599 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:57:52.092775 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: BEGIN
[0m02:57:52.092968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:52.109310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m02:57:52.109608 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"
[0m02:57:52.109810 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    lost_reason_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_lost_reasons"
where lost_reason_id is not null
group by lost_reason_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:57:52.110894 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:57:52.111786 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: ROLLBACK
[0m02:57:52.112433 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d: Close
[0m02:57:52.112848 [info ] [Thread-1 (]: 29 of 29 PASS unique_stg_lost_reasons_lost_reason_id ........................... [[32mPASS[0m in 0.02s]
[0m02:57:52.113238 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d
[0m02:57:52.114025 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:52.114206 [debug] [MainThread]: On master: BEGIN
[0m02:57:52.114417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:57:52.136518 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m02:57:52.136807 [debug] [MainThread]: On master: COMMIT
[0m02:57:52.136975 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:52.137118 [debug] [MainThread]: On master: COMMIT
[0m02:57:52.137717 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:57:52.137927 [debug] [MainThread]: On master: Close
[0m02:57:52.138187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:52.138397 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d' was properly closed.
[0m02:57:52.138634 [info ] [MainThread]: 
[0m02:57:52.138816 [info ] [MainThread]: Finished running 7 incremental models, 22 data tests in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m02:57:52.140921 [debug] [MainThread]: Command end result
[0m02:57:52.159709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:57:52.161118 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:57:52.165560 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m02:57:52.165788 [info ] [MainThread]: 
[0m02:57:52.165976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:57:52.166125 [info ] [MainThread]: 
[0m02:57:52.166278 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=29
[0m02:57:52.168098 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.1878831, "process_in_blocks": "0", "process_kernel_time": 0.343605, "process_mem_max_rss": "133349376", "process_out_blocks": "0", "process_user_time": 1.782171}
[0m02:57:52.168318 [debug] [MainThread]: Command `dbt build` succeeded at 02:57:52.168277 after 2.19 seconds
[0m02:57:52.168489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ac59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0157f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e015310>]}
[0m02:57:52.168660 [debug] [MainThread]: Flushing usage events
[0m02:57:54.475115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:58:00.212882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b33b10>]}


============================== 02:58:00.215993 | 4627d7e7-d30f-4669-b35a-df514d29ad2f ==============================
[0m02:58:00.215993 [info ] [MainThread]: Running with dbt=1.10.11
[0m02:58:00.216311 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'version_check': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'empty': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt build -s tag:intermediate -f', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False'}
[0m02:58:00.307006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4627d7e7-d30f-4669-b35a-df514d29ad2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11092fe10>]}
[0m02:58:00.335006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4627d7e7-d30f-4669-b35a-df514d29ad2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b3bd0>]}
[0m02:58:00.336361 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:58:00.386542 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m02:58:00.466206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:00.466447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:00.490225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4627d7e7-d30f-4669-b35a-df514d29ad2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112923650>]}
[0m02:58:00.535327 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:58:00.536514 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:58:00.558091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4627d7e7-d30f-4669-b35a-df514d29ad2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bced50>]}
[0m02:58:00.558385 [info ] [MainThread]: Found 10 models, 27 data tests, 6 sources, 434 macros
[0m02:58:00.559610 [info ] [MainThread]: 
[0m02:58:00.559796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:00.559930 [info ] [MainThread]: 
[0m02:58:00.560176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:58:00.561953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:58:00.609177 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:58:00.609437 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:58:00.609583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:00.659132 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.049 seconds
[0m02:58:00.660016 [debug] [ThreadPool]: On list_postgres: Close
[0m02:58:00.661046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m02:58:00.664258 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:58:00.664480 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:58:00.664638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:58:00.681825 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m02:58:00.682119 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:58:00.682427 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:58:00.692917 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m02:58:00.693894 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:58:00.694537 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:58:00.698340 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:00.698598 [debug] [MainThread]: On master: BEGIN
[0m02:58:00.698761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:00.717118 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m02:58:00.717400 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:00.717632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:58:00.721238 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m02:58:00.721983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4627d7e7-d30f-4669-b35a-df514d29ad2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c9b930>]}
[0m02:58:00.722246 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:00.722781 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:00.722984 [debug] [MainThread]: On master: BEGIN
[0m02:58:00.723874 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:58:00.724075 [debug] [MainThread]: On master: COMMIT
[0m02:58:00.724238 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:00.724382 [debug] [MainThread]: On master: COMMIT
[0m02:58:00.724867 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:58:00.725038 [debug] [MainThread]: On master: Close
[0m02:58:00.726760 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity
[0m02:58:00.764023 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_analytics.int_activity ..... [RUN]
[0m02:58:00.764415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.int_activity)
[0m02:58:00.764607 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity
[0m02:58:00.771650 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity"
[0m02:58:00.772194 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activity
[0m02:58:00.799050 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activity"
[0m02:58:00.799620 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:58:00.799794 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: BEGIN
[0m02:58:00.799942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:00.821793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:58:00.822048 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:58:00.822271 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp"
  
  
    as
  
  (
    

-- Intermediate model that enriches activities with descriptive user and activity type information. 
-- Keeps 1 row per activity_id (deduped in stg_activity).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_activity"
),

user_enriched AS (
    SELECT
        b.activity_id
        , b.deal_id
        , b.user_id
        , u.user_name
        , u.user_email
        , b.activity_type_short
        , b.is_activity_done_status
        , b.activity_due_timestamp
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_users" u
      ON b.user_id = u.user_id
),

activity_type_enriched AS (
    SELECT
        ue.*
        , at.activity_type_name
        , at.is_activity_type_active
    FROM user_enriched ue
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_activity_types" at
      ON ue.activity_type_short = at.activity_type_short
)

SELECT *
FROM activity_type_enriched


  );
  
  
[0m02:58:00.842563 [debug] [Thread-1 (]: SQL status: SELECT 4568 in 0.020 seconds
[0m02:58:00.849187 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:58:00.849455 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity" rename to "int_activity__dbt_backup"
[0m02:58:00.850540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:58:00.852180 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:58:00.852400 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
alter table "postgres"."public_pipedrive_analytics"."int_activity__dbt_tmp" rename to "int_activity"
[0m02:58:00.853287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:58:00.863211 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m02:58:00.863453 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:58:00.863637 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: COMMIT
[0m02:58:00.873774 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m02:58:00.877746 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup"
[0m02:58:00.880495 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activity"
[0m02:58:00.880726 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activity"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_activity__dbt_backup" cascade
[0m02:58:00.887714 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m02:58:00.889258 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activity: Close
[0m02:58:00.890525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4627d7e7-d30f-4669-b35a-df514d29ad2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131d3ba0>]}
[0m02:58:00.890912 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model public_pipedrive_analytics.int_activity  [[32mSELECT 4568[0m in 0.13s]
[0m02:58:00.891228 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity
[0m02:58:00.891445 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes
[0m02:58:00.891740 [info ] [Thread-1 (]: 2 of 7 START sql incremental model public_pipedrive_analytics.int_deal_changes . [RUN]
[0m02:58:00.892031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity, now model.enpal_assessment_project.int_deal_changes)
[0m02:58:00.892219 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes
[0m02:58:00.894811 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes"
[0m02:58:00.895322 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes
[0m02:58:00.897968 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes"
[0m02:58:00.898652 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:58:00.898936 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: BEGIN
[0m02:58:00.899152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:00.920293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m02:58:00.920604 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:58:00.920867 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

-- Intermediate model that enriches deal changes with descriptive fields such as stage name or lost reason name. 
-- Keeps 1 row per deal change (normalized, auditable history).

WITH base AS (
    SELECT *
    FROM "postgres"."public_pipedrive_analytics"."stg_deal_changes"
),

-- Bring in stage names when the change refers to stage_id
stage_enriched AS (
    SELECT
        b.deal_id_sk
        , b.deal_id
        , b.deal_change_timestamp
        , b.deal_updated_field_key
        , b.deal_new_value
        , s.stage_name
        , NULL AS lost_reason_name
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_stages" s
     ON b.deal_new_value = CAST(s.stage_id AS TEXT)
    WHERE TRUE
        AND b.deal_updated_field_key = 'stage_id'
),

-- Bring in lost reason names when the change refers to lost_reason
lost_reason_enriched AS (
    SELECT
        b.deal_id_sk
        , b.deal_id
        , b.deal_change_timestamp
        , b.deal_updated_field_key
        , b.deal_new_value
        , NULL AS stage_name
        , lr.lost_reason_name
        , b.dwh_creation_timestamp
        , b.dwh_modified_timestamp
    FROM base b
    LEFT JOIN "postgres"."public_pipedrive_analytics"."stg_lost_reasons" lr
     ON  b.deal_new_value = CAST(lr.lost_reason_id AS TEXT)
    WHERE TRUE
        AND b.deal_updated_field_key = 'lost_reason'
),

final AS (
    SELECT
        deal_id_sk
        , deal_id
        , deal_change_timestamp
        , deal_updated_field_key
        , deal_new_value
        , stage_name
        , lost_reason_name
        , dwh_creation_timestamp
        , dwh_modified_timestamp
    FROM stage_enriched
UNION ALL
    SELECT
        deal_id_sk
        , deal_id
        , deal_change_timestamp
        , deal_updated_field_key
        , deal_new_value
        , stage_name
        , lost_reason_name
        , dwh_creation_timestamp
        , dwh_modified_timestamp
    FROM lost_reason_enriched
)

SELECT *
FROM final


  );
  
  
[0m02:58:00.960491 [debug] [Thread-1 (]: SQL status: SELECT 10906 in 0.039 seconds
[0m02:58:00.962318 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:58:00.962532 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes" rename to "int_deal_changes__dbt_backup"
[0m02:58:00.963392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:58:00.964848 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:58:00.965047 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_tmp" rename to "int_deal_changes"
[0m02:58:00.965721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:58:00.966659 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m02:58:00.966884 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:58:00.967499 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: COMMIT
[0m02:58:00.977734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m02:58:00.979247 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_backup"
[0m02:58:00.979655 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes"
[0m02:58:00.979857 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_deal_changes__dbt_backup" cascade
[0m02:58:00.984491 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:58:00.985292 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes: Close
[0m02:58:00.985663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4627d7e7-d30f-4669-b35a-df514d29ad2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c73a10>]}
[0m02:58:00.986088 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model public_pipedrive_analytics.int_deal_changes  [[32mSELECT 10906[0m in 0.09s]
[0m02:58:00.986431 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes
[0m02:58:00.986646 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m02:58:00.986888 [info ] [Thread-1 (]: 3 of 7 START test not_null_int_activity_activity_id ............................ [RUN]
[0m02:58:00.987221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes, now test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f)
[0m02:58:00.987462 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m02:58:00.994803 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m02:58:00.995428 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m02:58:01.008048 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m02:58:01.008694 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m02:58:01.008898 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: BEGIN
[0m02:58:01.009073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:01.029166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:58:01.029484 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"
[0m02:58:01.029687 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m02:58:01.031527 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:58:01.033515 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: ROLLBACK
[0m02:58:01.034323 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f: Close
[0m02:58:01.034706 [info ] [Thread-1 (]: 3 of 7 PASS not_null_int_activity_activity_id .................................. [[32mPASS[0m in 0.05s]
[0m02:58:01.035005 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f
[0m02:58:01.035203 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m02:58:01.035430 [info ] [Thread-1 (]: 4 of 7 START test unique_int_activity_activity_id .............................. [RUN]
[0m02:58:01.035707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f, now test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e)
[0m02:58:01.035895 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m02:58:01.039198 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m02:58:01.040092 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m02:58:01.042161 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m02:58:01.042784 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m02:58:01.042959 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: BEGIN
[0m02:58:01.043108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:01.061562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:58:01.061869 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"
[0m02:58:01.062073 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:58:01.065429 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:58:01.066452 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: ROLLBACK
[0m02:58:01.067153 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e: Close
[0m02:58:01.067532 [info ] [Thread-1 (]: 4 of 7 PASS unique_int_activity_activity_id .................................... [[32mPASS[0m in 0.03s]
[0m02:58:01.067844 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e
[0m02:58:01.068049 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m02:58:01.068298 [info ] [Thread-1 (]: 5 of 7 START test not_null_int_deal_changes_deal_id ............................ [RUN]
[0m02:58:01.068594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1)
[0m02:58:01.068811 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m02:58:01.071038 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m02:58:01.071777 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m02:58:01.072899 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m02:58:01.073285 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m02:58:01.073498 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: BEGIN
[0m02:58:01.073715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:01.090983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:58:01.091293 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"
[0m02:58:01.091488 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m02:58:01.093536 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:58:01.094403 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: ROLLBACK
[0m02:58:01.095023 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1: Close
[0m02:58:01.095512 [info ] [Thread-1 (]: 5 of 7 PASS not_null_int_deal_changes_deal_id .................................. [[32mPASS[0m in 0.03s]
[0m02:58:01.095900 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1
[0m02:58:01.096179 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m02:58:01.096542 [info ] [Thread-1 (]: 6 of 7 START test not_null_int_deal_changes_deal_id_sk ......................... [RUN]
[0m02:58:01.096852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1, now test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813)
[0m02:58:01.097048 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m02:58:01.099750 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m02:58:01.100296 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m02:58:01.101385 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m02:58:01.101963 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m02:58:01.102206 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: BEGIN
[0m02:58:01.102382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:01.121524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m02:58:01.121810 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"
[0m02:58:01.122005 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id_sk
from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is null



  
  
      
    ) dbt_internal_test
[0m02:58:01.123571 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:58:01.124478 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: ROLLBACK
[0m02:58:01.125191 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813: Close
[0m02:58:01.125568 [info ] [Thread-1 (]: 6 of 7 PASS not_null_int_deal_changes_deal_id_sk ............................... [[32mPASS[0m in 0.03s]
[0m02:58:01.125929 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813
[0m02:58:01.126150 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m02:58:01.126354 [info ] [Thread-1 (]: 7 of 7 START test unique_int_deal_changes_deal_id_sk ........................... [RUN]
[0m02:58:01.126565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813, now test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a)
[0m02:58:01.126747 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m02:58:01.129327 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m02:58:01.130026 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m02:58:01.131603 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m02:58:01.132373 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m02:58:01.132630 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: BEGIN
[0m02:58:01.132794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:01.160336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m02:58:01.160745 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"
[0m02:58:01.160979 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    deal_id_sk as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes"
where deal_id_sk is not null
group by deal_id_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:58:01.166122 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:58:01.167096 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: ROLLBACK
[0m02:58:01.167977 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a: Close
[0m02:58:01.168447 [info ] [Thread-1 (]: 7 of 7 PASS unique_int_deal_changes_deal_id_sk ................................. [[32mPASS[0m in 0.04s]
[0m02:58:01.168798 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a
[0m02:58:01.169722 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:01.169997 [debug] [MainThread]: On master: BEGIN
[0m02:58:01.170163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:01.190236 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m02:58:01.190604 [debug] [MainThread]: On master: COMMIT
[0m02:58:01.190765 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:01.190900 [debug] [MainThread]: On master: COMMIT
[0m02:58:01.191552 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:58:01.191763 [debug] [MainThread]: On master: Close
[0m02:58:01.192033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:01.192199 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a' was properly closed.
[0m02:58:01.192393 [info ] [MainThread]: 
[0m02:58:01.192577 [info ] [MainThread]: Finished running 2 incremental models, 5 data tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m02:58:01.193280 [debug] [MainThread]: Command end result
[0m02:58:01.210463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m02:58:01.211519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:58:01.214932 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m02:58:01.215161 [info ] [MainThread]: 
[0m02:58:01.215344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:01.215483 [info ] [MainThread]: 
[0m02:58:01.215625 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m02:58:01.218004 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.043149, "process_in_blocks": "0", "process_kernel_time": 0.248683, "process_mem_max_rss": "127680512", "process_out_blocks": "0", "process_user_time": 1.257458}
[0m02:58:01.218375 [debug] [MainThread]: Command `dbt build` succeeded at 02:58:01.218322 after 1.04 seconds
[0m02:58:01.218585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c338b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120244b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118eb390>]}
[0m02:58:01.218785 [debug] [MainThread]: Flushing usage events
[0m02:58:02.642072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:04:48.142422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107833b10>]}


============================== 03:04:48.146457 | b3ea61e1-cd23-4f2f-8202-d629367033cb ==============================
[0m03:04:48.146457 [info ] [MainThread]: Running with dbt=1.10.11
[0m03:04:48.146839 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt build -s tag:reporting -f', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'no_print': 'None', 'write_json': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default'}
[0m03:04:48.256395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3ea61e1-cd23-4f2f-8202-d629367033cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662fe10>]}
[0m03:04:48.284567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3ea61e1-cd23-4f2f-8202-d629367033cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b3bd0>]}
[0m03:04:48.285116 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m03:04:48.338207 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m03:04:48.396991 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: reporting/rep_schema.yml - Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |   - name: rep_sales_funnel_monthly
    5  |     description: Aggregated monthly sales funnel report combining stage-based, activity-based, and lost reason-based events. 
    6  |     Shows the number of deals at each funnel step/KPI per month.
    7  |     owner: nvegi
    8  |     meta:
    9  |       grain: month_year + funnel_step  # Each row is unique by month and funnel step
    10 |       kpi_source: 'Stage changes, activities, lost reasons'
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 6, column 5
    could not find expected ':'
      in "<unicode string>", line 7, column 5
[0m03:04:48.399369 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.2997007, "process_in_blocks": "0", "process_kernel_time": 0.18008, "process_mem_max_rss": "116391936", "process_out_blocks": "0", "process_user_time": 0.851387}
[0m03:04:48.399672 [debug] [MainThread]: Command `dbt build` failed at 03:04:48.399617 after 0.30 seconds
[0m03:04:48.399901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11052bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ee4e0>]}
[0m03:04:48.400092 [debug] [MainThread]: Flushing usage events
[0m03:04:50.061828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:05:32.851725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106494050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072df9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dfb10>]}


============================== 03:05:32.855175 | fd04451b-4b42-4cdc-965e-d80b361f3fad ==============================
[0m03:05:32.855175 [info ] [MainThread]: Running with dbt=1.10.11
[0m03:05:32.855503 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt build -s tag:reporting -f', 'use_colors': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'target_path': 'None', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False'}
[0m03:05:32.961785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd04451b-4b42-4cdc-965e-d80b361f3fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065dbe10>]}
[0m03:05:32.991147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd04451b-4b42-4cdc-965e-d80b361f3fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715fbd0>]}
[0m03:05:32.991856 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m03:05:33.040637 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m03:05:33.124279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:05:33.124699 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/reporting/rep_schema.yml
[0m03:05:33.124899 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/reporting/rep_sales_funnel_monthly.sql
[0m03:05:33.357541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd04451b-4b42-4cdc-965e-d80b361f3fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd0050>]}
[0m03:05:33.402248 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:05:33.406427 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:05:33.430452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd04451b-4b42-4cdc-965e-d80b361f3fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081777a0>]}
[0m03:05:33.430789 [info ] [MainThread]: Found 10 models, 31 data tests, 6 sources, 434 macros
[0m03:05:33.432027 [info ] [MainThread]: 
[0m03:05:33.432206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:33.432338 [info ] [MainThread]: 
[0m03:05:33.432561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:33.432981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m03:05:33.486341 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:05:33.486602 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:05:33.486756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:33.659402 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.173 seconds
[0m03:05:33.660536 [debug] [ThreadPool]: On list_postgres: Close
[0m03:05:33.663939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m03:05:33.667789 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:05:33.668057 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m03:05:33.668214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:33.686171 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m03:05:33.686466 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:05:33.686627 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m03:05:33.694957 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m03:05:33.695948 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m03:05:33.696718 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m03:05:33.699966 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:33.700488 [debug] [MainThread]: On master: BEGIN
[0m03:05:33.700629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:05:33.718759 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m03:05:33.719080 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:33.719347 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:05:33.725179 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m03:05:33.725935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd04451b-4b42-4cdc-965e-d80b361f3fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a9e10>]}
[0m03:05:33.726207 [debug] [MainThread]: On master: ROLLBACK
[0m03:05:33.726802 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:33.726946 [debug] [MainThread]: On master: BEGIN
[0m03:05:33.727908 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:05:33.728049 [debug] [MainThread]: On master: COMMIT
[0m03:05:33.728180 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:33.728324 [debug] [MainThread]: On master: COMMIT
[0m03:05:33.728989 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:05:33.729154 [debug] [MainThread]: On master: Close
[0m03:05:33.731071 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:05:33.731456 [info ] [Thread-1 (]: 1 of 5 START sql incremental model public_pipedrive_analytics.rep_sales_funnel_monthly  [RUN]
[0m03:05:33.731763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m03:05:33.731997 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:05:33.738203 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:05:33.739490 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:05:33.770504 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:05:33.771243 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:05:33.771451 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m03:05:33.771623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:33.789830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m03:05:33.790145 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:05:33.790477 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
  
  
    as
  
  (
    

-- Aggregates deal and activity data to create a monthly sales funnel view.

-- Column definitions:
-- month: Month of the activity or stage change (first day of month)
-- kpi_name: Name of the KPI corresponding to the funnel step
-- funnel_step: Funnel step identifier (Step 1, Step 2.1, etc.)
-- deals_count: Count of unique deals in that month and funnel step

WITH
-- Stage-based funnel steps (from int_deal_changes)
stage_funnel AS (
    SELECT
        -- EXTRACT(MONTH FROM deal_change_timestamp) AS month
        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year
        ,  CASE 
            WHEN stage_name = 'Lead Generation' THEN 'Lead Generation'
            WHEN stage_name = 'Qualified Lead' THEN 'Qualified Lead'
            WHEN stage_name = 'Needs Assessment' THEN 'Needs Assessment'
            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Proposal/Quote Preparation'
            WHEN stage_name = 'Negotiation' THEN 'Negotiation'
            WHEN stage_name = 'Closing' THEN 'Closing'
            WHEN stage_name = 'Implementation/Onboarding' THEN 'Implementation/Onboarding'
            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Follow-up/Customer Success'
            WHEN stage_name = 'Renewal/Expansion' THEN 'Renewal/Expansion'
            ELSE NULL
          END AS kpi_name
        , CASE 
            WHEN stage_name = 'Lead Generation' THEN 'Step 1'
            WHEN stage_name = 'Qualified Lead' THEN 'Step 2'
            WHEN stage_name = 'Needs Assessment' THEN 'Step 3'
            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Step 4'
            WHEN stage_name = 'Negotiation' THEN 'Step 5'
            WHEN stage_name = 'Closing' THEN 'Step 6'
            WHEN stage_name = 'Implementation/Onboarding' THEN 'Step 7'
            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Step 8'
            WHEN stage_name = 'Renewal/Expansion' THEN 'Step 9'
            ELSE NULL
          END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_deal_changes"
    WHERE TRUE
        AND stage_name IS NOT NULL
),

-- Activity-based funnel steps (from int_activity)
activity_funnel AS (
    SELECT
        -- EXTRACT(MONTH FROM activity_due_timestamp) AS month
        TO_CHAR(activity_due_timestamp, 'MM-YYYY') AS month_year
        , CASE 
            WHEN activity_type_short = 'meeting' THEN 'Sales Call 1'
            WHEN activity_type_short = 'sc_2' THEN 'Sales Call 2'
            WHEN activity_type_short = 'follow_up' THEN 'Follow-up/Customer Success'
            WHEN activity_type_short = 'after_close_call' THEN 'Closing'
            ELSE NULL
          END AS kpi_name
        , CASE 
            WHEN activity_type_short = 'meeting' THEN 'Step 2.1'
            WHEN activity_type_short = 'sc_2' THEN 'Step 3.1'
            WHEN activity_type_short = 'after_close_call' THEN 'Step 6'
            WHEN activity_type_short = 'follow_up' THEN 'Step 8'
            ELSE NULL
         END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_activity"
    WHERE TRUE
        AND activity_type_short IN ('meeting','sc_2','follow_up','after_close_call')
),

-- Lost Reason-based funnel steps (from int_deal_changes)
lost_reason_funnel AS (
    SELECT
        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year
        , lost_reason_name AS kpi_name
        , CASE 
            WHEN lost_reason_name = 'Customer Not Ready' THEN 'Step 1'
            WHEN lost_reason_name = 'Pricing Issues' THEN 'Step 2'
            WHEN lost_reason_name = 'Unreachable Customer	' THEN 'Step 3'
            WHEN lost_reason_name = 'Product Mismatch' THEN 'Step 4'
            WHEN lost_reason_name = 'Duplicate Entry' THEN 'Step 5'
            ELSE NULL
        END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_deal_changes"
    WHERE TRUE
    AND lost_reason_name IS NOT NULL
),

-- Union all funnel events
all_funnel AS (
    SELECT * FROM stage_funnel
    UNION ALL
    SELECT * FROM activity_funnel
    UNION ALL
    SELECT * FROM lost_reason_funnel
),

-- Aggregate by month-year + funnel step
aggregated AS (
    SELECT
        month_year
        , kpi_name,
        , funnel_step
        , COUNT(DISTINCT deal_id) AS deals_count
    FROM all_funnel
    WHERE kpi_name IS NOT NULL
    GROUP BY 1,2,3
)

SELECT *
FROM aggregated


  );
  
  
[0m03:05:33.792115 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 117:         , funnel_step
                  ^

[0m03:05:33.792399 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: ROLLBACK
[0m03:05:33.793411 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m03:05:33.800214 [debug] [Thread-1 (]: Database Error in model rep_sales_funnel_monthly (models/reporting/rep_sales_funnel_monthly.sql)
  syntax error at or near ","
  LINE 117:         , funnel_step
                    ^
  compiled code at target/run/enpal_assessment_project/models/reporting/rep_sales_funnel_monthly.sql
[0m03:05:33.801521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd04451b-4b42-4cdc-965e-d80b361f3fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088add90>]}
[0m03:05:33.801900 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model public_pipedrive_analytics.rep_sales_funnel_monthly  [[31mERROR[0m in 0.07s]
[0m03:05:33.802205 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:05:33.802474 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.rep_sales_funnel_monthly' to be skipped because of status 'error'.  Reason: Database Error in model rep_sales_funnel_monthly (models/reporting/rep_sales_funnel_monthly.sql)
  syntax error at or near ","
  LINE 117:         , funnel_step
                    ^
  compiled code at target/run/enpal_assessment_project/models/reporting/rep_sales_funnel_monthly.sql.
[0m03:05:33.803072 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:05:33.803288 [info ] [Thread-1 (]: 2 of 5 SKIP test not_null_rep_sales_funnel_monthly_deals_count ................. [[33mSKIP[0m]
[0m03:05:33.803476 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:05:33.803640 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:05:33.803779 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246' to be skipped because of status 'skipped'. 
[0m03:05:33.803960 [info ] [Thread-1 (]: 3 of 5 SKIP test not_null_rep_sales_funnel_monthly_funnel_step ................. [[33mSKIP[0m]
[0m03:05:33.804211 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:05:33.804383 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:05:33.804657 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61' to be skipped because of status 'skipped'. 
[0m03:05:33.804552 [info ] [Thread-1 (]: 4 of 5 SKIP test not_null_rep_sales_funnel_monthly_kpi_name .................... [[33mSKIP[0m]
[0m03:05:33.804882 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:05:33.805041 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:05:33.805163 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0' to be skipped because of status 'skipped'. 
[0m03:05:33.805320 [info ] [Thread-1 (]: 5 of 5 SKIP test not_null_rep_sales_funnel_monthly_month_year .................. [[33mSKIP[0m]
[0m03:05:33.805541 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:05:33.805685 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa' to be skipped because of status 'skipped'. 
[0m03:05:33.806280 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:33.806426 [debug] [MainThread]: On master: BEGIN
[0m03:05:33.806544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:05:33.827013 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m03:05:33.827282 [debug] [MainThread]: On master: COMMIT
[0m03:05:33.827439 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:33.827573 [debug] [MainThread]: On master: COMMIT
[0m03:05:33.828186 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:33.828322 [debug] [MainThread]: On master: Close
[0m03:05:33.828537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:33.828660 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m03:05:33.828810 [info ] [MainThread]: 
[0m03:05:33.828956 [info ] [MainThread]: Finished running 1 incremental model, 4 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m03:05:33.829332 [debug] [MainThread]: Command end result
[0m03:05:33.846361 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:05:33.847528 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:05:33.850412 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m03:05:33.850580 [info ] [MainThread]: 
[0m03:05:33.850767 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:05:33.850908 [info ] [MainThread]: 
[0m03:05:33.851086 [error] [MainThread]: [31mFailure in model rep_sales_funnel_monthly (models/reporting/rep_sales_funnel_monthly.sql)[0m
[0m03:05:33.851261 [error] [MainThread]:   Database Error in model rep_sales_funnel_monthly (models/reporting/rep_sales_funnel_monthly.sql)
  syntax error at or near ","
  LINE 117:         , funnel_step
                    ^
  compiled code at target/run/enpal_assessment_project/models/reporting/rep_sales_funnel_monthly.sql
[0m03:05:33.851385 [info ] [MainThread]: 
[0m03:05:33.851538 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/reporting/rep_sales_funnel_monthly.sql
[0m03:05:33.851657 [info ] [MainThread]: 
[0m03:05:33.851790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=5
[0m03:05:33.853440 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.0489669, "process_in_blocks": "0", "process_kernel_time": 0.237217, "process_mem_max_rss": "136953856", "process_out_blocks": "0", "process_user_time": 1.299453}
[0m03:05:33.853645 [debug] [MainThread]: Command `dbt build` failed at 03:05:33.853605 after 1.05 seconds
[0m03:05:33.853812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107161850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108477d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108477c20>]}
[0m03:05:33.853964 [debug] [MainThread]: Flushing usage events
[0m03:05:35.361824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:05:48.291505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab33b10>]}


============================== 03:05:48.295128 | 891d8151-e74c-4b09-902e-15e0afa0352d ==============================
[0m03:05:48.295128 [info ] [MainThread]: Running with dbt=1.10.11
[0m03:05:48.295482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -s tag:reporting -f', 'log_cache_events': 'False', 'static_parser': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False'}
[0m03:05:48.409390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '891d8151-e74c-4b09-902e-15e0afa0352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109233e10>]}
[0m03:05:48.445411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '891d8151-e74c-4b09-902e-15e0afa0352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b3bd0>]}
[0m03:05:48.446362 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m03:05:48.509472 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m03:05:48.588825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:05:48.589253 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/reporting/rep_sales_funnel_monthly.sql
[0m03:05:48.823472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '891d8151-e74c-4b09-902e-15e0afa0352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9c0050>]}
[0m03:05:48.868943 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:05:48.870283 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:05:48.892309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '891d8151-e74c-4b09-902e-15e0afa0352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb7f7a0>]}
[0m03:05:48.892592 [info ] [MainThread]: Found 10 models, 31 data tests, 6 sources, 434 macros
[0m03:05:48.893776 [info ] [MainThread]: 
[0m03:05:48.893955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:48.894083 [info ] [MainThread]: 
[0m03:05:48.894304 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:48.894730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m03:05:48.940557 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:05:48.940798 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:05:48.940942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:48.993319 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.052 seconds
[0m03:05:48.994216 [debug] [ThreadPool]: On list_postgres: Close
[0m03:05:48.996870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m03:05:48.999877 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:05:49.000060 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m03:05:49.000196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:49.018492 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m03:05:49.018801 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:05:49.018985 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m03:05:49.023120 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m03:05:49.024163 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m03:05:49.024956 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m03:05:49.028601 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:49.029159 [debug] [MainThread]: On master: BEGIN
[0m03:05:49.029312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:05:49.047826 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m03:05:49.048110 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:49.048317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:05:49.053122 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m03:05:49.053937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891d8151-e74c-4b09-902e-15e0afa0352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bae0670>]}
[0m03:05:49.054211 [debug] [MainThread]: On master: ROLLBACK
[0m03:05:49.054791 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:49.054939 [debug] [MainThread]: On master: BEGIN
[0m03:05:49.055768 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:05:49.055931 [debug] [MainThread]: On master: COMMIT
[0m03:05:49.056073 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:49.056201 [debug] [MainThread]: On master: COMMIT
[0m03:05:49.056660 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:49.056802 [debug] [MainThread]: On master: Close
[0m03:05:49.058521 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:05:49.058827 [info ] [Thread-1 (]: 1 of 5 START sql incremental model public_pipedrive_analytics.rep_sales_funnel_monthly  [RUN]
[0m03:05:49.059062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m03:05:49.059241 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:05:49.064374 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:05:49.064868 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:05:49.093599 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:05:49.094128 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:05:49.094304 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m03:05:49.094456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:49.120606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m03:05:49.120941 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:05:49.121301 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
  
  
    as
  
  (
    

-- Aggregates deal and activity data to create a monthly sales funnel view.

-- Column definitions:
-- month: Month of the activity or stage change (first day of month)
-- kpi_name: Name of the KPI corresponding to the funnel step
-- funnel_step: Funnel step identifier (Step 1, Step 2.1, etc.)
-- deals_count: Count of unique deals in that month and funnel step

WITH
-- Stage-based funnel steps (from int_deal_changes)
stage_funnel AS (
    SELECT
        -- EXTRACT(MONTH FROM deal_change_timestamp) AS month
        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year
        ,  CASE 
            WHEN stage_name = 'Lead Generation' THEN 'Lead Generation'
            WHEN stage_name = 'Qualified Lead' THEN 'Qualified Lead'
            WHEN stage_name = 'Needs Assessment' THEN 'Needs Assessment'
            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Proposal/Quote Preparation'
            WHEN stage_name = 'Negotiation' THEN 'Negotiation'
            WHEN stage_name = 'Closing' THEN 'Closing'
            WHEN stage_name = 'Implementation/Onboarding' THEN 'Implementation/Onboarding'
            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Follow-up/Customer Success'
            WHEN stage_name = 'Renewal/Expansion' THEN 'Renewal/Expansion'
            ELSE NULL
          END AS kpi_name
        , CASE 
            WHEN stage_name = 'Lead Generation' THEN 'Step 1'
            WHEN stage_name = 'Qualified Lead' THEN 'Step 2'
            WHEN stage_name = 'Needs Assessment' THEN 'Step 3'
            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Step 4'
            WHEN stage_name = 'Negotiation' THEN 'Step 5'
            WHEN stage_name = 'Closing' THEN 'Step 6'
            WHEN stage_name = 'Implementation/Onboarding' THEN 'Step 7'
            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Step 8'
            WHEN stage_name = 'Renewal/Expansion' THEN 'Step 9'
            ELSE NULL
          END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_deal_changes"
    WHERE TRUE
        AND stage_name IS NOT NULL
),

-- Activity-based funnel steps (from int_activity)
activity_funnel AS (
    SELECT
        -- EXTRACT(MONTH FROM activity_due_timestamp) AS month
        TO_CHAR(activity_due_timestamp, 'MM-YYYY') AS month_year
        , CASE 
            WHEN activity_type_short = 'meeting' THEN 'Sales Call 1'
            WHEN activity_type_short = 'sc_2' THEN 'Sales Call 2'
            WHEN activity_type_short = 'follow_up' THEN 'Follow-up/Customer Success'
            WHEN activity_type_short = 'after_close_call' THEN 'Closing'
            ELSE NULL
          END AS kpi_name
        , CASE 
            WHEN activity_type_short = 'meeting' THEN 'Step 2.1'
            WHEN activity_type_short = 'sc_2' THEN 'Step 3.1'
            WHEN activity_type_short = 'after_close_call' THEN 'Step 6'
            WHEN activity_type_short = 'follow_up' THEN 'Step 8'
            ELSE NULL
         END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_activity"
    WHERE TRUE
        AND activity_type_short IN ('meeting','sc_2','follow_up','after_close_call')
),

-- Lost Reason-based funnel steps (from int_deal_changes)
lost_reason_funnel AS (
    SELECT
        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year
        , lost_reason_name AS kpi_name
        , CASE 
            WHEN lost_reason_name = 'Customer Not Ready' THEN 'Step 1'
            WHEN lost_reason_name = 'Pricing Issues' THEN 'Step 2'
            WHEN lost_reason_name = 'Unreachable Customer	' THEN 'Step 3'
            WHEN lost_reason_name = 'Product Mismatch' THEN 'Step 4'
            WHEN lost_reason_name = 'Duplicate Entry' THEN 'Step 5'
            ELSE NULL
        END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_deal_changes"
    WHERE TRUE
    AND lost_reason_name IS NOT NULL
),

-- Union all funnel events
all_funnel AS (
    SELECT * FROM stage_funnel
    UNION ALL
    SELECT * FROM activity_funnel
    UNION ALL
    SELECT * FROM lost_reason_funnel
),

-- Aggregate by month-year + funnel step
aggregated AS (
    SELECT
        month_year
        , kpi_name
        , funnel_step
        , COUNT(DISTINCT deal_id) AS deals_count
    FROM all_funnel
    WHERE kpi_name IS NOT NULL
    GROUP BY 1,2,3
)

SELECT *
FROM aggregated


  );
  
  
[0m03:05:49.181844 [debug] [Thread-1 (]: SQL status: SELECT 185 in 0.060 seconds
[0m03:05:49.191624 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m03:05:49.191899 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:05:49.192065 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m03:05:49.194724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:05:49.195964 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m03:05:49.197346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891d8151-e74c-4b09-902e-15e0afa0352d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2aa4e0>]}
[0m03:05:49.197743 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model public_pipedrive_analytics.rep_sales_funnel_monthly  [[32mSELECT 185[0m in 0.14s]
[0m03:05:49.198034 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:05:49.198614 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:05:49.198789 [info ] [Thread-1 (]: 2 of 5 START test not_null_rep_sales_funnel_monthly_deals_count ................ [RUN]
[0m03:05:49.199013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246)
[0m03:05:49.199173 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:05:49.206243 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:05:49.207115 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:05:49.216781 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:05:49.217538 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:05:49.217726 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: BEGIN
[0m03:05:49.217884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:49.236970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m03:05:49.237785 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:05:49.238064 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deals_count
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where deals_count is null



  
  
      
    ) dbt_internal_test
[0m03:05:49.239628 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:05:49.241398 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: ROLLBACK
[0m03:05:49.242433 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: Close
[0m03:05:49.242768 [info ] [Thread-1 (]: 2 of 5 PASS not_null_rep_sales_funnel_monthly_deals_count ...................... [[32mPASS[0m in 0.04s]
[0m03:05:49.243042 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:05:49.243228 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:05:49.243427 [info ] [Thread-1 (]: 3 of 5 START test not_null_rep_sales_funnel_monthly_funnel_step ................ [RUN]
[0m03:05:49.243620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61)
[0m03:05:49.243782 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:05:49.246176 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:05:49.246703 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:05:49.247688 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:05:49.248040 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:05:49.248197 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: BEGIN
[0m03:05:49.248362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:49.266160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m03:05:49.266457 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:05:49.266657 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m03:05:49.267723 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:05:49.268625 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: ROLLBACK
[0m03:05:49.269358 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: Close
[0m03:05:49.269715 [error] [Thread-1 (]: 3 of 5 FAIL 14 not_null_rep_sales_funnel_monthly_funnel_step ................... [[31mFAIL 14[0m in 0.03s]
[0m03:05:49.270080 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:05:49.270286 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:05:49.270466 [info ] [Thread-1 (]: 4 of 5 START test not_null_rep_sales_funnel_monthly_kpi_name ................... [RUN]
[0m03:05:49.270742 [debug] [Thread-4 (]: Marking all children of 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61' to be skipped because of status 'fail'.  Reason: Got 14 results, configured to fail if != 0.
[0m03:05:49.271038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0)
[0m03:05:49.271655 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:05:49.274344 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:05:49.274953 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:05:49.276183 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:05:49.276633 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:05:49.276812 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: BEGIN
[0m03:05:49.276969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:49.303065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m03:05:49.303378 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:05:49.303577 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kpi_name
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where kpi_name is null



  
  
      
    ) dbt_internal_test
[0m03:05:49.305927 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:05:49.307278 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: ROLLBACK
[0m03:05:49.308751 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: Close
[0m03:05:49.309155 [info ] [Thread-1 (]: 4 of 5 PASS not_null_rep_sales_funnel_monthly_kpi_name ......................... [[32mPASS[0m in 0.04s]
[0m03:05:49.309696 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:05:49.309973 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:05:49.310186 [info ] [Thread-1 (]: 5 of 5 START test not_null_rep_sales_funnel_monthly_month_year ................. [RUN]
[0m03:05:49.310501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa)
[0m03:05:49.310688 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:05:49.312989 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:05:49.313593 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:05:49.315213 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:05:49.316015 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:05:49.316222 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: BEGIN
[0m03:05:49.316387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:49.335813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m03:05:49.336115 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:05:49.336321 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month_year
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where month_year is null



  
  
      
    ) dbt_internal_test
[0m03:05:49.337480 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:05:49.338537 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: ROLLBACK
[0m03:05:49.339379 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: Close
[0m03:05:49.339754 [info ] [Thread-1 (]: 5 of 5 PASS not_null_rep_sales_funnel_monthly_month_year ....................... [[32mPASS[0m in 0.03s]
[0m03:05:49.340041 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:05:49.340677 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:49.340866 [debug] [MainThread]: On master: BEGIN
[0m03:05:49.341007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:05:49.359879 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m03:05:49.360229 [debug] [MainThread]: On master: COMMIT
[0m03:05:49.360411 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:49.360554 [debug] [MainThread]: On master: COMMIT
[0m03:05:49.361092 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:49.361254 [debug] [MainThread]: On master: Close
[0m03:05:49.361485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:49.361617 [debug] [MainThread]: Connection 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa' was properly closed.
[0m03:05:49.361782 [info ] [MainThread]: 
[0m03:05:49.361939 [info ] [MainThread]: Finished running 1 incremental model, 4 data tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m03:05:49.362490 [debug] [MainThread]: Command end result
[0m03:05:49.383520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:05:49.384753 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:05:49.388766 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m03:05:49.389005 [info ] [MainThread]: 
[0m03:05:49.389285 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:05:49.389438 [info ] [MainThread]: 
[0m03:05:49.389666 [error] [MainThread]: [31mFailure in test not_null_rep_sales_funnel_monthly_funnel_step (models/reporting/rep_schema.yml)[0m
[0m03:05:49.389859 [error] [MainThread]:   Got 14 results, configured to fail if != 0
[0m03:05:49.389987 [info ] [MainThread]: 
[0m03:05:49.390161 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/reporting/rep_schema.yml/not_null_rep_sales_funnel_monthly_funnel_step.sql
[0m03:05:49.390336 [info ] [MainThread]: 
[0m03:05:49.390525 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m03:05:49.392412 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.144621, "process_in_blocks": "0", "process_kernel_time": 0.258185, "process_mem_max_rss": "133660672", "process_out_blocks": "0", "process_user_time": 1.391391}
[0m03:05:49.392677 [debug] [MainThread]: Command `dbt build` failed at 03:05:49.392633 after 1.14 seconds
[0m03:05:49.392913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be6bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be6bcd0>]}
[0m03:05:49.393189 [debug] [MainThread]: Flushing usage events
[0m03:05:50.727550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:09:17.519591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108933b10>]}


============================== 03:09:17.523001 | eb9bc94d-ad86-48ae-bf8f-c1367509a849 ==============================
[0m03:09:17.523001 [info ] [MainThread]: Running with dbt=1.10.11
[0m03:09:17.523340 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'indirect_selection': 'eager', 'warn_error': 'None', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt build -s tag:reporting -f', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'cache_selected_only': 'False'}
[0m03:09:17.631606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb9bc94d-ad86-48ae-bf8f-c1367509a849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702fe10>]}
[0m03:09:17.659948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb9bc94d-ad86-48ae-bf8f-c1367509a849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b3bd0>]}
[0m03:09:17.660527 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m03:09:17.713107 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m03:09:17.798533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:09:17.799009 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/reporting/rep_sales_funnel_monthly.sql
[0m03:09:18.033770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb9bc94d-ad86-48ae-bf8f-c1367509a849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc0050>]}
[0m03:09:18.079167 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:09:18.080872 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:09:18.103750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb9bc94d-ad86-48ae-bf8f-c1367509a849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af7f7a0>]}
[0m03:09:18.104039 [info ] [MainThread]: Found 10 models, 31 data tests, 6 sources, 434 macros
[0m03:09:18.105206 [info ] [MainThread]: 
[0m03:09:18.105374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:18.105504 [info ] [MainThread]: 
[0m03:09:18.105723 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:09:18.106133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m03:09:18.152656 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:09:18.152903 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:09:18.153045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:18.245017 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.092 seconds
[0m03:09:18.246113 [debug] [ThreadPool]: On list_postgres: Close
[0m03:09:18.250268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m03:09:18.254378 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:09:18.254672 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m03:09:18.254831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:18.275442 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m03:09:18.275734 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:09:18.275914 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m03:09:18.281132 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m03:09:18.282179 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m03:09:18.283006 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m03:09:18.287377 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:18.287642 [debug] [MainThread]: On master: BEGIN
[0m03:09:18.287793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:18.308923 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m03:09:18.309191 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:18.309403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:09:18.319068 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m03:09:18.319828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb9bc94d-ad86-48ae-bf8f-c1367509a849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adc8670>]}
[0m03:09:18.320090 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:18.320790 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:18.320980 [debug] [MainThread]: On master: BEGIN
[0m03:09:18.322116 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:09:18.322320 [debug] [MainThread]: On master: COMMIT
[0m03:09:18.322468 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:18.322594 [debug] [MainThread]: On master: COMMIT
[0m03:09:18.323206 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:09:18.323345 [debug] [MainThread]: On master: Close
[0m03:09:18.325130 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:09:18.325460 [info ] [Thread-1 (]: 1 of 5 START sql incremental model public_pipedrive_analytics.rep_sales_funnel_monthly  [RUN]
[0m03:09:18.325705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m03:09:18.325883 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:09:18.331899 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:09:18.332746 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:09:18.361280 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:09:18.361829 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:09:18.362007 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m03:09:18.362160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:18.377880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m03:09:18.378159 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:09:18.378456 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    

-- Aggregates deal and activity data to create a monthly sales funnel view.

-- Column definitions:
-- month: Month of the activity or stage change (first day of month)
-- kpi_name: Name of the KPI corresponding to the funnel step
-- funnel_step: Funnel step identifier (Step 1, Step 2.1, etc.)
-- deals_count: Count of unique deals in that month and funnel step

WITH
-- Stage-based funnel steps (from int_deal_changes)
stage_funnel AS (
    SELECT
        -- EXTRACT(MONTH FROM deal_change_timestamp) AS month
        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year
        ,  CASE 
            WHEN stage_name = 'Lead Generation' THEN 'Lead Generation'
            WHEN stage_name = 'Qualified Lead' THEN 'Qualified Lead'
            WHEN stage_name = 'Needs Assessment' THEN 'Needs Assessment'
            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Proposal/Quote Preparation'
            WHEN stage_name = 'Negotiation' THEN 'Negotiation'
            WHEN stage_name = 'Closing' THEN 'Closing'
            WHEN stage_name = 'Implementation/Onboarding' THEN 'Implementation/Onboarding'
            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Follow-up/Customer Success'
            WHEN stage_name = 'Renewal/Expansion' THEN 'Renewal/Expansion'
            ELSE NULL
          END AS kpi_name
        , CASE 
            WHEN stage_name = 'Lead Generation' THEN 'Step 1'
            WHEN stage_name = 'Qualified Lead' THEN 'Step 2'
            WHEN stage_name = 'Needs Assessment' THEN 'Step 3'
            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Step 4'
            WHEN stage_name = 'Negotiation' THEN 'Step 5'
            WHEN stage_name = 'Closing' THEN 'Step 6'
            WHEN stage_name = 'Implementation/Onboarding' THEN 'Step 7'
            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Step 8'
            WHEN stage_name = 'Renewal/Expansion' THEN 'Step 9'
            ELSE NULL
          END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_deal_changes"
    WHERE TRUE
        AND stage_name IS NOT NULL
),

-- Activity-based funnel steps (from int_activity)
activity_funnel AS (
    SELECT
        -- EXTRACT(MONTH FROM activity_due_timestamp) AS month
        TO_CHAR(activity_due_timestamp, 'MM-YYYY') AS month_year
        , CASE 
            WHEN activity_type_short = 'meeting' THEN 'Sales Call 1'
            WHEN activity_type_short = 'sc_2' THEN 'Sales Call 2'
            WHEN activity_type_short = 'follow_up' THEN 'Follow-up/Customer Success'
            WHEN activity_type_short = 'after_close_call' THEN 'Closing'
            ELSE NULL
          END AS kpi_name
        , CASE 
            WHEN activity_type_short = 'meeting' THEN 'Step 2.1'
            WHEN activity_type_short = 'sc_2' THEN 'Step 3.1'
            WHEN activity_type_short = 'after_close_call' THEN 'Step 6'
            WHEN activity_type_short = 'follow_up' THEN 'Step 8'
            ELSE NULL
         END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_activity"
    WHERE TRUE
        AND activity_type_short IN ('meeting','sc_2','follow_up','after_close_call')
),

-- Lost Reason-based funnel steps (from int_deal_changes)
lost_reason_funnel AS (
    SELECT
        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year
        , lost_reason_name AS kpi_name
        , CASE 
            WHEN lost_reason_name = 'Customer Not Ready' THEN 'Step 1'
            WHEN lost_reason_name = 'Pricing Issues' THEN 'Step 2'
            WHEN lost_reason_name = 'Unreachable Customer' THEN 'Step 3'
            WHEN lost_reason_name = 'Product Mismatch' THEN 'Step 4'
            WHEN lost_reason_name = 'Duplicate Entry' THEN 'Step 5'
            ELSE NULL
        END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_deal_changes"
    WHERE TRUE
    AND lost_reason_name IS NOT NULL
),

-- Union all funnel events
all_funnel AS (
    SELECT * FROM stage_funnel
    UNION ALL
    SELECT * FROM activity_funnel
    UNION ALL
    SELECT * FROM lost_reason_funnel
),

-- Aggregate by month-year + funnel step
aggregated AS (
    SELECT
        month_year
        , kpi_name
        , funnel_step
        , COUNT(DISTINCT deal_id) AS deals_count
    FROM all_funnel
    WHERE kpi_name IS NOT NULL
    GROUP BY 1,2,3
)

SELECT *
FROM aggregated


  );
  
  
[0m03:09:18.421897 [debug] [Thread-1 (]: SQL status: SELECT 185 in 0.043 seconds
[0m03:09:18.427525 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:09:18.427805 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly" rename to "rep_sales_funnel_monthly__dbt_backup"
[0m03:09:18.429638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:09:18.431276 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:09:18.431492 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m03:09:18.432436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:09:18.441364 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m03:09:18.441705 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:09:18.441888 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m03:09:18.443992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:09:18.447300 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m03:09:18.449544 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:09:18.449726 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m03:09:18.452782 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m03:09:18.454235 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m03:09:18.455554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9bc94d-ad86-48ae-bf8f-c1367509a849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d4050>]}
[0m03:09:18.455977 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model public_pipedrive_analytics.rep_sales_funnel_monthly  [[32mSELECT 185[0m in 0.13s]
[0m03:09:18.456319 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:09:18.456762 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:09:18.457031 [info ] [Thread-1 (]: 2 of 5 START test not_null_rep_sales_funnel_monthly_deals_count ................ [RUN]
[0m03:09:18.457311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246)
[0m03:09:18.457517 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:09:18.464083 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:09:18.464915 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:09:18.475712 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:09:18.476523 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:09:18.476721 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: BEGIN
[0m03:09:18.476884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:18.493807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m03:09:18.494100 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:09:18.494297 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deals_count
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where deals_count is null



  
  
      
    ) dbt_internal_test
[0m03:09:18.495537 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:09:18.497423 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: ROLLBACK
[0m03:09:18.498154 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: Close
[0m03:09:18.498549 [info ] [Thread-1 (]: 2 of 5 PASS not_null_rep_sales_funnel_monthly_deals_count ...................... [[32mPASS[0m in 0.04s]
[0m03:09:18.498863 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:09:18.499068 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:09:18.499244 [info ] [Thread-1 (]: 3 of 5 START test not_null_rep_sales_funnel_monthly_funnel_step ................ [RUN]
[0m03:09:18.499501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61)
[0m03:09:18.499708 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:09:18.501860 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:09:18.502687 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:09:18.503856 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:09:18.504224 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:09:18.504397 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: BEGIN
[0m03:09:18.504559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:18.522376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m03:09:18.522656 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:09:18.522832 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m03:09:18.525542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m03:09:18.526363 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: ROLLBACK
[0m03:09:18.526940 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: Close
[0m03:09:18.527276 [info ] [Thread-1 (]: 3 of 5 PASS not_null_rep_sales_funnel_monthly_funnel_step ...................... [[32mPASS[0m in 0.03s]
[0m03:09:18.527645 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:09:18.527854 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:09:18.528024 [info ] [Thread-1 (]: 4 of 5 START test not_null_rep_sales_funnel_monthly_kpi_name ................... [RUN]
[0m03:09:18.528248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0)
[0m03:09:18.528419 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:09:18.530857 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:09:18.531626 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:09:18.532636 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:09:18.533065 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:09:18.533228 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: BEGIN
[0m03:09:18.533374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:18.550031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m03:09:18.550330 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:09:18.550527 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kpi_name
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where kpi_name is null



  
  
      
    ) dbt_internal_test
[0m03:09:18.551662 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:09:18.552626 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: ROLLBACK
[0m03:09:18.553963 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: Close
[0m03:09:18.554339 [info ] [Thread-1 (]: 4 of 5 PASS not_null_rep_sales_funnel_monthly_kpi_name ......................... [[32mPASS[0m in 0.03s]
[0m03:09:18.554629 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:09:18.554825 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:09:18.555000 [info ] [Thread-1 (]: 5 of 5 START test not_null_rep_sales_funnel_monthly_month_year ................. [RUN]
[0m03:09:18.555214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa)
[0m03:09:18.555448 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:09:18.558548 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:09:18.559238 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:09:18.560573 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:09:18.561127 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:09:18.561313 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: BEGIN
[0m03:09:18.561469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:18.583400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m03:09:18.583714 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:09:18.583913 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month_year
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where month_year is null



  
  
      
    ) dbt_internal_test
[0m03:09:18.585393 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:09:18.586664 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: ROLLBACK
[0m03:09:18.587632 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: Close
[0m03:09:18.588039 [info ] [Thread-1 (]: 5 of 5 PASS not_null_rep_sales_funnel_monthly_month_year ....................... [[32mPASS[0m in 0.03s]
[0m03:09:18.588476 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:09:18.589202 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:18.589382 [debug] [MainThread]: On master: BEGIN
[0m03:09:18.589526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:18.610131 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m03:09:18.610547 [debug] [MainThread]: On master: COMMIT
[0m03:09:18.610721 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:18.610851 [debug] [MainThread]: On master: COMMIT
[0m03:09:18.611445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:09:18.611611 [debug] [MainThread]: On master: Close
[0m03:09:18.611837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:18.611971 [debug] [MainThread]: Connection 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa' was properly closed.
[0m03:09:18.612138 [info ] [MainThread]: 
[0m03:09:18.612288 [info ] [MainThread]: Finished running 1 incremental model, 4 data tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m03:09:18.612850 [debug] [MainThread]: Command end result
[0m03:09:18.633311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:09:18.634413 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:09:18.637926 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m03:09:18.638122 [info ] [MainThread]: 
[0m03:09:18.638291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:18.638424 [info ] [MainThread]: 
[0m03:09:18.638570 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m03:09:18.640516 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.1623192, "process_in_blocks": "0", "process_kernel_time": 0.263274, "process_mem_max_rss": "136101888", "process_out_blocks": "0", "process_user_time": 1.385575}
[0m03:09:18.640827 [debug] [MainThread]: Command `dbt build` succeeded at 03:09:18.640780 after 1.16 seconds
[0m03:09:18.641017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be77ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be77d80>]}
[0m03:09:18.641200 [debug] [MainThread]: Flushing usage events
[0m03:09:20.260539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:26:53.830629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b37b10>]}


============================== 03:26:53.834089 | d3d1a66c-6cfa-4fbb-98f9-e462650f8c07 ==============================
[0m03:26:53.834089 [info ] [MainThread]: Running with dbt=1.10.11
[0m03:26:53.834402 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s tag:reporting -f', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'empty': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m03:26:53.961000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3d1a66c-6cfa-4fbb-98f9-e462650f8c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107233e10>]}
[0m03:26:53.989668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3d1a66c-6cfa-4fbb-98f9-e462650f8c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b3bd0>]}
[0m03:26:53.990217 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m03:26:54.044287 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m03:26:54.127349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:26:54.127807 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/reporting/rep_sales_funnel_monthly.sql
[0m03:26:54.366543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3d1a66c-6cfa-4fbb-98f9-e462650f8c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c0050>]}
[0m03:26:54.412277 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:26:54.413670 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:26:54.437758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3d1a66c-6cfa-4fbb-98f9-e462650f8c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a37f7a0>]}
[0m03:26:54.438052 [info ] [MainThread]: Found 10 models, 31 data tests, 6 sources, 434 macros
[0m03:26:54.439253 [info ] [MainThread]: 
[0m03:26:54.439434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:26:54.439569 [info ] [MainThread]: 
[0m03:26:54.439796 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:26:54.440210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m03:26:54.498771 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:26:54.499028 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:26:54.499169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:54.796478 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.297 seconds
[0m03:26:54.797706 [debug] [ThreadPool]: On list_postgres: Close
[0m03:26:54.801441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m03:26:54.805264 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:26:54.805535 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m03:26:54.805704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:54.825187 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m03:26:54.825442 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:26:54.825604 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m03:26:54.831482 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m03:26:54.832702 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m03:26:54.833670 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m03:26:54.839301 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:54.839616 [debug] [MainThread]: On master: BEGIN
[0m03:26:54.839812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:26:54.860699 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m03:26:54.861059 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:54.861368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:26:54.869927 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m03:26:54.870939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3d1a66c-6cfa-4fbb-98f9-e462650f8c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ac670>]}
[0m03:26:54.871265 [debug] [MainThread]: On master: ROLLBACK
[0m03:26:54.872107 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:54.872301 [debug] [MainThread]: On master: BEGIN
[0m03:26:54.873442 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:26:54.873632 [debug] [MainThread]: On master: COMMIT
[0m03:26:54.873797 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:54.873943 [debug] [MainThread]: On master: COMMIT
[0m03:26:54.874556 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:26:54.874735 [debug] [MainThread]: On master: Close
[0m03:26:54.876539 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:26:54.876933 [info ] [Thread-1 (]: 1 of 5 START sql incremental model public_pipedrive_analytics.rep_sales_funnel_monthly  [RUN]
[0m03:26:54.877258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m03:26:54.877485 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:26:54.884695 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:26:54.885434 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:26:54.914336 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:26:54.914986 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:26:54.915182 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m03:26:54.915356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:54.932981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m03:26:54.933281 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:26:54.933613 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

      
  
    

  create  table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    

-- Aggregates deal and activity data to create a monthly sales funnel view.

-- Column definitions:
-- month: Month of the activity or stage change (first day of month)
-- kpi_name: Name of the KPI corresponding to the funnel step
-- funnel_step: Funnel step identifier (Step 1, Step 2.1, etc.)
-- deals_count: Count of unique deals in that month and funnel step

WITH
-- Stage-based funnel steps (from int_deal_changes)
stage_funnel AS (
    SELECT
        -- EXTRACT(MONTH FROM deal_change_timestamp) AS month
        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year
        ,  CASE 
            WHEN stage_name = 'Lead Generation' THEN 'Stage: Lead Generation'
            WHEN stage_name = 'Qualified Lead' THEN 'Stage: Qualified Lead'
            WHEN stage_name = 'Needs Assessment' THEN 'Stage: Needs Assessment'
            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Stage: Proposal/Quote Preparation'
            WHEN stage_name = 'Negotiation' THEN 'Stage: Negotiation'
            WHEN stage_name = 'Closing' THEN 'Stage: Closing'
            WHEN stage_name = 'Implementation/Onboarding' THEN 'Stage: Implementation/Onboarding'
            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Stage: Follow-up/Customer Success'
            WHEN stage_name = 'Renewal/Expansion' THEN 'Stage: Renewal/Expansion'
            ELSE NULL
          END AS kpi_name
        , CASE 
            WHEN stage_name = 'Lead Generation' THEN 'Step 1'
            WHEN stage_name = 'Qualified Lead' THEN 'Step 2'
            WHEN stage_name = 'Needs Assessment' THEN 'Step 3'
            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Step 4'
            WHEN stage_name = 'Negotiation' THEN 'Step 5'
            WHEN stage_name = 'Closing' THEN 'Step 6'
            WHEN stage_name = 'Implementation/Onboarding' THEN 'Step 7'
            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Step 8'
            WHEN stage_name = 'Renewal/Expansion' THEN 'Step 9'
            ELSE NULL
          END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_deal_changes"
    WHERE TRUE
        AND stage_name IS NOT NULL
),

-- Activity-based funnel steps (from int_activity)
activity_funnel AS (
    SELECT
        -- EXTRACT(MONTH FROM activity_due_timestamp) AS month
        TO_CHAR(activity_due_timestamp, 'MM-YYYY') AS month_year
        , CASE 
            WHEN activity_type_short = 'meeting' THEN 'Activity: Sales Call 1'
            WHEN activity_type_short = 'sc_2' THEN 'Activity: Sales Call 2'
            WHEN activity_type_short = 'follow_up' THEN 'Activity: Follow-up/Customer Success'
            WHEN activity_type_short = 'after_close_call' THEN 'Activity: Closing'
            ELSE NULL
          END AS kpi_name
        , CASE 
            WHEN activity_type_short = 'meeting' THEN 'Step 2.1'
            WHEN activity_type_short = 'sc_2' THEN 'Step 3.1'
            WHEN activity_type_short = 'after_close_call' THEN 'Step 6'
            WHEN activity_type_short = 'follow_up' THEN 'Step 8'
            ELSE NULL
         END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_activity"
    WHERE TRUE
        AND activity_type_short IN ('meeting','sc_2','follow_up','after_close_call')
),

-- Lost Reason-based funnel steps (from int_deal_changes)
lost_reason_funnel AS (
    SELECT
        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year
        , CASE 
            WHEN lost_reason_name = 'Customer Not Ready' THEN 'Lost Reason: Customer Not Ready'
            WHEN lost_reason_name = 'Pricing Issues' THEN 'Lost Reason: Pricing Issues'
            WHEN lost_reason_name = 'Unreachable Customer' THEN 'Lost Reason: Unreachable Customer'
            WHEN lost_reason_name = 'Product Mismatch' THEN 'Lost Reason: Product Mismatch'
            WHEN lost_reason_name = 'Duplicate Entry' THEN 'Lost Reason: Duplicate Entry'
            ELSE NULL
        END AS kpi_name
        , CASE 
            WHEN lost_reason_name = 'Customer Not Ready' THEN 'Step 1'
            WHEN lost_reason_name = 'Pricing Issues' THEN 'Step 2'
            WHEN lost_reason_name = 'Unreachable Customer' THEN 'Step 3'
            WHEN lost_reason_name = 'Product Mismatch' THEN 'Step 4'
            WHEN lost_reason_name = 'Duplicate Entry' THEN 'Step 5'
            ELSE NULL
        END AS funnel_step
        , deal_id
    FROM "postgres"."public_pipedrive_analytics"."int_deal_changes"
    WHERE TRUE
    AND lost_reason_name IS NOT NULL
),

-- Union all funnel events
all_funnel AS (
    SELECT * FROM stage_funnel
    UNION ALL
    SELECT * FROM activity_funnel
    UNION ALL
    SELECT * FROM lost_reason_funnel
),

-- Aggregate by month-year + funnel step
aggregated AS (
    SELECT
        month_year
        , kpi_name
        , funnel_step
        , COUNT(DISTINCT deal_id) AS deals_count
    FROM all_funnel
    WHERE kpi_name IS NOT NULL
    GROUP BY 1,2,3
)

SELECT *
FROM aggregated


  );
  
  
[0m03:26:54.998186 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.064 seconds
[0m03:26:55.004080 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:26:55.004342 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly" rename to "rep_sales_funnel_monthly__dbt_backup"
[0m03:26:55.006083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:26:55.007713 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:26:55.007933 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m03:26:55.008723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:26:55.019262 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m03:26:55.019538 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:26:55.019752 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m03:26:55.021775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:26:55.025644 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m03:26:55.028516 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m03:26:55.028758 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m03:26:55.036694 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m03:26:55.038510 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m03:26:55.039966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d1a66c-6cfa-4fbb-98f9-e462650f8c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac90120>]}
[0m03:26:55.040450 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model public_pipedrive_analytics.rep_sales_funnel_monthly  [[32mSELECT 200[0m in 0.16s]
[0m03:26:55.040819 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m03:26:55.041328 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:26:55.041584 [info ] [Thread-1 (]: 2 of 5 START test not_null_rep_sales_funnel_monthly_deals_count ................ [RUN]
[0m03:26:55.041852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246)
[0m03:26:55.042053 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:26:55.048965 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:26:55.049742 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:26:55.060183 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:26:55.060772 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:26:55.060961 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: BEGIN
[0m03:26:55.061131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:55.077314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m03:26:55.077603 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"
[0m03:26:55.077801 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deals_count
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where deals_count is null



  
  
      
    ) dbt_internal_test
[0m03:26:55.078880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:26:55.080793 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: ROLLBACK
[0m03:26:55.081748 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246: Close
[0m03:26:55.082110 [info ] [Thread-1 (]: 2 of 5 PASS not_null_rep_sales_funnel_monthly_deals_count ...................... [[32mPASS[0m in 0.04s]
[0m03:26:55.082418 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246
[0m03:26:55.082620 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:26:55.082800 [info ] [Thread-1 (]: 3 of 5 START test not_null_rep_sales_funnel_monthly_funnel_step ................ [RUN]
[0m03:26:55.083104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61)
[0m03:26:55.083322 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:26:55.085439 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:26:55.085944 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:26:55.087032 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:26:55.087407 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:26:55.087577 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: BEGIN
[0m03:26:55.087735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:55.103160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m03:26:55.103429 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:26:55.103607 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m03:26:55.104448 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:26:55.105277 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: ROLLBACK
[0m03:26:55.105896 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: Close
[0m03:26:55.106228 [info ] [Thread-1 (]: 3 of 5 PASS not_null_rep_sales_funnel_monthly_funnel_step ...................... [[32mPASS[0m in 0.02s]
[0m03:26:55.106595 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:26:55.106858 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:26:55.107069 [info ] [Thread-1 (]: 4 of 5 START test not_null_rep_sales_funnel_monthly_kpi_name ................... [RUN]
[0m03:26:55.107334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0)
[0m03:26:55.107523 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:26:55.109932 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:26:55.110394 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:26:55.111392 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:26:55.111775 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:26:55.112163 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: BEGIN
[0m03:26:55.112385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:55.129587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m03:26:55.129903 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:26:55.130101 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kpi_name
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where kpi_name is null



  
  
      
    ) dbt_internal_test
[0m03:26:55.131409 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:26:55.132518 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: ROLLBACK
[0m03:26:55.133458 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: Close
[0m03:26:55.133789 [info ] [Thread-1 (]: 4 of 5 PASS not_null_rep_sales_funnel_monthly_kpi_name ......................... [[32mPASS[0m in 0.03s]
[0m03:26:55.134057 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:26:55.134233 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:26:55.134388 [info ] [Thread-1 (]: 5 of 5 START test not_null_rep_sales_funnel_monthly_month_year ................. [RUN]
[0m03:26:55.134570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa)
[0m03:26:55.134724 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:26:55.137194 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:26:55.137769 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:26:55.138907 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:26:55.139286 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:26:55.139449 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: BEGIN
[0m03:26:55.139591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:55.163124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m03:26:55.163439 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"
[0m03:26:55.163644 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month_year
from "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly"
where month_year is null



  
  
      
    ) dbt_internal_test
[0m03:26:55.164857 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:26:55.165874 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: ROLLBACK
[0m03:26:55.166732 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa: Close
[0m03:26:55.167139 [info ] [Thread-1 (]: 5 of 5 PASS not_null_rep_sales_funnel_monthly_month_year ....................... [[32mPASS[0m in 0.03s]
[0m03:26:55.167489 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa
[0m03:26:55.168207 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:55.168389 [debug] [MainThread]: On master: BEGIN
[0m03:26:55.168526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:26:55.188063 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m03:26:55.188363 [debug] [MainThread]: On master: COMMIT
[0m03:26:55.188528 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:55.188670 [debug] [MainThread]: On master: COMMIT
[0m03:26:55.189234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:26:55.189446 [debug] [MainThread]: On master: Close
[0m03:26:55.189742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:55.189883 [debug] [MainThread]: Connection 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa' was properly closed.
[0m03:26:55.190074 [info ] [MainThread]: 
[0m03:26:55.190302 [info ] [MainThread]: Finished running 1 incremental model, 4 data tests in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m03:26:55.191007 [debug] [MainThread]: Command end result
[0m03:26:55.210347 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:26:55.211517 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:26:55.214776 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m03:26:55.215064 [info ] [MainThread]: 
[0m03:26:55.215427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:26:55.215582 [info ] [MainThread]: 
[0m03:26:55.215751 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m03:26:55.217646 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.4381814, "process_in_blocks": "0", "process_kernel_time": 0.250437, "process_mem_max_rss": "135102464", "process_out_blocks": "0", "process_user_time": 1.387197}
[0m03:26:55.217908 [debug] [MainThread]: Command `dbt build` succeeded at 03:26:55.217861 after 1.44 seconds
[0m03:26:55.218097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a86fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a86fd80>]}
[0m03:26:55.218279 [debug] [MainThread]: Flushing usage events
[0m03:26:57.175994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:48:36.364594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a737b10>]}


============================== 03:48:36.369172 | ed35c829-062f-4f08-9436-63d6d954cf09 ==============================
[0m03:48:36.369172 [info ] [MainThread]: Running with dbt=1.10.11
[0m03:48:36.369893 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'log_path': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build -s stg_activity_types.sql', 'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'empty': 'False'}
[0m03:48:36.496274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed35c829-062f-4f08-9436-63d6d954cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e2fe10>]}
[0m03:48:36.526026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed35c829-062f-4f08-9436-63d6d954cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b3bd0>]}
[0m03:48:36.526747 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m03:48:36.586303 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m03:48:36.736794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:48:36.737044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:48:36.760312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed35c829-062f-4f08-9436-63d6d954cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3cf650>]}
[0m03:48:36.805323 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:48:36.807105 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:48:36.830834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed35c829-062f-4f08-9436-63d6d954cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b68ad50>]}
[0m03:48:36.831140 [info ] [MainThread]: Found 10 models, 31 data tests, 6 sources, 434 macros
[0m03:48:36.832951 [info ] [MainThread]: 
[0m03:48:36.833142 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:48:36.833277 [info ] [MainThread]: 
[0m03:48:36.833525 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:48:36.833951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m03:48:36.935750 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:48:36.936008 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:48:36.936149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:37.255977 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.320 seconds
[0m03:48:37.257092 [debug] [ThreadPool]: On list_postgres: Close
[0m03:48:37.260218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m03:48:37.264594 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:48:37.264890 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m03:48:37.265115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:37.292101 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m03:48:37.292478 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m03:48:37.292692 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m03:48:37.304901 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.012 seconds
[0m03:48:37.305829 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m03:48:37.306489 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m03:48:37.310427 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:37.310679 [debug] [MainThread]: On master: BEGIN
[0m03:48:37.310812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:48:37.334269 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m03:48:37.334540 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:37.334731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:48:37.357364 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m03:48:37.358154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed35c829-062f-4f08-9436-63d6d954cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad133f0>]}
[0m03:48:37.358422 [debug] [MainThread]: On master: ROLLBACK
[0m03:48:37.359082 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:37.359229 [debug] [MainThread]: On master: BEGIN
[0m03:48:37.360074 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:48:37.360212 [debug] [MainThread]: On master: COMMIT
[0m03:48:37.360333 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:37.360452 [debug] [MainThread]: On master: COMMIT
[0m03:48:37.360891 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:48:37.361025 [debug] [MainThread]: On master: Close
[0m03:48:37.362483 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m03:48:37.362802 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_analytics.stg_activity_types  [RUN]
[0m03:48:37.363046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity_types)
[0m03:48:37.363241 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m03:48:37.370973 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.372103 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m03:48:37.404600 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.404907 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

    
  
    

  create temporary table "stg_activity_types__dbt_tmp034837391711"
  
  
    as
  
  (
    

WITH raw AS (
    -- Pull the raw data from Postgres source
    SELECT *
    FROM "postgres"."public"."activity_types"
),
cleaned AS (
    SELECT
        id AS activity_type_id
        , name AS activity_type_name -- Each activity type defines the category of an activity
        , active AS is_activity_type_active
        , type AS activity_type_short
        , CURRENT_TIMESTAMP AS dwh_creation_timestamp
        , CURRENT_TIMESTAMP AS dwh_modified_timestamp
    FROM raw
    WHERE TRUE
        AND id IS NOT NULL
)

SELECT *
FROM cleaned


    WHERE activity_type_id NOT IN (SELECT activity_type_id FROM "postgres"."public_pipedrive_analytics"."stg_activity_types")

  );
  
  
[0m03:48:37.405089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:37.440205 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.035 seconds
[0m03:48:37.447837 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.448091 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m03:48:37.448922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m03:48:37.449117 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.449305 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp034837391711'
        
      order by ordinal_position

  
[0m03:48:37.468622 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.019 seconds
[0m03:48:37.471617 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.471855 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m03:48:37.486500 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.014 seconds
[0m03:48:37.493602 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.493872 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types__dbt_tmp034837391711'
        
      order by ordinal_position

  
[0m03:48:37.496191 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m03:48:37.497751 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.497964 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_activity_types'
        
        and table_schema = 'public_pipedrive_analytics'
        
      order by ordinal_position

  
[0m03:48:37.500074 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m03:48:37.505365 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_analytics"."stg_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m03:48:37.513867 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.514420 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.514635 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

      
        
        
        delete from "postgres"."public_pipedrive_analytics"."stg_activity_types" as DBT_INTERNAL_DEST
        where (activity_type_id) in (
            select distinct activity_type_id
            from "stg_activity_types__dbt_tmp034837391711" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_analytics"."stg_activity_types" ("activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp")
    (
        select "activity_type_id", "activity_type_name", "is_activity_type_active", "activity_type_short", "dwh_creation_timestamp", "dwh_modified_timestamp"
        from "stg_activity_types__dbt_tmp034837391711"
    )
  
[0m03:48:37.517532 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m03:48:37.526518 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m03:48:37.526827 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m03:48:37.527071 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m03:48:37.531918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m03:48:37.532998 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m03:48:37.534229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed35c829-062f-4f08-9436-63d6d954cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be14390>]}
[0m03:48:37.534663 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_pipedrive_analytics.stg_activity_types  [[32mINSERT 0 0[0m in 0.17s]
[0m03:48:37.535007 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m03:48:37.535463 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m03:48:37.535752 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_activity_types_activity_type_id ................. [RUN]
[0m03:48:37.536110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m03:48:37.536341 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m03:48:37.543710 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m03:48:37.544603 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m03:48:37.556413 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m03:48:37.557344 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m03:48:37.557579 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m03:48:37.557756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:37.575340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m03:48:37.575676 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m03:48:37.575887 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m03:48:37.578961 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m03:48:37.580925 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m03:48:37.581599 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m03:48:37.581977 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.05s]
[0m03:48:37.582293 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m03:48:37.582507 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m03:48:37.582736 [info ] [Thread-1 (]: 3 of 4 START test relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [RUN]
[0m03:48:37.582955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c)
[0m03:48:37.583149 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m03:48:37.588168 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m03:48:37.588766 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m03:48:37.589944 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m03:48:37.590334 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m03:48:37.590511 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: BEGIN
[0m03:48:37.590671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:37.610293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m03:48:37.610584 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"
[0m03:48:37.610794 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select activity_type_short as from_field
    from "postgres"."public_pipedrive_analytics"."stg_activity"
    where activity_type_short is not null
),

parent as (
    select activity_type_short as to_field
    from "postgres"."public_pipedrive_analytics"."stg_activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m03:48:37.616355 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m03:48:37.617273 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: ROLLBACK
[0m03:48:37.617914 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c: Close
[0m03:48:37.618269 [info ] [Thread-1 (]: 3 of 4 PASS relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_  [[32mPASS[0m in 0.04s]
[0m03:48:37.618587 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c
[0m03:48:37.618806 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m03:48:37.619044 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_activity_types_activity_type_id ................... [RUN]
[0m03:48:37.619274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m03:48:37.619467 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m03:48:37.623368 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m03:48:37.623869 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m03:48:37.625032 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m03:48:37.625484 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m03:48:37.625718 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m03:48:37.625891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:37.644573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m03:48:37.644871 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m03:48:37.645056 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:48:37.646836 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:48:37.647727 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m03:48:37.648414 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m03:48:37.648755 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_activity_types_activity_type_id ......................... [[32mPASS[0m in 0.03s]
[0m03:48:37.649072 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m03:48:37.649987 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:37.650173 [debug] [MainThread]: On master: BEGIN
[0m03:48:37.650297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:48:37.674338 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m03:48:37.674675 [debug] [MainThread]: On master: COMMIT
[0m03:48:37.674872 [debug] [MainThread]: Using postgres connection "master"
[0m03:48:37.675017 [debug] [MainThread]: On master: COMMIT
[0m03:48:37.676019 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:48:37.676277 [debug] [MainThread]: On master: Close
[0m03:48:37.676607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:48:37.676767 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd' was properly closed.
[0m03:48:37.676962 [info ] [MainThread]: 
[0m03:48:37.677146 [info ] [MainThread]: Finished running 1 incremental model, 3 data tests in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m03:48:37.677757 [debug] [MainThread]: Command end result
[0m03:48:37.697563 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/manifest.json
[0m03:48:37.698724 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/semantic_manifest.json
[0m03:48:37.701756 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/target/run_results.json
[0m03:48:37.701915 [info ] [MainThread]: 
[0m03:48:37.702092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:48:37.702227 [info ] [MainThread]: 
[0m03:48:37.702371 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m03:48:37.704198 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3923519, "process_in_blocks": "0", "process_kernel_time": 0.35804, "process_mem_max_rss": "130039808", "process_out_blocks": "0", "process_user_time": 1.332222}
[0m03:48:37.704413 [debug] [MainThread]: Command `dbt build` succeeded at 03:48:37.704372 after 1.39 seconds
[0m03:48:37.704586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6af330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6af540>]}
[0m03:48:37.704745 [debug] [MainThread]: Flushing usage events
[0m03:48:39.420246 [debug] [MainThread]: An error was encountered while trying to flush usage events
