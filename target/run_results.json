{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-26T09:12:03.283066Z", "invocation_id": "1f80a37a-59cc-4319-a670-a59032dcc0e2", "invocation_started_at": "2025-09-26T09:12:01.465252Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.888857Z", "completed_at": "2025-09-26T09:12:02.904670Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.905094Z", "completed_at": "2025-09-26T09:12:02.905111Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0174868106842041, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_activity", "compiled": true, "compiled_code": "\n\nWITH raw AS (\n    -- Pull the raw data from Postgres source\n    SELECT *\n    FROM \"postgres\".\"public\".\"activity\"\n),\n\ndeduped AS (\n    -- Deduplication logic:\n    -- In raw data, sometimes the same activity_id may appear more than once \n    -- Since activity_id should uniquely represent an activity, we keep only the latest record.\n\n    -- NOTE: In some edge cases, the same activity_id can have different user_id values. \n    -- This could usually happens when ownership or responsibility for an activity changes over time.\n    -- To resolve this, we use `due_to` (latest timestamp) as the tie-breaker and keep the most recent assignment.\n    -- This enforces one activity_id = one activity, aligned with how reporting expects unique activity records.\n    SELECT *\n    FROM (\n        SELECT *,\n               ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to DESC) AS rn\n        FROM raw\n    ) t\n    WHERE rn = 1\n),\ncleaned AS (\n    SELECT\n        activity_id\n        , type AS activity_type_short\n        , assigned_to_user AS user_id\n        , deal_id\n        , done AS is_activity_done_status\n        , due_to AS activity_due_timestamp\n        , CURRENT_TIMESTAMP AS dwh_creation_timestamp\n        , CURRENT_TIMESTAMP AS dwh_modified_timestamp\n    FROM deduped\n    WHERE TRUE\n        AND activity_id IS NOT NULL\n)\n\nSELECT *\nFROM cleaned\n\n\n    -- Only insert rows that don\u2019t already exist in the target table\n    WHERE activity_id NOT IN (SELECT activity_id FROM \"postgres\".\"pipedrive_analytics\".\"stg_activity\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_activity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.906872Z", "completed_at": "2025-09-26T09:12:02.910921Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.911229Z", "completed_at": "2025-09-26T09:12:02.911238Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005107879638671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_activity_types", "compiled": true, "compiled_code": "\n\nWITH raw AS (\n    -- Pull the raw data from Postgres source\n    SELECT *\n    FROM \"postgres\".\"public\".\"activity_types\"\n),\ncleaned AS (\n    SELECT\n        id AS activity_type_id\n        , name AS activity_type_name -- Each activity type defines the category of an activity\n        , active AS is_activity_type_active\n        , type AS activity_type_short\n        , CURRENT_TIMESTAMP AS dwh_creation_timestamp\n        , CURRENT_TIMESTAMP AS dwh_modified_timestamp\n    FROM raw\n    WHERE TRUE\n        AND id IS NOT NULL\n)\n\nSELECT *\nFROM cleaned\n\n\n    WHERE activity_type_id NOT IN (SELECT activity_type_id FROM \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.912666Z", "completed_at": "2025-09-26T09:12:02.916427Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.916717Z", "completed_at": "2025-09-26T09:12:02.916724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0047359466552734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_changes", "compiled": true, "compiled_code": "\n\n-- Each deal can have multiple changes over time.\n-- We create a surrogate key (`deal_id_sk`) to uniquely identify each row.\n-- The combination of (change_time, changed_field_key, new_value) guarantees deterministic ordering.\n\n\nWITH raw AS (\n    SELECT *\n    FROM \"postgres\".\"public\".\"deal_changes\"\n),\ndeduped AS (\n    SELECT\n        deal_id\n        , change_time\n        , changed_field_key\n        , new_value\n        , ROW_NUMBER() OVER (\n            PARTITION BY deal_id\n            ORDER BY change_time, changed_field_key, new_value  -- Tie-breaker added using changed_field_key & new_value to ensure uniqueness if change_time is the same.\n          ) AS rn\n    FROM raw\n),\ncleaned AS (\n    SELECT\n        -- Create unique surrogate key as string\n        CONCAT(deal_id, '_', rn) AS deal_id_sk\n        , deal_id\n        , change_time AS deal_change_timestamp\n        , changed_field_key AS deal_updated_field_key\n        , new_value AS deal_new_value\n        , CURRENT_TIMESTAMP AS dwh_creation_timestamp\n        , CURRENT_TIMESTAMP AS dwh_modified_timestamp\n    FROM deduped\n)\n\nSELECT *\nFROM cleaned\n\n\n    -- Only include new rows based on surrogate key\n    WHERE deal_id_sk NOT IN (SELECT deal_id_sk FROM \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.921157Z", "completed_at": "2025-09-26T09:12:02.931168Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.931729Z", "completed_at": "2025-09-26T09:12:02.931737Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013711690902709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_fields", "compiled": true, "compiled_code": "\n\n\n-- Contains metadata about deal fields, including picklist values in JSON.\n-- This is later unpacked to form dimension tables like `stages` and `lost_reasons`.\n\nWITH raw AS (\n    SELECT *\n    FROM \"postgres\".\"public\".\"fields\"\n),\ncleaned AS (\n    SELECT\n        field_key\n        , name AS field_name\n        , field_value_options   -- JSON structure holding picklist values\n\n        -- Represents picklist options for fields like stage_id or lost_reason.\n        -- Examples:\n        -- 1. stage_id \u2192 maps to stages table (stage_id, stage_name)\n        -- 2. lost_reason \u2192 maps to stg_lost_reasons table (lost_reason_id, lost_reason_name)\n        -- Fields like add_time or user_id have NULL because they are not picklists.\n\n        , CURRENT_TIMESTAMP AS dwh_creation_timestamp\n        , CURRENT_TIMESTAMP AS dwh_modified_timestamp\n    FROM raw\n    WHERE TRUE\n        AND field_key IS NOT NULL\n)\n\nSELECT *\nFROM cleaned\n\n\n    WHERE field_key NOT IN (SELECT field_key FROM \"postgres\".\"pipedrive_analytics\".\"stg_fields\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_fields\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.934397Z", "completed_at": "2025-09-26T09:12:02.941704Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.942513Z", "completed_at": "2025-09-26T09:12:02.942526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00958108901977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_stages", "compiled": true, "compiled_code": "\n\n-- Defines the funnel stages a deal can pass through (Lead Generation -> Qualified Lead -> Needs Assessment -> Proposal/ Quote Preparation -> Negotiation -> Closing -> Implementation/ Onboarding -> Follow-up/ Customer Success -> Renewal/Expansion)\n-- Data comes from the raw 'stages' table in Postgres.\n-- Even though 'stages' already exists, staging it standardizes column names, adds DWH timestamps, \n-- and ensures consistency for joins in downstream DBT models like rep_sales_funnel_monthly.\n\n\nWITH raw AS (\n    SELECT *\n    FROM \"postgres\".\"public\".\"stages\"\n),\ncleaned AS (\n    SELECT\n        stage_id\n        , stage_name\n        , CURRENT_TIMESTAMP AS dwh_creation_timestamp\n        , CURRENT_TIMESTAMP AS dwh_modified_timestamp\n    FROM raw\n    WHERE TRUE\n        AND stage_id IS NOT NULL\n)\n\nSELECT *\nFROM cleaned\n\n\n    WHERE stage_id NOT IN (SELECT stage_id FROM \"postgres\".\"pipedrive_analytics\".\"stg_stages\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_stages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.945952Z", "completed_at": "2025-09-26T09:12:02.951362Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.952048Z", "completed_at": "2025-09-26T09:12:02.952057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007449150085449219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_users", "compiled": true, "compiled_code": "\n\nWITH raw AS (\n    -- Pull the raw data from Postgres source\n    SELECT *\n    FROM \"postgres\".\"public\".\"users\"\n),\ncleaned AS (\n    SELECT\n        id as user_id\n        , name AS user_name\n        , email AS user_email\n        , CURRENT_TIMESTAMP AS dwh_creation_timestamp -- warehouse load timestamp\n        , modified AS dwh_modified_timestamp\n    FROM raw\n    WHERE TRUE\n        AND id is not null -- filter out any incomplete records\n)\n\nSELECT *\nFROM cleaned\n\n\n      -- Only insert rows that don\u2019t already exist in the target table\n    WHERE user_id NOT IN (SELECT user_id FROM \"postgres\".\"pipedrive_analytics\".\"stg_users\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.953878Z", "completed_at": "2025-09-26T09:12:02.967613Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.967985Z", "completed_at": "2025-09-26T09:12:02.967993Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01495218276977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.969617Z", "completed_at": "2025-09-26T09:12:02.973429Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.973773Z", "completed_at": "2025-09-26T09:12:02.973781Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004978179931640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_activity_type_short.23b414b844", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type_short\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere activity_type_short is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.975187Z", "completed_at": "2025-09-26T09:12:02.981259Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.981598Z", "completed_at": "2025-09-26T09:12:02.981606Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007073163986206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.983086Z", "completed_at": "2025-09-26T09:12:02.988728Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.989108Z", "completed_at": "2025-09-26T09:12:02.989116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0066890716552734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    activity_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere activity_id is not null\ngroup by activity_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.990545Z", "completed_at": "2025-09-26T09:12:02.994611Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:02.994905Z", "completed_at": "2025-09-26T09:12:02.994911Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005017757415771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"\nwhere activity_type_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:02.996343Z", "completed_at": "2025-09-26T09:12:03.004917Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.005238Z", "completed_at": "2025-09-26T09:12:03.005245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009639978408813477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.relationships_stg_activity_activity_type_short__activity_type_short__ref_stg_activity_types_.8580b0e08c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select activity_type_short as from_field\n    from \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\n    where activity_type_short is not null\n),\n\nparent as (\n    select activity_type_short as to_field\n    from \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.006665Z", "completed_at": "2025-09-26T09:12:03.010215Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.010497Z", "completed_at": "2025-09-26T09:12:03.010504Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004477262496948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    activity_type_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"\nwhere activity_type_id is not null\ngroup by activity_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.012541Z", "completed_at": "2025-09-26T09:12:03.016289Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.016562Z", "completed_at": "2025-09-26T09:12:03.016568Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0047910213470458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.017859Z", "completed_at": "2025-09-26T09:12:03.021519Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.021846Z", "completed_at": "2025-09-26T09:12:03.021853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004620075225830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id_sk.94cfef280e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id_sk\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\nwhere deal_id_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.023259Z", "completed_at": "2025-09-26T09:12:03.027618Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.028060Z", "completed_at": "2025-09-26T09:12:03.028068Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0056591033935546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_updated_field_key.8d690b0624", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_updated_field_key\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\nwhere deal_updated_field_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.030037Z", "completed_at": "2025-09-26T09:12:03.033700Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.034245Z", "completed_at": "2025-09-26T09:12:03.034254Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00494694709777832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_deal_changes_deal_id_sk.84f93f5600", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id_sk as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\nwhere deal_id_sk is not null\ngroup by deal_id_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.036652Z", "completed_at": "2025-09-26T09:12:03.043183Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.043526Z", "completed_at": "2025-09-26T09:12:03.043534Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008083105087280273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_lost_reasons", "compiled": true, "compiled_code": "\n\n-- This table extracts all possible reasons a deal can be lost.\n-- Data comes from the 'field_value_options' JSON in stg_fields where field_key = 'lost_reason'.\n-- Each JSON object represents a lost reason with 'id' and 'name'.\n\nWITH raw AS (\n    SELECT *\n    FROM \"postgres\".\"pipedrive_analytics\".\"stg_fields\"\n    WHERE field_key = 'lost_reason'\n),\nunnested AS (\n    -- Unnest the JSON array to get one row per lost reason\n    SELECT\n        CAST(v.value->>'id' AS INT) AS lost_reason_id,   -- Unique identifier for the lost reason\n        v.value->>'label' AS lost_reason_name           -- Name of the lost reason\n    FROM raw\n    JOIN LATERAL jsonb_array_elements(field_value_options) AS v(value) ON TRUE -- Postgres function to expand JSON array into rows\n),\ncleaned AS (\n    -- Add DWH tracking columns for auditing\n    SELECT\n        lost_reason_id\n        , lost_reason_name\n        , CURRENT_TIMESTAMP AS dwh_creation_timestamp\n        , CURRENT_TIMESTAMP AS dwh_modified_timestamp   \n    FROM unnested\n)\n\nSELECT *\nFROM cleaned\n\n\n    WHERE lost_reason_id NOT IN (SELECT lost_reason_id FROM \"postgres\".\"pipedrive_analytics\".\"stg_lost_reasons\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_lost_reasons\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.045428Z", "completed_at": "2025-09-26T09:12:03.053778Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.054299Z", "completed_at": "2025-09-26T09:12:03.054307Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010054826736450195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect field_key\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_fields\"\nwhere field_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.055890Z", "completed_at": "2025-09-26T09:12:03.063250Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.063582Z", "completed_at": "2025-09-26T09:12:03.063590Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008424997329711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.relationships_stg_deal_changes_deal_updated_field_key__field_key__ref_stg_fields_.d1a09faffa", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select deal_updated_field_key as from_field\n    from \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\n    where deal_updated_field_key is not null\n),\n\nparent as (\n    select field_key as to_field\n    from \"postgres\".\"pipedrive_analytics\".\"stg_fields\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.065260Z", "completed_at": "2025-09-26T09:12:03.137590Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.138002Z", "completed_at": "2025-09-26T09:12:03.138009Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07346296310424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_fields_field_key.ea1d2437a4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    field_key as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_fields\"\nwhere field_key is not null\ngroup by field_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.139551Z", "completed_at": "2025-09-26T09:12:03.143271Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.143588Z", "completed_at": "2025-09-26T09:12:03.143595Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004812002182006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_stages\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.145941Z", "completed_at": "2025-09-26T09:12:03.151556Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.152012Z", "completed_at": "2025-09-26T09:12:03.152021Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007210969924926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_stages\"\nwhere stage_id is not null\ngroup by stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.153583Z", "completed_at": "2025-09-26T09:12:03.158034Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.158399Z", "completed_at": "2025-09-26T09:12:03.158406Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005522966384887695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_activity", "compiled": true, "compiled_code": "\n\n-- Intermediate model that enriches activities with descriptive user and activity type information. \n-- Keeps 1 row per activity_id (deduped in stg_activity).\n\nWITH base AS (\n    SELECT *\n    FROM \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\n),\n\nuser_enriched AS (\n    SELECT\n        b.activity_id\n        , b.deal_id\n        , b.user_id\n        , u.user_name\n        , u.user_email\n        , b.activity_type_short\n        , b.is_activity_done_status\n        , b.activity_due_timestamp\n        , b.dwh_creation_timestamp\n        , b.dwh_modified_timestamp\n    FROM base b\n    LEFT JOIN \"postgres\".\"pipedrive_analytics\".\"stg_users\" u\n      ON b.user_id = u.user_id\n),\n\nactivity_type_enriched AS (\n    SELECT\n        ue.*\n        , at.activity_type_name\n        , at.is_activity_type_active\n    FROM user_enriched ue\n    LEFT JOIN \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\" at\n      ON ue.activity_type_short = at.activity_type_short\n)\n\nSELECT *\nFROM activity_type_enriched\n\n\n    WHERE activity_id NOT IN (SELECT activity_id FROM \"postgres\".\"pipedrive_analytics\".\"int_activity\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"int_activity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.159837Z", "completed_at": "2025-09-26T09:12:03.163830Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.164619Z", "completed_at": "2025-09-26T09:12:03.164628Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00553131103515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_users\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.168362Z", "completed_at": "2025-09-26T09:12:03.173326Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.173667Z", "completed_at": "2025-09-26T09:12:03.173676Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006688117980957031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_name\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_users\"\nwhere user_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.175166Z", "completed_at": "2025-09-26T09:12:03.180253Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.180558Z", "completed_at": "2025-09-26T09:12:03.180565Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006069183349609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__user_id__ref_stg_users_.ec42fb2f02", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from \"postgres\".\"pipedrive_analytics\".\"stg_users\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.181965Z", "completed_at": "2025-09-26T09:12:03.186335Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.186691Z", "completed_at": "2025-09-26T09:12:03.186701Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005387067794799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_users\"\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.188202Z", "completed_at": "2025-09-26T09:12:03.193224Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.193538Z", "completed_at": "2025-09-26T09:12:03.193547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0060312747955322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_deal_changes", "compiled": true, "compiled_code": "\n\n-- Intermediate model that enriches deal changes with descriptive fields such as stage name or lost reason name. \n-- Keeps 1 row per deal change (normalized, auditable history).\n\nWITH base AS (\n    SELECT *\n    FROM \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\n),\n\n-- Bring in stage names when the change refers to stage_id\nstage_enriched AS (\n    SELECT\n        b.deal_id_sk\n        , b.deal_id\n        , b.deal_change_timestamp\n        , b.deal_updated_field_key\n        , b.deal_new_value\n        , s.stage_name\n        , NULL AS lost_reason_name\n        , b.dwh_creation_timestamp\n        , b.dwh_modified_timestamp\n    FROM base b\n    LEFT JOIN \"postgres\".\"pipedrive_analytics\".\"stg_stages\" s\n     ON b.deal_new_value = CAST(s.stage_id AS TEXT)\n    WHERE TRUE\n        AND b.deal_updated_field_key = 'stage_id'\n),\n\n-- Bring in lost reason names when the change refers to lost_reason\nlost_reason_enriched AS (\n    SELECT\n        b.deal_id_sk\n        , b.deal_id\n        , b.deal_change_timestamp\n        , b.deal_updated_field_key\n        , b.deal_new_value\n        , NULL AS stage_name\n        , lr.lost_reason_name\n        , b.dwh_creation_timestamp\n        , b.dwh_modified_timestamp\n    FROM base b\n    LEFT JOIN \"postgres\".\"pipedrive_analytics\".\"stg_lost_reasons\" lr\n     ON  b.deal_new_value = CAST(lr.lost_reason_id AS TEXT)\n    WHERE TRUE\n        AND b.deal_updated_field_key = 'lost_reason'\n),\n\nfinal AS (\n    SELECT\n        deal_id_sk\n        , deal_id\n        , deal_change_timestamp\n        , deal_updated_field_key\n        , deal_new_value\n        , stage_name\n        , lost_reason_name\n        , dwh_creation_timestamp\n        , dwh_modified_timestamp\n    FROM stage_enriched\nUNION ALL\n    SELECT\n        deal_id_sk\n        , deal_id\n        , deal_change_timestamp\n        , deal_updated_field_key\n        , deal_new_value\n        , stage_name\n        , lost_reason_name\n        , dwh_creation_timestamp\n        , dwh_modified_timestamp\n    FROM lost_reason_enriched\n)\n\nSELECT *\nFROM final\n\n\n    WHERE deal_id_sk NOT IN (SELECT deal_id_sk FROM \"postgres\".\"pipedrive_analytics\".\"int_deal_changes\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"int_deal_changes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.195036Z", "completed_at": "2025-09-26T09:12:03.198883Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.199228Z", "completed_at": "2025-09-26T09:12:03.199236Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004913806915283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_lost_reasons_lost_reason_id.e7f0e29768", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect lost_reason_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_lost_reasons\"\nwhere lost_reason_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.200636Z", "completed_at": "2025-09-26T09:12:03.210680Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.211192Z", "completed_at": "2025-09-26T09:12:03.211205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011250972747802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_lost_reasons_lost_reason_id.f700309c9d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    lost_reason_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_lost_reasons\"\nwhere lost_reason_id is not null\ngroup by lost_reason_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.213159Z", "completed_at": "2025-09-26T09:12:03.217844Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.218208Z", "completed_at": "2025-09-26T09:12:03.218215Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0059549808502197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_activity_activity_id.75b5b7bf5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom \"postgres\".\"pipedrive_analytics\".\"int_activity\"\nwhere activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.219728Z", "completed_at": "2025-09-26T09:12:03.226856Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.227209Z", "completed_at": "2025-09-26T09:12:03.227216Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008188962936401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_int_activity_activity_id.d1a12b395e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    activity_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"int_activity\"\nwhere activity_id is not null\ngroup by activity_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.228647Z", "completed_at": "2025-09-26T09:12:03.233939Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.234293Z", "completed_at": "2025-09-26T09:12:03.234301Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006314992904663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.rep_sales_funnel_monthly", "compiled": true, "compiled_code": "\n\n-- Aggregates deal and activity data to create a monthly sales funnel view.\n\n-- Column definitions:\n-- month: Month of the activity or stage change (first day of month)\n-- kpi_name: Name of the KPI corresponding to the funnel step\n-- funnel_step: Funnel step identifier (Step 1, Step 2.1, etc.)\n-- deals_count: Count of unique deals in that month and funnel step\n\nWITH\n-- Stage-based funnel steps (from int_deal_changes)\nstage_funnel AS (\n    SELECT\n        -- EXTRACT(MONTH FROM deal_change_timestamp) AS month\n        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year\n        ,  CASE \n            WHEN stage_name = 'Lead Generation' THEN 'Stage: Lead Generation'\n            WHEN stage_name = 'Qualified Lead' THEN 'Stage: Qualified Lead'\n            WHEN stage_name = 'Needs Assessment' THEN 'Stage: Needs Assessment'\n            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Stage: Proposal/Quote Preparation'\n            WHEN stage_name = 'Negotiation' THEN 'Stage: Negotiation'\n            WHEN stage_name = 'Closing' THEN 'Stage: Closing'\n            WHEN stage_name = 'Implementation/Onboarding' THEN 'Stage: Implementation/Onboarding'\n            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Stage: Follow-up/Customer Success'\n            WHEN stage_name = 'Renewal/Expansion' THEN 'Stage: Renewal/Expansion'\n            ELSE NULL\n          END AS kpi_name\n        , CASE \n            WHEN stage_name = 'Lead Generation' THEN 'Step 1'\n            WHEN stage_name = 'Qualified Lead' THEN 'Step 2'\n            WHEN stage_name = 'Needs Assessment' THEN 'Step 3'\n            WHEN stage_name = 'Proposal/Quote Preparation' THEN 'Step 4'\n            WHEN stage_name = 'Negotiation' THEN 'Step 5'\n            WHEN stage_name = 'Closing' THEN 'Step 6'\n            WHEN stage_name = 'Implementation/Onboarding' THEN 'Step 7'\n            WHEN stage_name = 'Follow-up/Customer Success' THEN 'Step 8'\n            WHEN stage_name = 'Renewal/Expansion' THEN 'Step 9'\n            ELSE NULL\n          END AS funnel_step\n        , deal_id\n    FROM \"postgres\".\"pipedrive_analytics\".\"int_deal_changes\"\n    WHERE TRUE\n        AND stage_name IS NOT NULL\n),\n\n-- Activity-based funnel steps (from int_activity)\nactivity_funnel AS (\n    SELECT\n        -- EXTRACT(MONTH FROM activity_due_timestamp) AS month\n        TO_CHAR(activity_due_timestamp, 'MM-YYYY') AS month_year\n        , CASE \n            WHEN activity_type_short = 'meeting' THEN 'Activity: Sales Call 1'\n            WHEN activity_type_short = 'sc_2' THEN 'Activity: Sales Call 2'\n            WHEN activity_type_short = 'follow_up' THEN 'Activity: Follow-up/Customer Success'\n            WHEN activity_type_short = 'after_close_call' THEN 'Activity: Closing'\n            ELSE NULL\n          END AS kpi_name\n        , CASE \n            WHEN activity_type_short = 'meeting' THEN 'Step 2.1'\n            WHEN activity_type_short = 'sc_2' THEN 'Step 3.1'\n            WHEN activity_type_short = 'after_close_call' THEN 'Step 6'\n            WHEN activity_type_short = 'follow_up' THEN 'Step 8'\n            ELSE NULL\n         END AS funnel_step\n        , deal_id\n    FROM \"postgres\".\"pipedrive_analytics\".\"int_activity\"\n    WHERE TRUE\n        AND activity_type_short IN ('meeting','sc_2','follow_up','after_close_call')\n),\n\n-- Lost Reason-based funnel steps (from int_deal_changes)\nlost_reason_funnel AS (\n    SELECT\n        TO_CHAR(deal_change_timestamp, 'MM-YYYY') AS month_year\n        , CASE \n            WHEN lost_reason_name = 'Customer Not Ready' THEN 'Lost Reason: Customer Not Ready'\n            WHEN lost_reason_name = 'Pricing Issues' THEN 'Lost Reason: Pricing Issues'\n            WHEN lost_reason_name = 'Unreachable Customer' THEN 'Lost Reason: Unreachable Customer'\n            WHEN lost_reason_name = 'Product Mismatch' THEN 'Lost Reason: Product Mismatch'\n            WHEN lost_reason_name = 'Duplicate Entry' THEN 'Lost Reason: Duplicate Entry'\n            ELSE NULL\n        END AS kpi_name\n        , CASE \n            WHEN lost_reason_name = 'Customer Not Ready' THEN 'Step 1'\n            WHEN lost_reason_name = 'Pricing Issues' THEN 'Step 2'\n            WHEN lost_reason_name = 'Unreachable Customer' THEN 'Step 3'\n            WHEN lost_reason_name = 'Product Mismatch' THEN 'Step 4'\n            WHEN lost_reason_name = 'Duplicate Entry' THEN 'Step 5'\n            ELSE NULL\n        END AS funnel_step\n        , deal_id\n    FROM \"postgres\".\"pipedrive_analytics\".\"int_deal_changes\"\n    WHERE TRUE\n    AND lost_reason_name IS NOT NULL\n),\n\n-- Union all funnel events\nall_funnel AS (\n    SELECT * FROM stage_funnel\n    UNION ALL\n    SELECT * FROM activity_funnel\n    UNION ALL\n    SELECT * FROM lost_reason_funnel\n),\n\n-- Aggregate by month-year + funnel step\naggregated AS (\n    SELECT\n        month_year\n        , kpi_name\n        , funnel_step\n        , COUNT(DISTINCT deal_id) AS deals_count\n    FROM all_funnel\n    WHERE kpi_name IS NOT NULL\n    GROUP BY 1,2,3\n)\n\nSELECT *\nFROM aggregated\n\n\n    WHERE CONCAT(month_year, funnel_step) NOT IN \n          (SELECT CONCAT(month_year, funnel_step) FROM \"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\")\n", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.235787Z", "completed_at": "2025-09-26T09:12:03.240070Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.240483Z", "completed_at": "2025-09-26T09:12:03.240491Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0054280757904052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id.d28c369cb1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics\".\"int_deal_changes\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.242502Z", "completed_at": "2025-09-26T09:12:03.246777Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.247083Z", "completed_at": "2025-09-26T09:12:03.247091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005835056304931641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_deal_changes_deal_id_sk.c9e453e813", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id_sk\nfrom \"postgres\".\"pipedrive_analytics\".\"int_deal_changes\"\nwhere deal_id_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.248783Z", "completed_at": "2025-09-26T09:12:03.255551Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.255854Z", "completed_at": "2025-09-26T09:12:03.255861Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008061885833740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_int_deal_changes_deal_id_sk.16738e9c0a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id_sk as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"int_deal_changes\"\nwhere deal_id_sk is not null\ngroup by deal_id_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.257662Z", "completed_at": "2025-09-26T09:12:03.264594Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.264909Z", "completed_at": "2025-09-26T09:12:03.264917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00838923454284668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_deals_count.4823926246", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deals_count\nfrom \"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere deals_count is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.266309Z", "completed_at": "2025-09-26T09:12:03.270170Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.270469Z", "completed_at": "2025-09-26T09:12:03.270477Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004827022552490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.271827Z", "completed_at": "2025-09-26T09:12:03.275487Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.275798Z", "completed_at": "2025-09-26T09:12:03.275805Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004616975784301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-26T09:12:03.277171Z", "completed_at": "2025-09-26T09:12:03.281246Z"}, {"name": "execute", "started_at": "2025-09-26T09:12:03.281529Z", "completed_at": "2025-09-26T09:12:03.281536Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004994869232177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month_year.a883701bfa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month_year\nfrom \"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere month_year is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.92128586769104, "args": {"print": true, "macro_debugging": false, "project_dir": "/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment", "log_format": "default", "require_generic_test_arguments_property": true, "vars": {}, "indirect_selection": "eager", "log_path": "/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment/logs", "select": [], "static": false, "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "static_parser": true, "favor_state": false, "source_freshness_run_project_hooks": true, "invocation_command": "dbt docs generate", "defer": false, "populate_cache": true, "log_level_file": "debug", "warn_error_options": {"error": [], "warn": [], "silence": []}, "strict_mode": false, "state_modified_compare_vars": false, "log_level": "info", "printer_width": 80, "upload_to_artifacts_ingest_api": false, "partial_parse": true, "log_file_max_bytes": 10485760, "require_all_warnings_handled_by_warn_error": false, "exclude": [], "require_batched_execution_for_custom_microbatch_strategy": false, "show_all_deprecations": false, "compile": true, "use_colors_file": true, "which": "generate", "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "show_resource_report": false, "write_json": true, "cache_selected_only": false, "require_nested_cumulative_type_params": false, "send_anonymous_usage_stats": true, "profiles_dir": "/Users/nv994t/Desktop/Enpal_Assessment/dbt_enpal_assessment", "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "version_check": true, "require_resource_names_without_spaces": true, "use_fast_test_edges": false, "quiet": false, "partial_parse_file_diff": true, "validate_macro_args": false, "empty_catalog": false}}